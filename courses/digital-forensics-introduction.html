



<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- ========== Start: SEO & Schema Enhancement ========== -->
    <title>Digital Forensics Introduction Course | CipherHall</title>
    <meta name="description" content="Enroll in our expert-led Digital Forensics course. Master evidence handling, file system analysis, memory forensics, and modern investigation techniques." />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon.png" />
    <link rel="shortcut icon" href="/favicon.png" type="image/x-icon" />
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon.png" />
    <link rel="canonical" href="https://www.cipherhall.com/courses/digital-forensics-introduction" />

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Course",
      "name": "Digital Forensics Introduction",
      "description": "A comprehensive 40-lesson course on the theory and practice of digital forensics, covering evidence handling, file system analysis, and investigation of modern platforms like cloud and mobile.",
      "provider": {
        "@type": "Organization",
        "name": "CipherHall",
        "sameAs": "https://www.cipherhall.com"
      },
      "hasCourseInstance": {
        "@type": "CourseInstance",
        "courseMode": "Online",
        "instructor": {
          "@type": "Person",
          "name": "Dr. Anya Sharma"
        }
      }
    }
    </script>
    <!-- ========== End: SEO & Schema Enhancement ========== -->
    
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Exo+2:wght@700;800;900&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.7/dist/umd/supabase.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css"
    />
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />

    <link rel="stylesheet" href="assets/css/coursepages.css" />
</head>
  <body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
      <div class="loader-icon">
        <i class="fas fa-graduation-cap"></i>
      </div>
      <div class="loader-text">Loading Course Content...</div>
    </div>

    <!-- Sidebar Overlay for Mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- Music Player (fixed at top right) -->
    <div class="header-controls">
      <div class="music-dropdown" id="music-dropdown">
        <button class="btn btn-secondary">
          <span id="music-button-text">STUDY MUSIC</span>
          <i id="music-icon" class="fa-solid fa-music"></i>
        </button>
        <div class="music-dropdown-content" id="music-dropdown-content">
          <a
            href="#"
            data-src="https://www.learningcontainer.com/wp-content/uploads/2020/02/Kalimba.mp3"
            >1. Coffee Shop Vibes</a
          >
          <a
            href="#"
            data-src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-16.mp3"
            >2. City Lights Lofi</a
          >
          <a
            href="#"
            data-src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-15.mp3"
            >3. Mellow Thoughts</a
          >
          <a
            href="#"
            data-src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-13.mp3"
            >4. Rainy Mood</a
          >
          <a
            href="#"
            data-src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-10.mp3"
            >5. Time Alone</a
          >
          <a href="#" id="stop-music-link"
            ><i class="fa-solid fa-stop-circle"></i> Stop Music</a
          >
        </div>
      </div>

      <button class="btn btn-secondary" id="resetProgressBtn">
        <i class="fas fa-redo"></i>
        Reset Progress
      </button>
    </div>

    <!-- Auth Modal -->
    <div id="authModal" class="modal" style="display: none">
      <div class="modal-overlay"></div>
      <div class="modal-content">
        <span class="close" id="closeAuthModal">&times;</span>
        <div class="auth-tabs">
          <button id="tabSignIn" class="auth-tab active">Sign In</button>
          <button id="tabSignUp" class="auth-tab">Sign Up</button>
        </div>
        <div
          id="authLoader"
          style="display: none; text-align: center; padding: 2rem"
        >
          <i
            class="fas fa-spinner fa-spin fa-2x"
            style="color: var(--color-green)"
          ></i>
          <p style="margin-top: 0.5rem">Authenticating...</p>
        </div>
        <div id="signInForm" class="auth-form">
          <h2>Sign In to CipherHall</h2>
          <button id="googleSignIn" class="btn btn-google">
            <i class="fab fa-google"></i> Continue with Google
          </button>
          <div class="divider"><span>or</span></div>
          <form id="emailSignInForm">
            <input
              type="email"
              id="signInEmail"
              placeholder="Email Address"
              required
            />
            <input
              type="password"
              id="signInPassword"
              placeholder="Password"
              required
            />
            <button type="submit" class="btn btn-primary">Sign In</button>
          </form>
        </div>
        <div id="signUpForm" class="auth-form" style="display: none">
          <h2>Join CipherHall</h2>
          <button id="googleSignUp" class="btn btn-google">
            <i class="fab fa-google"></i> Continue with Google
          </button>
          <div class="divider"><span>or</span></div>
          <form id="emailSignUpForm">
            <input
              type="text"
              id="signUpName"
              placeholder="Full Name"
              required
            />
            <input
              type="email"
              id="signUpEmail"
              placeholder="Email Address"
              required
            />
            <input
              type="password"
              id="signUpPassword"
              placeholder="Password (min. 8 characters)"
              required
            />
            <button type="submit" class="btn btn-secondary">
              Create Account
            </button>
          </form>
        </div>
        <div id="authMessage"></div>
      </div>
    </div>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="course-info">
          <h1 class="course-title" id="courseTitle">Loading...</h1>
          <div class="course-progress">
            <div class="progress-header">
              <span class="progress-label">Course Progress</span>
              <span class="progress-percentage" id="courseProgressPercent"
                >0%</span
              >
            </div>
            <div class="progress-bar">
              <div
                class="progress-fill"
                id="courseProgressFill"
                style="width: 0%"
              ></div>
            </div>
            <div class="progress-stats">
              <span id="completedLessons">0</span>
              <span id="totalLessons">0</span>
            </div>
          </div>
          <a href="/dashboard" class="back-to-dashboard">
            <i class="fas fa-arrow-left"></i>
            Back to Dashboard
          </a>
        </div>
      </div>

      <nav class="lesson-nav" id="lessonNav">
        <!-- Lessons will be loaded dynamically -->
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <header class="content-header">
        <div class="lesson-header">
          <div class="lesson-header-left">
            <span class="lesson-number" id="currentLessonNumber">1</span>
            <h1 class="lesson-header-title" id="currentLessonTitle">
              Loading...
            </h1>
          </div>
          <div class="lesson-actions">
            <button class="mbtn btn-primary" id="menuToggle">
              <i class="fas fa-bars"></i>
            </button>
          </div>
        </div>
      </header>

      <div class="content-body" id="contentBody">
        <div class="lesson-content" id="lessonContent">
          <!-- Lesson content will be loaded dynamically -->
        </div>
      </div>

      <footer class="lesson-navigation">
        <div class="nav-info" id="navInfo">Lesson 1 of 10</div>
        <div class="nav-controls">
          <button class="btn btn-secondary" id="prevLessonBtn" disabled>
            <i class="fas fa-chevron-left"></i>
            Previous
          </button>
          <button class="btn btn-primary" id="nextLessonBtn" disabled>
            Next
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </footer>
    </main>

    <!-- Achievement Notification -->
    <div id="achievementNotification" class="achievement-notification">
      <div class="notification-header">
        <div class="notification-icon" id="notificationIcon">
          <i class="fas fa-trophy"></i>
        </div>
        <div class="notification-content">
          <h3 id="notificationTitle">Achievement Unlocked!</h3>
          <p id="notificationDescription">Description here...</p>
        </div>
      </div>
      <div class="notification-reward" id="notificationReward">
        <i class="fas fa-coins"></i>
        <span id="notificationPoints">+100 Points</span>
      </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">
      <span id="toastMessage"></span>
    </div>

    <script>
      // =====================================================
      // SYNCHRONIZED COURSE SYSTEM WITH DASHBOARD INTEGRATION
      // =====================================================

      // Supabase Configuration - Replace with your config
      const supabaseUrl = "https://lzcmzulemfubjaksoqor.supabase.co";
      const supabaseKey =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx6Y216dWxlbWZ1Ympha3NvcW9yIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUzMzM5MDgsImV4cCI6MjA3MDkwOTkwOH0.crhPH4YWtRsr1BJTpAQcmPbWSpwIWRbzoI4sRb2_fPI";
      const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

      // =====================================================
      // COURSE DATA STRUCTURE - REPLACE WITH YOUR COURSE JSON
      // =====================================================
      const COURSE_DATA = {
        "id": "digital-forensics-introduction",
        "title": "Digital Forensics Introduction",
        "description": "A comprehensive 40-lesson course on the theory and practice of digital forensics, covering evidence handling, file system analysis, and investigation of modern platforms like cloud and mobile.",
        "category": "cybersecurity",
        "difficulty": "Beginner to Advanced",
        "duration": "80 hours",
        "instructor": "Dr. Anya Sharma",
        "lessons": [
            {
                "id": "lesson-1-df-overview",
                "title": "Lesson 1: Digital Forensics Overview",
                "duration": "120 min",
                "objectives": [
                    "Define digital forensics and its primary objectives",
                    "Identify the different types of digital evidence",
                    "Differentiate between technical and legal aspects of forensic investigations",
                    "Explore potential career paths in the digital forensics field"
                ],
                "content": {
                    "overview": "Welcome to the world of digital forensics. This foundational lesson introduces the core concepts of the field, explaining what digital forensics is, the types of evidence investigators work with, and its critical role in legal, corporate, and law enforcement investigations.",
                    "sections": [
                        {
                            "title": "Definition and Scope of Digital Forensics",
                            "content": "<p>Digital Forensics is the process of identifying, preserving, analyzing, and presenting digital evidence in a manner that is legally admissible. It is a scientific process that applies the principles of investigation to the digital realm.</p><h3>Primary Objectives:</h3><ul><li><strong>Investigation:</strong> To find out what happened, how it happened, and who was involved in a digital incident.</li><li><strong>Attribution:</strong> To attribute the actions to a specific person or entity.</li><li><strong>Recovery:</strong> To recover lost, deleted, or hidden data.</li><li><strong>Prevention:</strong> To use findings to help organizations prevent future incidents.</li></ul><div class='info-box tip'><div class='info-box-header'><i class='fas fa-lightbulb'></i><strong>It's a Science</strong></div><p>Digital forensics follows the scientific method. An investigator forms a hypothesis, tests it against the evidence, and reaches a conclusion. The entire process must be repeatable and verifiable by another examiner.</p></div>",
                            "image": "https://images.unsplash.com/photo-1526374965328-7f61d4e18c66?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Types of Digital Evidence",
                            "content": "<p>Digital evidence is any information of probative value that is stored or transmitted in a digital form. It can be found on a vast array of devices.</p><h3>Evidence Categories:</h3><ul><li><strong>Persistent Data:</strong> Data stored on local hard drives, SSDs, or removable media that remains even when the device is powered off.</li><li><strong>Volatile Data:</strong> Data that exists in a temporary state in memory (RAM), caches, or registries. This data is lost when the device is powered off.</li><li><strong>Network Data:</strong> Traffic captured on a network, including logs from firewalls, proxies, and intrusion detection systems.</li></ul><div class='info-box note'><div class='info-box-header'><i class='fas fa-info-circle'></i><strong>Everything is a Computer</strong></div><p>In the modern world, potential sources of digital evidence are everywhere: cars, refrigerators, smart TVs, and IoT devices are all computers that may contain valuable data for an investigation.</p></div>",
                            "image": "https://images.unsplash.com/photo-1544197150-b99a5808e7ee?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "What is the primary goal of digital forensics?", "options": ["To sell antivirus software", "To identify, preserve, analyze, and present digital evidence in a legally admissible way", "To monitor employees' internet usage", "To design computer networks"], "correct": 1, "explanation": "This definition covers the entire lifecycle of a forensic investigation, with a key emphasis on legal admissibility." },
                        { "id": 2, "question": "Data such as running processes and active network connections stored in RAM is known as what?", "options": ["Persistent Data", "Volatile Data", "Network Data", "Backup Data"], "correct": 1, "explanation": "Volatile data is temporary and is lost when a device loses power, making its collection a time-sensitive priority." },
                        { "id": 3, "question": "The scientific principle that a forensic process should be repeatable and verifiable by another examiner emphasizes forensics as a:", "options": ["Hobby", "Scientific discipline", "Legal theory", "IT support function"], "correct": 1, "explanation": "Like any other science, digital forensics relies on a structured, methodical process that produces verifiable results." }
                    ]
                }
            },
            {
                "id": "lesson-2-legal-ethical",
                "title": "Lesson 2: Legal and Ethical Framework",
                "duration": "120 min",
                "objectives": [
                    "Understand the basic rules of evidence as they apply to digital forensics",
                    "Define and learn how to maintain a meticulous chain of custody",
                    "Grasp the standards for legal admissibility of digital evidence",
                    "Explore the ethical obligations of a digital forensics professional"
                ],
                "content": {
                    "overview": "A forensic investigation that is not legally and ethically sound is worthless. This lesson covers the absolute bedrock of digital forensics: the legal and ethical principles an investigator must follow to ensure their evidence is protected, their process is defensible, and their findings are admissible in a court of law.",
                    "sections": [
                        {
                            "title": "Rules of Evidence",
                            "content": "<p>Digital evidence is subject to the same legal rules of evidence as physical evidence. To be admissible in court, the evidence must be relevant, authentic, and reliable.</p><h3>Key Principles for Admissibility:</h3><ul><li><strong>Authenticity:</strong> You must be able to prove that the evidence is what you say it is. This is where hashing is used to show a forensic copy is an exact duplicate of the original.</li><li><strong>Reliability:</strong> You must demonstrate that the processes and tools used to collect and analyze the evidence are reliable and sound.</li><li><strong>Relevance:</strong> The evidence must be directly related to the case at hand.</li></ul><div class='info-box warning'><div class='info-box-header'><i class='fas fa-exclamation-triangle'></i><strong>Search Authority</strong></div><p>You must have the legal authority to search a device. This could come from a court-issued search warrant (in criminal cases) or from corporate consent policies (in internal investigations). A search without proper authority can render all evidence inadmissible.</p></div>",
                            "image": "https://images.unsplash.com/photo-1589216532372-1c2a3679003a?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Chain of Custody",
                            "content": "<p>The chain of custody is the single most important document in a forensic investigation. It is a detailed log that accounts for every person who handled a piece of evidence from the moment of collection. A broken chain of custody can destroy a case.</p><h3>What it Tracks:</h3><ul><li>Who collected the evidence.</li><li>When and where it was collected.</li><li>Who it was transferred to, and when.</li><li>Where it was stored.</li><li>Who had access to it.</li></ul><p>Every transfer of evidence must be documented with signatures, dates, and times.</p><div class='info-box tip'><div class='info-box-header'><i class='fas fa-lightbulb'></i><strong>Proving Integrity</strong></div><p>The purpose of the chain of custody is to prove to the court that the evidence was never lost, tampered with, or handled by an unauthorized person. It proves the integrity of the evidence trail.</p></div>",
                            "image": "https://images.unsplash.com/photo-1589998059171-988d887df646?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Ethics in Digital Investigations",
                            "content": "<p>A forensic examiner has a profound ethical responsibility to be objective, thorough, and unbiased. Their job is not to prove guilt or innocence; their job is to find the facts and report them accurately.</p><h3>Core Ethical Tenets:</h3><ul><li><strong>Objectivity:</strong> The examiner must not have a preconceived notion of the outcome. They must follow the evidence wherever it leads.</li><li><strong>Confidentiality:</strong> The examiner will be exposed to sensitive and private information. They have an ethical and legal duty to keep this information confidential.</li><li><strong>Competence:</strong> The examiner must have the necessary training and skills to perform the investigation. They must also be honest about the limits of their expertise.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1556761175-5973dc0f32e7?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "What is the primary purpose of the chain of custody?", "options": ["To track how much an investigation costs", "To provide a legal record of who handled the evidence, proving its integrity", "To list the files found on the evidence", "To store passwords for encrypted files"], "correct": 1, "explanation": "The chain of custody is the cornerstone of evidence handling, ensuring that the evidence presented in court is the same as what was collected and has not been tampered with." },
                        { "id": 2, "question": "To prove that a forensic image is an exact bit-for-bit copy of the original hard drive, an examiner would use what?", "options": ["File compression", "A signed affidavit", "Cryptographic hashing (e.g., SHA-256)", "A photograph of the hard drive"], "correct": 2, "explanation": "Hashing creates a unique digital fingerprint. If the hash of the original and the hash of the copy match, it provides mathematical proof that they are identical." },
                        { "id": 3, "question": "What is the core ethical responsibility of a digital forensics examiner?", "options": ["To prove the suspect is guilty", "To be objective and report the facts of the case, regardless of the outcome", "To finish the investigation as quickly as possible", "To hide any evidence that is not helpful to their client"], "correct": 1, "explanation": "The examiner's role is that of a neutral, scientific expert whose duty is to find and present factual evidence." }
                    ]
                }
            },
            {
                "id": "lesson-3-forensic-process",
                "title": "Lesson 3: Forensic Process and Methodology",
                "duration": "120 min",
                "objectives": [
                    "Apply the scientific method to forensic investigations",
                    "Understand the phases of the digital forensic process (collection, examination, analysis, reporting)",
                    "Learn about key industry standards and guidelines from NIST and ISO",
                    "Practice meticulous documentation throughout the process"
                ],
                "content": {
                    "overview": "A defensible forensic investigation is not a random search; it's a structured process that follows a clear methodology. This lesson introduces the formal phases of a digital forensic investigation, aligning them with the scientific method and key industry standards to ensure a thorough and repeatable process.",
                    "sections": [
                        {
                            "title": "Scientific Method in Forensics",
                            "content": "<p>Digital forensics is grounded in the scientific method. This ensures that the process is unbiased and the conclusions are based on evidence.</p><h3>The Process:</h3><ol><li><strong>Observation:</strong> An event occurs (e.g., a system is compromised).</li><li><strong>Hypothesis:</strong> Formulate a testable theory about what happened (e.g., 'The attacker gained access by exploiting a web vulnerability').</li><li><strong>Experimentation (Examination & Analysis):</strong> Collect and analyze the evidence to test the hypothesis.</li><li><strong>Conclusion:</strong> Based on the evidence, conclude whether the hypothesis is supported or refuted. The entire process must be documented so another person could repeat your steps.</li></ol>",
                            "image": "https://images.unsplash.com/photo-1507413245164-6160d8298b31?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "The Digital Forensic Process",
                            "content": "<p>Most forensic methodologies can be broken down into four distinct phases. This provides a clear workflow for any investigation.</p><h3>Four Phases:</h3><ul><li><strong>1. Collection (Acquisition):</strong> The process of identifying potential sources of evidence and acquiring the data from them in a forensically sound manner. This is where imaging and chain of custody begin.</li><li><strong>2. Examination:</strong> A technical review to identify and extract relevant data. This involves using forensic tools to parse file systems, recover deleted files, and find artifacts.</li><li><strong>3. Analysis:</strong> The process of interpreting the examined data to answer investigative questions. This involves correlating artifacts, building timelines, and drawing conclusions.</li><li><strong>4. Reporting:</strong> Presenting the findings of the analysis. This includes writing a formal report, providing supporting evidence, and potentially testifying as an expert witness.</li></ul><div class='info-box tip'><div class='info-box-header'><i class='fas fa-lightbulb'></i><strong>Collection vs. Examination vs. Analysis</strong></div><p>Think of it this way: <strong>Collection</strong> is getting the whole haystack. <strong>Examination</strong> is pulling out all the needles from the haystack. <strong>Analysis</strong> is figuring out what kind of needles they are, where they came from, and what they mean.</p></div>",
                            "image": "https://images.unsplash.com/photo-1516321497487-e288fb19713f?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "The phase of the forensic process focused on acquiring data in a forensically sound manner is called:", "options": ["Analysis", "Reporting", "Collection / Acquisition", "Examination"], "correct": 2, "explanation": "Collection (or Acquisition) is the first hands-on phase, where data is preserved and copied from evidence sources." },
                        { "id": 2, "question": "Interpreting the data to build a timeline and answer investigative questions belongs to which phase?", "options": ["Collection", "Examination", "Analysis", "Reporting"], "correct": 2, "explanation": "Analysis is the 'sense-making' phase where the investigator connects the dots between the various pieces of evidence found during the examination." },
                        { "id": 3, "question": "Using forensic tools to parse a file system and recover deleted files is part of which phase?", "options": ["Examination", "Analysis", "Reporting", "Collection"], "correct": 0, "explanation": "Examination is the technical process of using tools to surface and extract the relevant data for later analysis." }
                    ]
                }
            },
            {
                "id": "lesson-4-evidence-handling",
                "title": "Lesson 4: Evidence Handling Fundamentals",
                "duration": "120 min",
                "objectives": [
                    "Learn how to properly identify and label digital evidence",
                    "Understand procedures for collecting evidence from different sources",
                    "Practice evidence preservation techniques to prevent contamination",
                    "Follow best practices for the transportation and secure storage of evidence"
                ],
                "content": {
                    "overview": "Proper evidence handling is a hands-on skill that is non-negotiable for a forensic professional. This lesson covers the practical, physical steps of handling digital evidence, from the moment you identify a device to the point it is securely stored in an evidence locker.",
                    "sections": [
                        {
                            "title": "Evidence Identification and Collection",
                            "content": "<p>Before you touch anything, the scene must be documented.</p><h3>Steps at the Scene:</h3><ol><li><strong>Secure the Area:</strong> Ensure only authorized personnel are present.</li><li><strong>Photograph Everything:</strong> Take overall photos of the room and detailed photos of the devices *before* you touch them. Photograph the screen, the front, the back, and all cable connections.</li><li><strong>Identify and Label:</strong> Identify all potential sources of digital evidence. Assign each a unique evidence ID number (e.g., `CASE-001-ITEM-001`). Create a label with this ID and attach it to the physical item.</li><li><strong>Live or Dead?:</strong> Assess if the computer is powered on or off. If it is on, and a 'live response' is authorized to collect volatile data, proceed with that first. Otherwise, disconnect the power cord from the *back of the computer*, not the wall, to minimize changes to the system.</li></ol>",
                            "image": "https://images.unsplash.com/photo-1618498263386-339c9a7593c6?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Preservation, Transportation, and Storage",
                            "content": "<p>Once collected, evidence must be protected from physical damage and electromagnetic interference.</p><h3>Handling and Storage:</h3><ul><li><strong>Anti-static Bags:</strong> Place components like hard drives and RAM into anti-static bags to protect them from electrostatic discharge.</li><li><strong>Faraday Bags:</strong> Place mobile devices (like phones and tablets) into Faraday bags. These bags block radio signals, preventing the device from being remotely wiped by an attacker or the user.</li><li><strong>Secure Transport:</strong> Transport evidence in a secure container. Never leave it unattended. Document the transport in the chain of custody.</li><li><strong>Evidence Locker:</strong> Store all original evidence in a secure, access-controlled location, like a safe or a locked cabinet. Access to the locker must be strictly logged.</li></ul><div class='info-box warning'><div class='info-box-header'><i class='fas fa-exclamation-triangle'></i><strong>Don't Forget the Documentation</strong></div><p>Every step listed above—photographing, labeling, bagging, transporting, storing—must be meticulously documented in your case notes and on the chain of custody form.</p></div>",
                            "image": "https://images.unsplash.com/photo-1593110022831-292911b3b194?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "Why should you photograph a computer before you collect it as evidence?", "options": ["For insurance purposes", "To document the state of the scene and the device's connections *before* you alter them", "To post on social media", "To create a background for your desktop"], "correct": 1, "explanation": "Photographs preserve the original state of the scene, which can be critical for the investigation." },
                        { "id": 2, "question": "What is the primary purpose of placing a mobile phone in a Faraday bag?", "options": ["To protect it from being dropped", "To keep it clean", "To block all radio signals to prevent it from being remotely wiped or altered", "To charge the battery"], "correct": 2, "explanation": "A Faraday bag isolates the device from cellular, Wi-Fi, and Bluetooth signals, preserving its state at the time of collection." },
                        { "id": 3, "question": "When disconnecting a powered-on computer, you should generally unplug the power cable from:", "options": ["The wall outlet", "The power strip", "The back of the computer tower", "It doesn't matter"], "correct": 2, "explanation": "Unplugging from the computer itself is the most reliable way to cut power instantly. Pulling from the wall can sometimes cause the system to go into hibernation, altering its state." }
                    ]
                }
            },
            {
                "id": "lesson-5-computer-architecture",
                "title": "Lesson 5: Computer Systems Architecture",
                "duration": "120 min",
                "objectives": [
                    "Identify the major hardware components of a computer from a forensic perspective",
                    "Understand the fundamental concepts of file systems",
                    "Recognize the role of the operating system in managing data",
                    "Learn about different data storage concepts like slack space and unallocated space"
                ],
                "content": {
                    "overview": "To analyze digital evidence, you must first understand how a computer works. This lesson provides the essential technical foundation, covering the hardware, operating system, and file system concepts that dictate how and where data is stored and managed on a digital device.",
                    "sections": [
                        {
                            "title": "Hardware Components Overview",
                            "content": "<p>A forensic examiner needs to understand how hardware components store data.</p><h3>Key Components:</h3><ul><li><strong>Central Processing Unit (CPU):</strong> The 'brain' of the computer. Does not store data long-term.</li><li><strong>Random Access Memory (RAM):</strong> Volatile memory that stores data for running applications. Evidence in RAM is lost when the computer is powered off.</li><li><strong>Hard Disk Drive (HDD) / Solid-State Drive (SSD):</strong> Non-volatile, persistent storage for the operating system and user files. This is the primary source of evidence in most cases.</li><li><strong>BIOS/UEFI:</strong> Firmware on the motherboard that contains the system's startup instructions and basic configuration, including the system time.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1593110022831-292911b3b194?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "File Systems Fundamentals",
                            "content": "<p>A file system is the 'card catalog' of a hard drive. It's the structure that the operating system uses to keep track of where files are located on the physical disk.</p><h3>Key Concepts:</h3><ul><li><strong>Allocation Unit (Cluster):</strong> The smallest chunk of disk space the file system can assign to a file.</li><li><strong>Unallocated Space:</strong> Disk space that is not currently allocated to any active file. This is where deleted files may be recovered from.</li><li><strong>Slack Space:</strong> If a file doesn't perfectly fill its last allocated cluster, the leftover space is called slack space. This can contain remnants of previously deleted files.</li></ul><p>Examples of file systems include NTFS (Windows), EXT4 (Linux), and APFS (macOS).</p><div class='info-box note'><div class='info-box-header'><i class='fas fa-info-circle'></i><strong>Deleted is Not Gone</strong></div><p>When you 'delete' a file, the operating system usually just marks the space it occupied as 'unallocated'. The actual 1s and 0s of the file remain on the disk until a new file happens to overwrite them. This is why file recovery is possible.</p></div>",
                            "image": "https://images.unsplash.com/photo-1542382156942-0268579cf259?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "Where would an examiner look to find remnants of deleted files?", "options": ["The CPU", "Unallocated space and slack space", "The BIOS", "The power supply"], "correct": 1, "explanation": "These are areas on the disk that are not being used by active files but may still contain the data from deleted files that haven't been overwritten yet." },
                        { "id": 2, "question": "What happens to the data in RAM when a computer is powered off?", "options": ["It is saved to the hard drive", "It is lost", "It is uploaded to the cloud", "It is compressed"], "correct": 1, "explanation": "RAM is volatile memory; its contents are erased when it loses power. This is why live memory acquisition is so important." },
                        { "id": 3, "question": "NTFS is the primary file system for which operating system?", "options": ["Linux", "macOS", "Windows", "iOS"], "correct": 2, "explanation": "NTFS (New Technology File System) is the modern standard file system for the Windows operating system." }
                    ]
                }
            },
            {
                "id": "lesson-6-data-representation",
                "title": "Lesson 6: Data Representation and Storage",
                "duration": "120 min",
                "objectives": [
                    "Understand binary and hexadecimal number systems used by computers",
                    "Analyze file formats and identify them by their headers",
                    "Recognize the importance of metadata in an investigation",
                    "Use a hex editor to directly examine the raw data of a file"
                ],
                "content": {
                    "overview": "At the lowest level, all data is just 1s and 0s. This lesson peels back the layers of abstraction to show how data is represented in binary and hexadecimal, how files are structured using headers, and how to use a hex editor to see the raw data exactly as it is stored on the disk.",
                    "sections": [
                        {
                            "title": "Binary and Hexadecimal Systems",
                            "content": "<p>Computers store and process information using a binary (base-2) system of 0s and 1s. For human readability, this binary data is often represented in hexadecimal (base-16).</p><h3>Why Hexadecimal?</h3><ul><li>It's a compact way to represent binary data. One hexadecimal character represents four binary digits (a 'nibble').</li><li>Forensic tools and hex editors display raw data in hexadecimal. An examiner must be able to read and understand it.</li><li>For example, the binary `01001010` is much easier to read as the hexadecimal `4A`.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1550751827-4138d04d47ee?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "File Formats and Headers",
                            "content": "<p>Most file types have a 'magic number' or file signature in the first few bytes of the file, known as the file header. This header tells the operating system what kind of file it is, regardless of the file extension.</p><h3>Examples of File Headers:</h3><ul><li><strong>JPEG Image:</strong> Starts with `FF D8 FF E0` or `FF D8 FF E1`.</li><li><strong>PDF Document:</strong> Starts with `%PDF` (in ASCII), which is `25 50 44 46` in hex.</li><li><strong>PNG Image:</strong> Starts with `89 50 4E 47`.</li><li><strong>Windows Executable (EXE):</strong> Starts with `MZ` (in ASCII), which is `4D 5A` in hex.</li></ul><p>An attacker might rename `malware.exe` to `photo.jpg` to hide it. A forensic examiner will look at the file header in a hex editor, see the `4D 5A` signature, and know it's really an executable, not a JPEG.</p><div class='info-box warning'><div class='info-box-header'><i class='fas fa-exclamation-triangle'></i><strong>The Extension is a Lie</strong></div><p>Never trust a file's extension. Always verify its true type by examining its file header. This is a fundamental technique for finding hidden files.</p></div>",
                            "image": "https://images.unsplash.com/photo-1522252234503-e356032cafd5?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "codeExamples": [
                    {
                        "title": "Hex Editor View of a PNG File Header",
                        "language": "bash",
                        "code": "# A hex editor shows the raw hexadecimal values (left) and the ASCII interpretation (right).\n# The first 4 bytes identify this as a PNG file.\n# 89 50 4E 47 is the magic number for PNG.\n\nOffset(h) 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\n\n00000000  89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52  ‰PNG........IHDR"
                    }
                ],
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "An attacker renames `malware.exe` to `report.pdf`. How would an examiner discover its true file type?", "options": ["By asking the attacker", "By trusting the `.pdf` extension", "By opening it in Adobe Reader", "By examining the file header's magic number in a hex editor"], "correct": 3, "explanation": "The file header contains the true signature of the file type, regardless of the filename. This is a core technique for identifying disguised files." },
                        { "id": 2, "question": "The hexadecimal value `4D 5A` at the beginning of a file indicates it is what type of file?", "options": ["A JPEG image", "A Windows executable", "A PNG image", "A PDF document"], "correct": 1, "explanation": "`4D 5A` is the ASCII representation for 'MZ', the initials of Mark Zbikowski, one of the original architects of MS-DOS. It has been the signature for Windows executables ever since." },
                        { "id": 3, "question": "Why do forensic analysts often view data in hexadecimal instead of binary?", "options": ["It is more secure", "It is a more compact and human-readable representation of binary data", "It takes up less space on the disk", "It is required by law"], "correct": 1, "explanation": "Hexadecimal is a shorthand for binary, making it much easier for people to read and work with large amounts of raw data." }
                    ]
                }
            },
            {
                "id": "lesson-7-imaging-fundamentals",
                "title": "Lesson 7: Forensic Imaging Fundamentals",
                "duration": "120 min",
                "objectives": [
                    "Differentiate between a bit-by-bit image and a logical acquisition",
                    "Properly use hashing to verify the integrity of a forensic image",
                    "Understand the critical role of hardware and software write blockers",
                    "Recognize standard forensic image formats (E01, DD)"
                ],
                "content": {
                    "overview": "Creating a forensically sound image is the most critical first technical step of an investigation. An improper image can destroy evidence and render the entire case invalid. This lesson provides a deep dive into the theory and practice of creating a verifiable, bit-for-bit replica of a digital storage device.",
                    "sections": [
                        {
                            "title": "Bit-by-Bit vs. Logical Imaging",
                            "content": "<p>Not all evidence collection methods are created equal. The type of acquisition depends on the situation.</p><h3>Acquisition Types:</h3><ul><li><strong>Bit-by-Bit Image (Physical Image):</strong> This is the gold standard. It creates an exact, sector-by-sector duplicate of the entire storage device, including all active files, unallocated space, and slack space. This is the most comprehensive method.</li><li><strong>Logical Acquisition:</strong> This method only copies the active files on the drive. It does *not* acquire unallocated space or deleted files. This is much faster and is sometimes used in corporate investigations where time is critical and deleted files are not the primary concern.</li></ul><p>A true forensic investigation will almost always require a full bit-by-bit image.</p>",
                            "image": "https://images.unsplash.com/photo-1542382156942-0268579cf259?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Write Blockers and Protection",
                            "content": "<p>A write blocker is a device that allows you to read from a hard drive without any possibility of writing to it. Using a write blocker is mandatory to prove that you did not alter the original evidence.</p><h3>Types of Write Blockers:</h3><ul><li><strong>Hardware Write Blocker:</strong> A physical device that sits between the suspect drive and the forensic workstation. It has a built-in controller that physically prevents any write commands from passing to the drive. This is the most defensible method.</li><li><strong>Software Write Blocker:</strong> A software tool that can be used to prevent writes. This is less ideal, as a sophisticated piece of malware could potentially bypass a software blocker.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1593110022831-292911b3b194?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Image Format Standards",
                            "content": "<p>Forensic images are typically saved in one of two standard formats.</p><h3>Common Formats:</h3><ul><li><strong>DD / Raw Image:</strong> This is a simple bit-for-bit copy of the original. The image file will be exactly the same size as the original drive. It does not contain any metadata within the file itself.</li><li><strong>E01 (EnCase Evidence File Format):</strong> This is a proprietary but open standard format. It creates a compressed image (saving space) and wraps it with a container that includes important metadata, such as the case number, examiner's name, acquisition date, and the original drive's hash value. This is the most common format used in modern forensics.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1518932945647-7a1c969f8be2?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "What is the primary function of a hardware write blocker?", "options": ["To encrypt the forensic image", "To prevent any alteration of the original evidence drive during acquisition", "To speed up the imaging process", "To compress the forensic image"], "correct": 1, "explanation": "The write blocker is a one-way gate for data, ensuring the integrity of the original source device, which is a cornerstone of forensic soundness." },
                        { "id": 2, "question": "The process of comparing the hash of the original drive to the hash of the forensic image is done to:", "options": ["Prove that the copy is an exact, unaltered duplicate", "Find malware on the drive", "Estimate the age of the drive", "Register the evidence with the court"], "correct": 0, "explanation": "Hash verification is the mathematical proof that the imaging process was successful and the copy is identical to the original." },
                        { "id": 3, "question": "Which type of forensic acquisition is required to recover deleted files?", "options": ["A logical acquisition", "A bit-by-bit (physical) image", "A screenshot of the desktop", "A backup of the user's home directory"], "correct": 1, "explanation": "Only a bit-by-bit image captures the unallocated space on the drive where the remnants of deleted files reside." },
                        { "id": 4, "question": "The E01 image format has what main advantage over a DD (raw) image?", "options": ["It is always faster to create", "It includes a metadata container for case information and hashes, and it can use compression", "It does not require hashing for verification", "It can only be opened by one specific software tool"], "correct": 1, "explanation": "The E01 format's combination of embedded metadata and compression makes it a more convenient and efficient choice for most investigations." }
                    ]
                }
            },
            {
                "id": "lesson-8-forensic-tools",
                "title": "Lesson 8: Forensic Tools Overview",
                "duration": "120 min",
                "objectives": [
                    "Explore popular open-source forensic suites like Autopsy and the SIFT toolkit",
                    "Understand the capabilities of commercial forensic platforms like EnCase and FTK",
                    "Recognize the need for specialized utilities for specific tasks",
                    "Grasp the importance of tool validation and testing"
                ],
                "content": {
                    "overview": "The modern forensic investigator relies on a wide array of software tools to conduct their examinations. This lesson provides an overview of the major forensic platforms, from comprehensive open-source suites to industry-standard commercial tools, and discusses the critical process of validating that your tools work as expected.",
                    "sections": [
                        {
                            "title": "Open Source Tools (Autopsy, SIFT)",
                            "content": "<p>The open-source community provides powerful, free, and well-supported forensic tools that are used by investigators worldwide.</p><h3>Key Open Source Offerings:</h3><ul><li><strong>Autopsy:</strong> A graphical interface that sits on top of The Sleuth Kit (TSK) command-line tools. It provides a complete forensic platform for analyzing disk images, recovering deleted files, timeline analysis, and keyword searching.</li><li><strong>SIFT Workstation (SANS Investigative Forensic Toolkit):</strong> Not just a single tool, but a complete Ubuntu-based Linux distribution with hundreds of the best open-source forensic tools pre-installed and configured. It provides a complete, ready-to-go forensic analysis environment.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1518770660439-4636190af475?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Commercial Tools (EnCase, FTK)",
                            "content": "<p>Commercial platforms have long been the standard in corporate and law enforcement environments. They offer powerful features, an integrated workflow, and dedicated vendor support.</p><h3>Key Commercial Platforms:</h3><ul><li><strong>EnCase Forensic (Guidance Software / OpenText):</strong> One of the original and most well-known forensic suites. Widely accepted in court proceedings.</li><li><strong>Forensic Toolkit (FTK) (AccessData / Exterro):</strong> Another leading platform, known for its powerful processing and indexing capabilities, which can speed up the examination of very large datasets.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1542744173-8e7e53415bb0?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Tool Validation and Testing",
                            "content": "<p>You cannot simply trust that a forensic tool works as advertised. You must test and validate it yourself to ensure it is forensically sound and that you understand its output. The results of your tools may be challenged in court.</p><h3>Validation Process:</h3><ol><li><strong>Create a Test Image:</strong> Create your own hard drive with a known set of data (e.g., specific files, some of which are deleted).</li><li><strong>Image the Test Drive:</strong> Create a forensic image of this known drive.</li><li><strong>Run the Tool:</strong> Process the image with the forensic tool you are testing.</li><li><strong>Verify the Output:</strong> Does the tool find all the files? Does it recover the deleted files correctly? Is its hash calculation accurate?</li></ol><p>This validation process should be documented and performed for any new tool or any major new version of an existing tool.</p>",
                            "image": "https://images.unsplash.com/photo-1581092446346-b333a466a93b?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "Autopsy and the SIFT Workstation are examples of what?", "options": ["Commercial, closed-source forensic tools", "Hardware write blockers", "Open-source forensic platforms", "Operating Systems"], "correct": 2, "explanation": "Autopsy and SIFT are powerful, widely used open-source tools that provide capabilities on par with many commercial offerings." },
                        { "id": 2, "question": "EnCase and FTK are well-known examples of:", "options": ["Email clients", "Network analyzers", "Open-source tools", "Commercial, industry-standard forensic suites"], "correct": 3, "explanation": "EnCase and FTK are two of the leading commercial platforms used by many of the world's top corporate and law enforcement forensic labs." },
                        { "id": 3, "question": "What is the purpose of tool validation?", "options": ["To get a discount on the software license", "To test a tool to ensure it works as expected and its results are reliable and accurate", "To create a user manual for the tool", "To run the tool as fast as possible"], "correct": 1, "explanation": "Validation is the scientific process of testing your tools to prove they are forensically sound, a step that is crucial if the evidence will be used in court." }
                    ]
                }
            },
            {
                "id": "lesson-9-windows-forensics",
                "title": "Lesson 9: Windows File Systems",
                "duration": "150 min",
                "objectives": [
                    "Understand the structure of the NTFS file system",
                    "Analyze the Master File Table (MFT) for file metadata and activity",
                    "Conduct a basic forensic analysis of the Windows Registry",
                    "Extract investigative leads from Windows Event Logs"
                ],
                "content": {
                    "overview": "Windows is the most common operating system in corporate environments, and understanding its unique forensic artifacts is a core skill for any investigator. This lesson dives into the three most important sources of evidence on a Windows machine: the NTFS file system, the Registry, and the Event Logs.",
                    "sections": [
                        {
                            "title": "NTFS Structure and MFT Analysis",
                            "content": "<p>The New Technology File System (NTFS) is the standard file system for modern Windows. The heart of NTFS is the Master File Table (MFT).</p><h3>The Master File Table (MFT):</h3><ul><li>The MFT is a database that contains an entry for every single file and directory on the volume.</li><li>Each entry stores a rich set of metadata about the file, including its name, size, timestamps (Modified, Accessed, Created, and Entry Modified - known as MAC-B times), and pointers to where the file's data is physically located on the disk.</li><li>For very small files, the entire file's data can even be stored directly within the MFT entry itself ('resident data').</li></ul><p>Analyzing the MFT provides a complete roadmap of all file activity on a system.</p><div class='info-box note'><div class='info-box-header'><i class='fas fa-info-circle'></i><strong>$MFT is File Number 0</strong></div><p>The MFT is itself a file, always the very first file on an NTFS volume, making it easy for forensic tools to locate and parse.</p></div>",
                            "image": "https://images.unsplash.com/photo-1542382156942-02685ทc?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Windows Registry Forensics",
                            "content": "<p>The Windows Registry is a hierarchical database that stores configuration settings for the operating system and applications. It is a gold mine of forensic information.</p><h3>Key Registry Hives for Forensics:</h3><ul><li><strong>SAM (Security Account Manager):</strong> Contains local user accounts and password hashes.</li><li><strong>SYSTEM:</strong> Contains system configuration, hardware information, and a record of which USB devices have been connected.</li><li><strong>SOFTWARE:</strong> Contains software installation information and many persistence locations (e.g., Run keys).</li><li><strong>NTUSER.DAT:</strong> Each user has their own `NTUSER.DAT` file in their profile. It contains user-specific information, such as recently used files, typed commands, and internet history.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1563206767-5b18f218e8de?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Event Log Examination",
                            "content": "<p>Windows Event Logs (`.evtx` files) are the primary audit trail for system activity. They record logins, application crashes, security events, and much more.</p><h3>The Three Main Logs:</h3><ul><li><strong>System Log:</strong> Records events related to the operating system itself, like services starting and stopping or driver failures.</li><li><strong>Application Log:</strong> Records events from applications.</li><li><strong>Security Log:</strong> The most important for forensics. Records security-related events like successful and failed logons (Event ID 4624/4625), privilege escalation, and object access. Auditing must be enabled for many important events to be logged.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1510915228340-29c85a43dcfe?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "What is the name of the central database in an NTFS file system that contains an entry for every file and directory?", "options": ["The Registry", "The Master File Table (MFT)", "The Event Log", "The Page File"], "correct": 1, "explanation": "The MFT is the core component of NTFS, acting as the index for the entire file system." },
                        { "id": 2, "question": "To find a list of recently opened files for a specific user on a Windows system, an investigator would primarily look in which Registry file?", "options": ["The SAM hive", "The SYSTEM hive", "The NTUSER.DAT file in the user's profile", "The SOFTWARE hive"], "correct": 2, "explanation": "NTUSER.DAT is the user-specific portion of the registry, tracking that individual user's activity on the system." },
                        { "id": 3, "question": "In the Windows Event Logs, which log contains information about successful and failed user logons?", "options": ["The System Log", "The Application Log", "The Security Log", "The Setup Log"], "correct": 2, "explanation": "The Security Log is the primary source for audit events, and logon activity (Event IDs 4624 and 4625) is one of the most important things to investigate." }
                    ]
                }
            },
            {
                "id": "lesson-10-linux-forensics",
                "title": "Lesson 10: Linux File Systems",
                "duration": "120 min",
                "objectives": [
                    "Understand the structure of the EXT4 file system",
                    "Identify the locations of critical log files in the Linux directory structure",
                    "Analyze command history files for evidence of execution",
                    "Review file permissions and ownership as part of an investigation"
                ],
                "content": {
                    "overview": "From web servers to cloud infrastructure, Linux systems are everywhere. This lesson focuses on the key forensic artifacts in a Linux environment, highlighting the differences from Windows in file systems, log locations, and shell activity analysis.",
                    "sections": [
                        {
                            "title": "EXT2/3/4 File System Analysis",
                            "content": "<p>The most common file systems in the Linux world are from the 'extended' family, with EXT4 being the modern standard.</p><h3>Key EXT4 Concepts:</h3><ul><li><strong>Inodes:</strong> An inode is the Linux equivalent of an MFT entry. Every file and directory has an inode, which stores its metadata (permissions, ownership, timestamps, pointers to data blocks).</li><li><strong>Superblock:</strong> Contains critical information about the file system itself, like its size and the number of blocks.</li><li><strong>Journal:</strong> The journal logs changes before they are committed to the main file system. This can be a source for recovering data after a crash or for tracking recent file system activity.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1629654297299-c8506221ca97?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Linux Log File Locations",
                            "content": "<p>Unlike the centralized Windows Event Viewer, Linux logs are typically plain text files stored in the `/var/log` directory. Knowing which log to check is key.</p><h3>Critical Log Files:</h3><ul><li><strong>`/var/log/syslog` or `/var/log/messages`:</strong> The general-purpose system log.</li><li><strong>`/var/log/auth.log` or `/var/log/secure`:</strong> Authentication logs, including SSH logins, `sudo` commands, and user account changes. This is the equivalent of the Windows Security Log.</li><li><strong>`/var/log/apache2/access.log`:</strong> The access log for the Apache web server.</li><li><strong>`wtmp`, `utmp`, `btmp`:</strong> Files that track user login sessions and failed login attempts.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1555949963-aa79dcee981c?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Command History Analysis",
                            "content": "<p>The shell saves a history of the commands typed by a user. This is often the single most valuable artifact for determining what an attacker did on a compromised Linux system.</p><h3>History Files:</h3><ul><li><strong>`~/.bash_history`:</strong> The default location for the Bash shell's history file, found in each user's home directory (`~`).</li><li><strong>Other Shells:</strong> Other shells, like Zsh (`.zsh_history`), have their own history files.</li></ul><p>The command history provides a step-by-step playbook of the attacker's actions, from reconnaissance to privilege escalation and data exfiltration.</p>",
                            "image": "https://images.unsplash.com/photo-1515879218367-8466d910aaa4?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "What is the Linux equivalent of an NTFS MFT entry, which stores file metadata?", "options": ["The Superblock", "The Journal", "An Inode", "The Master Boot Record"], "correct": 2, "explanation": "Each file and directory in an EXT file system is described by a corresponding inode." },
                        { "id": 2, "question": "To find evidence of a user's SSH logins and `sudo` commands on a Linux system, an investigator would primarily examine which log file?", "options": ["`/var/log/syslog`", "`/var/log/auth.log` (or `/var/log/secure`)", "`/var/log/dmesg`", "`/var/log/apache2/access.log`"], "correct": 1, "explanation": "The authentication log is the main repository for security-related events involving user access and privilege changes." },
                        { "id": 3, "question": "Where is a user's Bash command history typically stored?", "options": ["In the Windows Registry", "In `/etc/passwd`", "In the `~/.bash_history` file in their home directory", "In the system's BIOS"], "correct": 2, "explanation": "This file provides a direct log of commands executed by the user, making it a critical artifact." }
                    ]
                }
            },
            {
                "id": "lesson-11-macos-forensics",
                "title": "Lesson 11: macOS Forensics",
                "duration": "120 min",
                "objectives": [
                    "Understand the basics of the APFS and HFS+ file systems",
                    "Identify the location of key macOS system and user artifacts",
                    "Learn how to analyze Time Machine backups for historical data",
                    "Recognize the impact of macOS security features like T2 chips and System Integrity Protection on forensics"
                ],
                "content": {
                    "overview": "While less common in the enterprise than Windows, macOS forensics is a growing and important specialty. This lesson covers the unique forensic artifacts of Apple's desktop operating system, including its modern APFS file system, key logging locations, and the challenges presented by its strong built-in security features.",
                    "sections": [
                        {
                            "title": "HFS+ and APFS File Systems",
                            "content": "<p>Apple has transitioned from its older Hierarchical File System Plus (HFS+) to the modern Apple File System (APFS).</p><h3>Key APFS Features:</h3><ul><li><strong>Designed for Flash/SSD:</strong> APFS is optimized for the solid-state drives found in all modern Macs.</li><li><strong>Snapshots:</strong> APFS has built-in support for point-in-time snapshots of the file system. This can be a forensic gold mine, as it may contain copies of files an attacker later deleted. Time Machine backups use this feature extensively.</li><li><strong>Strong Encryption:</strong> APFS is designed around full-disk encryption (FileVault 2), which is enabled by default on most modern Macs.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1517336714731-489689fd1ca8?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "macOS Artifacts and Logs",
                            "content": "<p>macOS stores many important configuration and logging details in Property List (`.plist`) files and SQLite databases.</p><h3>Key Artifact Locations:</h3><ul><li><strong>`/Library` and `~/Library`:</strong> These directories contain system-wide and user-specific application support files, caches, and preferences.</li><li><strong>Unified Log:</strong> Modern macOS uses a complex, centralized Unified Log system. Instead of plain text logs, data is stored in a binary format and must be queried with the `log` command-line tool.</li><li><strong>Spotlight Metadata:</strong> The Spotlight search service maintains a rich index of file metadata that can be useful for finding information about files that have been deleted.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1606161131998-11a511942095?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Security Features Impact",
                            "content": "<p>Modern macOS has very strong, hardware-enforced security features that present significant challenges to traditional forensic techniques.</p><h3>Forensic Hurdles:</h3><ul><li><strong>T2 Security Chip:</strong> This hardware chip manages encryption and secure boot. It can make physical acquisition of an encrypted and powered-off device extremely difficult, if not impossible.</li><li><strong>System Integrity Protection (SIP):</strong> A security technology that prevents even a root user from modifying critical system files. This makes some types of 'live response' malware difficult to install, but also complicates some forensic tool operations.</li></ul><p>Because of these challenges, macOS forensics often relies heavily on logical acquisition and the analysis of Time Machine backups when available.</p>",
                            "image": "https://images.unsplash.com/photo-1531297484001-80022131f5a1?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "What is the modern, default file system for macOS, optimized for SSDs?", "options": ["NTFS", "EXT4", "APFS", "HFS+"], "correct": 2, "explanation": "APFS (Apple File System) is the modern standard, having replaced the older HFS+." },
                        { "id": 2, "question": "On macOS, configuration data and user history is often stored in what type of files?", "options": ["Windows Registry hives", "Text-based log files", "Property List (.plist) files and SQLite databases", "IN_MEMORY databases"], "correct": 2, "explanation": ".plist files are a common format used throughout macOS and iOS for storing structured data." },
                        { "id": 3, "question": "What is a major challenge for forensic acquisition introduced by Apple's T2 Security Chip?", "options": ["It makes the computer run faster", "It encrypts the hard drive with keys protected by hardware, making imaging a powered-off device very difficult", "It generates too many log files", "It prevents users from installing software"], "correct": 1, "explanation": "The T2 chip tightly integrates the encrypted storage with hardware, which enhances security but poses a major obstacle to traditional physical imaging methods." }
                    ]
                }
            },
            {
                "id": "lesson-12-file-recovery",
                "title": "Lesson 12: File Recovery Techniques",
                "duration": "120 min",
                "objectives": [
                    "Understand how file deletion works in common file systems",
                    "Recover deleted files by analyzing file system metadata in unallocated space",
                    "Use file carving techniques to recover files based on their headers and footers",
                    "Explore methods for reconstructing fragmented files"
                ],
                "content": {
                    "overview": "Attackers often try to cover their tracks by deleting files. This lesson covers the fundamental techniques forensic investigators use to recover these 'deleted' files from a drive's unallocated space, either by following file system clues or by carving the data out directly.",
                    "sections": [
                        {
                            "title": "Deleted File Recovery Methods",
                            "content": "<p>When a file is deleted, the file system doesn't immediately wipe the data. It typically just marks the file's entry in the index (like the MFT or an inode) as 'deleted' and the space it occupied as 'unallocated'.</p><h3>Recovering with Metadata:</h3><p>Forensic tools can scan the unallocated space for these old index entries. If the entry is found, it still contains all the file's metadata, including the pointers to where its data blocks were on the disk. If the data blocks have not yet been overwritten by a new file, the tool can follow the pointers and recover the file perfectly.</p>",
                            "image": "https://images.unsplash.com/photo-1542382156942-0268579cf259?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "File Carving Techniques",
                            "content": "<p>What if the file's index entry (its metadata) has been overwritten, but the file's data blocks still exist in unallocated space? This is where file carving comes in.</p><h3>Recovering with Signatures:</h3><p>File carving is a technique that searches the raw data of the unallocated space, looking for known file headers (magic numbers).</p><ul><li>The carving tool will scan the drive sector by sector.</li><li>When it finds a known header (e.g., `FF D8 FF E0` for a JPEG), it knows a file started there.</li><li>It then copies data from that point until it either hits a known file footer or reaches a specified maximum size.</li><li>This technique can recover files even when all file system metadata is gone.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1507413245164-6160d8298b31?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Fragmented File Reconstruction",
                            "content": "<p>File carving works best for small, contiguous files. Larger files (like videos or documents) are often fragmented, meaning their data blocks are not stored next to each other on the disk. Reconstructing these files is a major challenge.</p><h3>The Challenge of Fragmentation:</h3><p>A simple file carving tool will find the header and carve for a certain size, but it will miss the parts of the file that are stored elsewhere on the disk. Advanced carving tools use more complex algorithms to try and find these non-contiguous fragments and piece them back together, but it is not always successful.</p>",
                            "image": "https://images.unsplash.com/photo-1518932945647-7a1c969f8be2?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "When you delete a file from a hard drive, the data is:", "options": ["Immediately and permanently erased", "Uploaded to a secure cloud server", "Usually just marked for deletion, while the data itself remains on the disk until it is overwritten", "Encrypted"], "correct": 2, "explanation": "This fundamental principle is what makes data recovery possible. The link to the file is removed, but the data often remains." },
                        { "id": 2, "question": "The technique of searching raw disk data for known file headers (like `FF D8 FF`) to recover files is called:", "options": ["Timestomping", "Hashing", "File Carving", "Write Blocking"], "correct": 2, "explanation": "File carving 'carves' files out of the raw data based on their distinct starting (and sometimes ending) signatures." },
                        { "id": 3, "question": "File carving is least effective on what type of files?", "options": ["Small image files", "Large, fragmented files", "Text files", "Files stored contiguously"], "correct": 1, "explanation": "Fragmentation scatters a file's data across the disk, making it very difficult for a carving tool to find and reassemble all the correct pieces." }
                    ]
                }
            },
            {
                "id": "lesson-13-timeline-analysis",
                "title": "Lesson 13: Timeline Analysis",
                "duration": "150 min",
                "objectives": [
                    "Understand the importance of building a detailed investigation timeline",
                    "Correlate timestamps from file systems, logs, and other artifacts",
                    "Use super timeline analysis to visualize all system activity",
                    "Leverage timeline analysis to reconstruct an attack sequence"
                ],
                "content": {
                    "overview": "A forensic investigation generates thousands of data points. Timeline analysis is the fundamental technique used to organize this data, correlate events, and ultimately tell the story of what happened on a system. This lesson covers the creation and analysis of detailed timelines that combine artifacts from every part of a system.",
                    "sections": [
                        {
                            "title": "Timeline Creation Methods",
                            "content": "<p>A timeline arranges every piece of timestamped evidence in chronological order. This allows an investigator to see the sequence of events and understand cause and effect.</p><h3>The Super Timeline:</h3><p>The most powerful form of timeline analysis is the 'super timeline'. This is a single, massive timeline that combines timestamps from every possible source on the system:</p><ul><li><strong>File System:</strong> All MAC-B timestamps for every file from the MFT.</li><li><strong>Registry:</strong> Last write times for all Registry keys.</li><li><strong>Event Logs:</strong> All entries from Windows Event Logs or Linux syslogs.</li><li><strong>Browser History:</strong> Timestamps for all web visits.</li><li><strong>Other Artifacts:</strong> Any other piece of data with a timestamp.</li></ul><p>The result is a comprehensive, second-by-second log of all activity on the machine.</p><div class='info-box note'><div class='info-box-header'><i class='fas fa-info-circle'></i><strong>Automated Tools</strong></div><p>Creating a super timeline manually would be impossible. Forensic suites like Autopsy and command-line tools like Plaso (`log2timeline`) automate the process of extracting all of these artifacts and arranging them into a single chronological timeline for analysis.</p></div>",
                            "image": "https://images.unsplash.com/photo-1542438408-abb2021e1837?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Event Correlation",
                            "content": "<p>With a super timeline, you can see the direct relationship between different events. This is how you tell the story of an attack.</p><h3>Example Correlation:</h3><ol><li><strong>10:30:15:</strong> Browser history shows the user visited `evil.com/malware.exe`.</li><li><strong>10:30:16:</strong> A file creation event for `malware.exe` appears in the MFT in the user's `Downloads` folder.</li><li><strong>10:31:05:</strong> A Prefetch file for `malware.exe` is created, showing the program was executed.</li><li><strong>10:31:06:</strong> A new 'Run' key pointing to `malware.exe` is created in the user's `NTUSER.DAT` registry hive.</li><li><strong>10:31:07:</strong> A Windows Firewall rule is modified, as seen in the Event Logs.</li></ol><p>This timeline clearly shows the sequence: download, execution, and establishment of persistence.</p>",
                            "image": "https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "What is a 'super timeline' in digital forensics?", "options": ["A very fast stopwatch", "A timeline that only includes log files", "A combined, chronological timeline of all timestamped activity from all artifacts on a system", "A project management tool"], "correct": 2, "explanation": "A super timeline is a comprehensive view that correlates artifacts from the file system, registry, logs, and more into a single chronological sequence." },
                        { "id": 2, "question": "In Windows, MAC-B timestamps refer to what four pieces of metadata?", "options": ["Modified, Accessed, Copied, Backed-up", "Modified, Altered, Created, Borne", "Modified, Accessed, Created, MFT Entry Modified", "Machine, Address, Contact, Backup"], "correct": 2, "explanation": "These four timestamps are present in the MFT for each file and provide crucial information about when a file was created, used, and modified." },
                        { "id": 3, "question": "The primary goal of timeline analysis is to:", "options": ["Determine the brand of the hard drive", "Reconstruct the sequence of events on a system to understand what happened", "Validate forensic tools", "Calculate the age of the user"], "correct": 1, "explanation": "Timelines are a storytelling tool. They turn a mountain of disconnected data into a chronological narrative of the incident." }
                    ]
                }
            },
            {
                "id": "lesson-14-internet-forensics",
                "title": "Lesson 14: Internet Activity Forensics",
                "duration": "120 min",
                "objectives": [
                    "Identify and analyze web browser artifacts (Chrome, Firefox, Edge)",
                    "Examine browser cache, history, and cookie files",
                    "Investigate a user's download and search history",
                    "Correlate browser data with other system and network artifacts"
                ],
                "content": {
                    "overview": "A user's web browser is a treasure trove of information about their online activity. This lesson focuses on the forensic analysis of web browser artifacts to investigate what websites a user visited, what they searched for, and what files they downloaded.",
                    "sections": [
                        {
                            "title": "Web Browser Artifact Analysis",
                            "content": "<p>Modern web browsers (like Chrome, Firefox, and Edge) record a vast amount of user activity, typically storing it in a series of SQLite databases within the user's profile directory.</p><h3>Key Artifacts:</h3><ul><li><strong>History:</strong> A database containing a timestamped log of every URL the user visited.</li><li><strong>Cache:</strong> A local copy of website components (images, scripts, etc.) stored on the hard drive to speed up future visits. Even if a user clears their history, the cache may still contain evidence of a site visit.</li><li><strong>Cookies:</strong> Small files that websites use to track user sessions and preferences. They can be used to prove a user logged into a specific website.</li><li><strong>Downloads:</strong> A database logging all files downloaded by the user, including the source URL and the local file path.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1563986768609-322da13575f3?w=800&h=400&fit-crop"
                        },
                        {
                            "title": "SQLite Databases",
                            "content": "<p>Since most browser artifacts are stored in SQLite databases, an examiner needs tools to parse and query them. Specialized forensic tools like Autopsy can parse these files automatically. An investigator can also use a standalone SQLite browser to manually examine the tables and even recover deleted entries from within the database files.</p>",
                            "image": "https://images.unsplash.com/photo-1522252234503-e356032cafd5?w=800&h=400&fit-crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "To find out which websites a user has visited, an examiner would primarily analyze the browser's:", "options": ["Cache", "History database", "Cookie file", "Settings file"], "correct": 1, "explanation": "The history file is a direct, timestamped log of visited URLs." },
                        { "id": 2, "question": "What kind of browser artifact can prove a user was logged into a specific online account?", "options": ["The download history", "The cache", "A session cookie", "The bookmarks file"], "correct": 2, "explanation": "Session cookies are used by websites to keep a user logged in, so their presence is strong evidence of an active session." },
                        { "id": 3, "question": "Modern browsers like Chrome and Firefox store most of their user activity data in what type of file format?", "options": ["Text files", "Windows Registry hives", "SQLite databases", "Encrypted blobs"], "correct": 2, "explanation": "SQLite is a lightweight, file-based database format that is used extensively in browsers and mobile applications." }
                    ]
                }
            },
            {
                "id": "lesson-15-email-forensics",
                "title": "Lesson 15: Email Forensics",
                "duration": "120 min",
                "objectives": [
                    "Analyze email headers to trace an email's origin and path",
                    "Examine local email client files like PST (Outlook)",
                    "Understand techniques for investigating cloud-based webmail",
                    "Recover deleted emails from email files and servers"
                ],
                "content": {
                    "overview": "Email is a primary communication vector and often central to an investigation, from phishing attacks to insider threats. This lesson covers the techniques for analyzing email evidence, focusing on tracing an email's path through header analysis and examining the data containers used by email clients.",
                    "sections": [
                        {
                            "title": "Email Header Analysis",
                            "content": "<p>The email header contains the technical details of an email's journey across the internet. It is the single most important artifact for verifying an email's authenticity and origin.</p><h3>Key Header Fields:</h3><ul><li><strong>`From` field:</strong> This is what the user sees, but it can be easily spoofed.</li><li><strong>`Received` fields:</strong> This is the crucial part. Each mail server that handles an email adds a `Received` header block. By reading these from bottom to top, you can trace the true path the email took across the internet. The bottom-most `Received` header shows the true originating IP address.</li><li><strong>`Reply-To` field:</strong> In a phishing email, an attacker may spoof a legitimate 'From' address but set a different 'Reply-To' address where they want the victim's response to go.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1584433144853-6d3c470876d2?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "PST/OST File Examination",
                            "content": "<p>Microsoft Outlook, the most common corporate email client, stores its data in local files on the user's computer.</p><h3>Outlook Data Files:</h3><ul><li><strong>`.pst` (Personal Storage Table):</strong> Used for POP3 accounts and for archiving old email. It's a self-contained database of the user's mail.</li><li><strong>`.ost` (Offline Storage Table):</strong> Used for Exchange and IMAP accounts. It is a local cache of the user's mailbox that is stored on the server.</li></ul><p>Forensic tools can parse these files to reconstruct the user's entire mailbox, including recovering deleted items that have not yet been purged.</p>",
                            "image": "https://images.unsplash.com/photo-1555949963-aa79dcee981c?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "To determine the true originating IP address of an email, an investigator must analyze what?", "options": ["The 'From' address", "The email's subject line", "The email's header, specifically the 'Received' fields", "The signature at the bottom of the email"], "correct": 2, "explanation": "The 'Received' headers act like a series of postmarks, showing the path the email traveled. The first 'Received' header (at the bottom) reveals the original source." },
                        { "id": 2, "question": "A `.pst` file is a data container associated with which application?", "options": ["Mozilla Firefox", "Linux Kernel", "Microsoft Outlook", "Adobe Photoshop"], "correct": 2, "explanation": "The .pst (and .ost) file formats are used by Microsoft Outlook to store email, calendar, and contact data." },
                        { "id": 3, "question": "Can the 'From' address in an email be easily forged?", "options": ["No, it is impossible to forge", "Yes, it is trivial to spoof the 'From' address", "Only by government agencies", "Only on Tuesdays"], "correct": 1, "explanation": "The 'From' field is not validated by the email protocol (SMTP) and can be set to any value, which is why phishing attacks are so common. Investigators must rely on the headers for truth." }
                    ]
                }
            },
            {
                "id": "lesson-16-database-forensics",
                "title": "Lesson 16: Database Forensics",
                "duration": "120 min",
                "objectives": [
                    "Understand basic database structures and concepts",
                    "Analyze database transaction logs to reconstruct activity",
                    "Attempt to recover deleted records from a database",
                    "Investigate database security events and access violations"
                ],
                "content": {
                    "overview": "Databases are the crown jewels of many organizations, storing critical business and customer data. This lesson provides an introduction to database forensics, focusing on how to analyze the internal logs and structures of a database to investigate unauthorized access, data theft, or fraud.",
                    "sections": [
                        {
                            "title": "Transaction Log Examination",
                            "content": "<p>A database transaction log is the most important artifact in a database investigation. It is a detailed, sequential record of every single change made to the database.</p><h3>What Logs Reveal:</h3><ul><li><strong>Data Modification:</strong> Every INSERT, UPDATE, and DELETE statement is recorded.</li><li><strong>The 'Before' and 'After' Image:</strong> The log often records the value of the data *before* a change and the value *after* the change, which is crucial for investigating unauthorized modifications.</li><li><strong>User and Time:</strong> The log records which user account made the change and the exact time it occurred.</li></ul><p>By analyzing the transaction log, an investigator can reconstruct the full history of activity in the database, even for data that was later deleted.</p>",
                            "image": "https://images.unsplash.com/photo-1558494949-ef010cbdcc31?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Deleted Record Recovery",
                            "content": "<p>When a record is deleted from a database table, many database systems don't immediately erase it. Instead, they just 'flag' the record as deleted. The actual data may remain within the data file. Specialized forensic tools can parse the database file directly to find and 'un-flag' these deleted records, making them readable again.</p>",
                            "image": "https://images.unsplash.com/photo-1542382156942-0268579cf259?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "What is the most critical source of evidence for reconstructing the history of changes made to a database?", "options": ["The system event log", "The database schema", "The database transaction log", "The database user manual"], "correct": 2, "explanation": "The transaction log is the authoritative, sequential record of every data modification (INSERT, UPDATE, DELETE) and is the cornerstone of database forensics." },
                        { "id": 2, "question": "In a fraud investigation, analyzing the transaction log's 'before' and 'after' images can help to:", "options": ["Determine the physical location of the server", "Identify exactly how an attacker changed a financial record", "Measure the network performance of the database", "Reset the administrator's password"], "correct": 1, "explanation": "This allows an investigator to see the original value and the fraudulent new value, providing direct evidence of tampering." }
                    ]
                }
            },
            {
                "id": "lesson-17-network-forensics-intro",
                "title": "Lesson 17: Network Forensics Introduction",
                "duration": "120 min",
                "objectives": [
                    "Identify the primary types of network evidence",
                    "Use Wireshark to perform basic packet capture analysis",
                    "Reconstruct a basic network timeline",
                    "Correlate network events with host-based intrusion data"
                ],
                "content": {
                    "overview": "Network forensics provides the big picture, showing how an attacker enters a network, moves between systems, and exfiltrates data. This lesson introduces the core concepts of network forensics, focusing on the analysis of packet captures to understand network conversations.",
                    "sections": [
                        {
                            "title": "Network Evidence Types",
                            "content": "<p>Network investigations rely on three primary sources of data, often called the 'network forensic triangle'.</p><h3>The Evidence Triangle:</h3><ul><li><strong>Full Packet Capture (PCAP):</strong> The ground truth. Captures everything, but is very high volume.</li><li><strong>NetFlow/Metadata:</strong> The high-level summary. Shows who talked to whom and for how long.</li><li><strong>Logs:</strong> Contextual data from network devices like firewalls and DNS servers, showing what was allowed, blocked, or requested.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1594917951231-98745c43d779?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Packet Capture Analysis",
                            "content": "<p>Full packet captures (PCAP) provide the richest source of network evidence. Analyzing them with a tool like Wireshark allows you to see the exact data that was exchanged between two systems.</p><h3>Key Analysis Techniques:</h3><ul><li><strong>Filtering:</strong> The most important skill is filtering traffic to isolate the conversations of interest.</li><li><strong>Following Streams:</strong> Wireshark can reconstruct entire TCP or UDP conversations, showing you the application-level data, such as a downloaded file or the commands in a remote shell session.</li><li><strong>Carving Files:</strong> It's possible to extract files being transferred over protocols like HTTP or FTP directly from a PCAP file for analysis.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1544890225-2fde1e46f71b?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "Which source of network evidence provides only summary information about connections (e.g., source IP, dest IP, bytes sent) but not the actual content?", "options": ["PCAP", "Firewall Logs", "NetFlow", "Wireshark"], "correct": 2, "explanation": "NetFlow is metadata about network traffic, not the traffic itself, making it much smaller to store than full PCAP." },
                        { "id": 2, "question": "What is the de facto industry standard tool for analyzing PCAP files?", "options": ["Autopsy", "EnCase", "Volatility", "Wireshark"], "correct": 3, "explanation": "Wireshark is the world's most popular network protocol analyzer and an essential tool for any network investigator." }
                    ]
                }
            },
            {
                "id": "lesson-18-mobile-forensics",
                "title": "Lesson 18: Mobile Device Forensics",
                "duration": "120 min",
                "objectives": [
                    "Understand the challenges of mobile evidence acquisition",
                    "Recognize the key forensic differences between iOS and Android",
                    "Analyze application data to find evidence of user activity",
                    "Recover communication artifacts like SMS texts, chats, and call logs"
                ],
                "content": {
                    "overview": "Mobile devices are a primary source of evidence in almost every type of investigation today. This lesson covers the specialized field of mobile forensics, exploring the unique challenges of acquiring data from modern smartphones and the key artifacts that can be found on iOS and Android platforms.",
                    "sections": [
                        {
                            "title": "iOS vs. Android Differences",
                            "content": "<p>While both are mobile operating systems, iOS and Android have fundamentally different security models that impact forensic analysis.</p><h3>The Two Platforms:</h3><ul><li><strong>iOS (Apple):</strong> A very closed and controlled ecosystem. It is extremely difficult to perform a physical acquisition on a modern, encrypted iPhone. Investigators often have to rely on a logical acquisition from a backup of the device.</li><li><strong>Android (Google):</strong> A more open ecosystem. This allows for a greater variety of forensic techniques, and it is often easier to achieve a file system or even physical acquisition, especially on devices that can be 'rooted'.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1607252650355-f7fd0460ccdb?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Communication Artifact Recovery",
                            "content": "<p>Mobile devices are communication hubs. The most valuable evidence is often found in the databases and files that store a user's messages, calls, and social media activity.</p><h3>Key Artifacts:</h3><ul><li><strong>Call Logs:</strong> A database of all incoming, outgoing, and missed calls.</li><li><strong>SMS/MMS Messages:</strong> The content of text messages is stored in a database.</li><li><strong>Third-Party Chat Apps:</strong> Data from apps like WhatsApp, Signal, or Telegram is stored in the app's sandboxed data container. Accessing this data is a key goal of a mobile examination.</li><li><strong>Geolocation Data:</strong> Photos can have EXIF metadata with GPS coordinates, and the phone itself stores a log of cell tower and Wi-Fi locations it has connected to, creating a detailed map of the user's movements.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1585250184288-5175908b083c?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "Which mobile operating system is generally considered a more 'closed' and difficult target for forensic acquisition?", "options": ["Android", "Windows Phone", "iOS", "Symbian"], "correct": 2, "explanation": "Apple's tight control over the hardware and software on iOS devices makes them a significantly harder forensic challenge than the more open Android ecosystem." },
                        { "id": 2, "question": "Evidence of a user's physical location can often be found in what type of mobile data?", "options": ["The system cache", "SMS text message databases", "EXIF data in photos and Wi-Fi connection logs", "The device's phone number"], "correct": 2, "explanation": "Geolocation artifacts are powerful for establishing a user's whereabouts at a specific time." },
                        { "id": 3, "question": "On mobile devices, data from an app like WhatsApp is stored where?", "options": ["In the operating system kernel", "On a removable SD card only", "In the application's own sandboxed data container", "In the device's SIM card"], "correct": 2, "explanation": "Mobile OSes sandbox apps for security, meaning each app has its own protected area to store its data. Analyzing these containers is a core part of mobile forensics." }
                    ]
                }
            },
            {
                "id": "lesson-19-cloud-forensics",
                "title": "Lesson 19: Cloud Forensics Basics",
                "duration": "120 min",
                "objectives": [
                    "Recognize the unique challenges of acquiring and analyzing evidence from the cloud",
                    "Understand forensic techniques for SaaS, PaaS, and IaaS environments",
                    "Analyze cloud control plane logs as a primary source of evidence",
                    "Learn how to perform forensics on virtual machines"
                ],
                "content": {
                    "overview": "As data moves from local hard drives to the cloud, forensic techniques must adapt. This lesson provides an introduction to cloud forensics, covering the challenges of a multi-tenant, API-driven environment and focusing on the new types of evidence, like control plane logs, that are central to a cloud investigation.",
                    "sections": [
                        {
                            "title": "Cloud Evidence Challenges",
                            "content": "<p>Cloud environments fundamentally change how forensic evidence is collected and analyzed.</p><h3>Key Differences:</h3><ul><li><strong>No Physical Access:</strong> You cannot physically seize a server. All evidence acquisition is done remotely via APIs provided by the cloud service provider (CSP).</li><li><strong>Shared Responsibility:</strong> You don't have access to the underlying hardware or network traffic logs from the CSP's infrastructure. You can only analyze the logs and resources that exist within your own cloud account.</li><li><strong>Data Volatility:</strong> The cloud is dynamic and ephemeral. Resources can be shut down and deleted in seconds, destroying all evidence if logging is not properly configured beforehand.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1607513746974-2c6444f49e75?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Virtual Machine Forensics",
                            "content": "<p>In an Infrastructure-as-a-Service (IaaS) environment, your primary asset is the virtual machine (VM). The process for analyzing a VM is similar to a physical server, but the acquisition is done via API.</p><h3>VM Forensic Workflow:</h3><ol><li><strong>Isolate the VM:</strong> Use cloud security groups (like a virtual firewall) to isolate the compromised VM from the network.</li><li><strong>Take a Snapshot:</strong> Use the cloud provider's API to take a point-in-time snapshot of the VM's disk.</li><li><strong>Analyze the Snapshot:</strong> Create a new disk volume from the snapshot and attach it as a secondary, non-boot drive to a clean forensic analysis VM within the same cloud environment. You can then mount it read-only and perform your analysis.</li></ol>",
                            "image": "https://images.unsplash.com/photo-1558494949-ef010cbdcc31?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Cloud Log Analysis",
                            "content": "<p>In any cloud investigation, the most important source of evidence is the control plane log. This is the audit trail of every single API call made within your account.</p><h3>Key Cloud Logs:</h3><ul><li><strong>AWS:</strong> CloudTrail</li><li><strong>Azure:</strong> Activity Log</li><li><strong>Google Cloud:</strong> Cloud Audit Logs</li></ul><p>These logs will show you if an attacker used compromised credentials to create new VMs, delete storage buckets, or disable security settings. They are the ground truth for who did what, and when, in your cloud environment.</p>",
                            "image": "https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "What is the primary method for acquiring a disk image of a virtual machine in the cloud?", "options": ["Physically removing the hard drive", "Using a hardware write blocker", "Using the cloud provider's API to take a disk snapshot", "There is no way to image a cloud server"], "correct": 2, "explanation": "Cloud forensics is API-driven. A snapshot is the cloud-native equivalent of a bit-by-bit disk image." },
                        { "id": 2, "question": "In AWS, the definitive audit trail of all API calls and actions taken within your account is found in:", "options": ["EC2 logs", "S3 logs", "CloudTrail logs", "VPC Flow logs"], "correct": 2, "explanation": "CloudTrail is the control plane log for AWS and is the single most critical source of evidence in an AWS investigation." },
                        { "id": 3, "question": "What is meant by the 'shared responsibility model' in cloud forensics?", "options": ["You and your cloud provider are equally responsible for everything", "The cloud provider secures the underlying cloud infrastructure, while you are responsible for securing what you put in the cloud", "You are responsible for paying half of the cloud bill", "The forensic investigation is performed jointly with the cloud provider"], "correct": 1, "explanation": "This is a fundamental concept. It means your investigation is limited to the data and resources you control within your account." }
                    ]
                }
            },
            {
                "id": "lesson-20-memory-forensics",
                "title": "Lesson 20: Memory Forensics Introduction",
                "duration": "120 min",
                "objectives": [
                    "Understand the importance of analyzing volatile memory",
                    "Learn techniques for acquiring a memory dump from a live system",
                    "Use tools to analyze processes, network connections, and command history from a memory image",
                    "Recognize how memory forensics can detect malware that is not on the hard drive"
                ],
                "content": {
                    "overview": "Some of the most critical evidence in an investigation exists only in a computer's volatile memory (RAM) and is lost forever when the system is shut down. This lesson introduces the crucial sub-field of memory forensics, which focuses on capturing and analyzing this volatile data to find evidence of malware, user activity, and system state.",
                    "sections": [
                        {
                            "title": "Volatile Memory Analysis",
                            "content": "<p>Volatile memory analysis is the examination of a snapshot of a computer's RAM. It is essential for modern investigations, especially with the rise of 'fileless' malware that runs only in memory to evade detection on the disk.</p><h3>Why Memory Forensics is Critical:</h3><ul><li><strong>Finds Hidden Processes:</strong> Can identify malicious processes, including rootkits that are hidden from the live operating system.</li><li><strong>Reveals Network Activity:</strong> Shows a list of all network connections that were active at the time of capture and which process owned them.</li><li><strong>Captures User Activity:</strong> Can recover command-line history, passwords, and even the contents of open documents or chat windows.</li><li><strong>Detects Fileless Malware:</strong> It is the primary method for detecting malware that is injected directly into a legitimate process and never writes a file to the disk.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1550751827-4138d04d47ee?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Memory Acquisition Techniques",
                            "content": "<p>Acquiring a memory dump must be done on a live, running system before it is powered down. This is a delicate process, as the acquisition tool itself will alter memory slightly.</p><h3>Acquisition Tools:</h3><ul><li>Specialized command-line tools (like FTK Imager Lite or Belkasoft Live RAM Capturer) are run on the live system, typically from a trusted USB drive.</li><li>The tool captures the entire contents of physical RAM and saves it to a single file (a 'memory dump').</li><li>This dump file is then taken to a forensic workstation for offline analysis.</li></ul><div class='info-box tip'><div class='info-box-header'><i class='fas fa-lightbulb'></i><strong>Order of Volatility</strong></div><p>As covered in previous lessons, memory acquisition must be done first, before any action (like shutting the system down) that would destroy the volatile data.</p></div>",
                            "image": "https://images.unsplash.com/photo-1593110022831-292911b3b194?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Analysis with The Volatility Framework",
                            "content": "<p>The Volatility Framework is the open-source industry standard for analyzing memory dumps. It is a powerful Python-based tool with a library of plugins that can parse the complex data structures in a memory image.</p><h3>Common Volatility Plugins:</h3><ul><li><strong>`pslist` / `pstree`:</strong> Lists all running processes and shows them in a parent-child tree.</li><li><strong>`netscan`:</strong> Shows active network connections.</li><li><strong>`cmdscan` / `consoles`:</strong> Dumps command history from console windows.</li><li><strong>`malfind`:</strong> A powerful plugin that finds injected code and other suspicious memory regions commonly associated with malware.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1571171637578-41bc2dd41cd2?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "Data in RAM that is lost when a computer is powered off is known as:", "options": ["Persistent data", "Encrypted data", "Volatile data", "Archived data"], "correct": 2, "explanation": "Volatile means temporary and subject to change or loss, which is the defining characteristic of RAM." },
                        { "id": 2, "question": "What is 'fileless' malware?", "options": ["Malware that is very small", "Malware that exists only in memory and never writes a file to the hard drive", "Malware that is not malicious", "Malware that has been deleted"], "correct": 1, "explanation": "Fileless malware uses techniques like process injection to run its code within the address space of legitimate processes, making memory analysis the primary way to detect it." },
                        { "id": 3, "question": "What is the industry-standard, open-source tool for analyzing memory dumps?", "options": ["Wireshark", "Autopsy", "The Volatility Framework", "EnCase"], "correct": 2, "explanation": "Volatility is the most widely used and powerful framework for parsing the raw data in a memory image and extracting forensic artifacts." },
                        { "id": 4, "question": "When should memory acquisition be performed during an investigation?", "options": ["At the very end of the investigation", "After the hard drive has been imaged", "As the very first step on a live, running machine, before it is powered down", "It is not a necessary step"], "correct": 2, "explanation": "Based on the order of volatility, memory evidence is the most fragile and must be captured first before it is lost." }
                    ]
                }
            },
            {
                "id": "lesson-21-data-analysis",
                "title": "Lesson 21: Data Analysis Techniques",
                "duration": "120 min",
                "objectives": [
                    "Apply statistical methods to identify anomalies in large datasets",
                    "Use pattern recognition to find common malicious indicators",
                    "Correlate data from multiple evidence sources to build a cohesive narrative",
                    "Leverage data visualization to make complex findings understandable"
                ],
                "content": {
                    "overview": "With all the evidence collected and examined, the next step is analysis – the process of making sense of the data. This lesson covers higher-level analytical techniques used to find the 'signal in the noise', correlate disparate artifacts, and turn a mountain of raw data into a coherent investigative story.",
                    "sections": [
                        {
                            "title": "Correlation Analysis",
                            "content": "<p>Correlation is the process of linking individual pieces of evidence from different sources to create a timeline and understand relationships. It is the core of forensic analysis.</p><h3>Example Correlation Workflow:</h3><ol><li>A <strong>network log</strong> shows a connection from the internal host 192.168.1.100 to a malicious external IP at 10:00 PM.</li><li><strong>Host-based memory analysis</strong> from 192.168.1.100 at 10:05 PM shows that the process `malware.exe` was making that connection.</li><li><strong>File system analysis</strong> shows `malware.exe` was created at 9:55 PM.</li><li><strong>Browser forensics</strong> shows the user downloaded `malware.exe` from a phishing link at 9:54 PM.</li></ol><p>By correlating these four sources, you have built a complete narrative of the compromise.</p>",
                            "image": "https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Data Visualization",
                            "content": "<p>A picture is worth a thousand log entries. Data visualization can make complex relationships and patterns instantly apparent. Forensic platforms are increasingly incorporating sophisticated visualization tools.</p><h3>Common Visualizations:</h3><ul><li><strong>Timelines:</strong> Visualizing events on a chronological graph to spot clusters of activity.</li><li><strong>Link Analysis Graphs:</strong> Showing the relationships between entities, such as a graph of a user account accessing different machines, which can clearly show lateral movement.</li><li><strong>Heat Maps:</strong> Visualizing activity density, such as a map of the world showing the geographic source of login attempts.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1563986768609-322da13575f3?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "The primary purpose of data correlation in a forensic investigation is to:", "options": ["Make the final report longer", "Link individual artifacts from different sources to reconstruct the sequence of events", "Validate forensic tools", "Anonymize sensitive data"], "correct": 1, "explanation": "Correlation is the sense-making process that connects disparate data points (e.g., a network log to a process on a host) to build a narrative." },
                        { "id": 2, "question": "A link analysis graph is a visualization tool that is particularly good at showing what?", "options": ["The contents of a file", "The amount of data on a hard drive", "Relationships and connections between different entities (e.g., users, hosts, IPs)", "The time of day"], "correct": 2, "explanation": "Link analysis is excellent for visualizing complex relationships, making it ideal for tracking things like an attacker's lateral movement path." }
                    ]
                }
            },
            {
                "id": "lesson-22-steganography-encryption",
                "title": "Lesson 22: Steganography and Encryption",
                "duration": "120 min",
                "objectives": [
                    "Define steganography and how it is used to hide data",
                    "Use tools to detect the presence of steganographically hidden data",
                    "Learn to identify encrypted files and containers",
                    "Understand basic techniques for password recovery and decryption"
                ],
                "content": {
                    "overview": "Attackers and insiders often use steganography and encryption to hide their data and evade detection. This lesson introduces these two data hiding techniques, covering how to detect them and the approaches an investigator can take to try and recover the hidden information.",
                    "sections": [
                        {
                            "title": "Steganography Detection",
                            "content": "<p>Steganography is the art and science of hiding data within another piece of data, typically an image, audio, or video file. The goal is to conceal the very existence of the hidden message.</p><h3>How it Works:</h3><p>A steganography tool might make tiny, mathematically insignificant changes to the color values of pixels in an image to encode a hidden text file. To the human eye, the original image and the stego-image look identical.</p><h3>Detection:</h3><p>Detecting steganography often involves statistical analysis of the carrier file. Specialized tools (steganalysis tools) analyze the file's properties to look for statistical anomalies that suggest data has been embedded within it. There is no single foolproof method; it is a challenging field of forensics.</p>",
                            "image": "https://images.unsplash.com/photo-1526374965328-7f61d4e18c66?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Encryption Identification",
                            "content": "<p>Encryption doesn't hide the existence of a file, but it makes the contents unreadable without the correct key. The first step is to identify that a file is encrypted.</p><h3>Indicators of Encryption:</h3><ul><li><strong>File Headers:</strong> Many encrypted container formats (like VeraCrypt or BitLocker) have their own file headers that forensic tools can recognize.</li><li><strong>High Entropy:</strong> A key characteristic of encrypted data is that it is highly random. Entropy is a measure of randomness. A file with very high entropy is a strong candidate for being encrypted or heavily compressed. Forensic tools can calculate the entropy of files to help identify encrypted data.</li></ul><h3>Password Recovery:</h3><p>If you encounter an encrypted file, recovering the data depends on getting the password. Techniques include:</p><ul><li><strong>Brute-force/Dictionary Attacks:</strong> Using tools (like John the Ripper or Hashcat) to try millions of password combinations against the file.</li><li><strong>Forensic Artifacts:</strong> The password may be found elsewhere on the system, for example, in a user's password manager, a text file on their desktop, or even recoverable from a memory dump.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1599373922312-5b9340d8a5a5?w=800&h=400&fit-crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "What is the primary goal of steganography?", "options": ["To make a file smaller", "To make a file unreadable without a key", "To hide the very existence of a piece of data inside another file", "To delete a file permanently"], "correct": 2, "explanation": "Steganography is about concealment. Encryption scrambles a message; steganography hides the fact that a message even exists." },
                        { "id": 2, "question": "A key statistical characteristic of an encrypted file is that it has:", "options": ["Very low entropy (very structured)", "Very high entropy (very random)", "A small file size", "A .zip extension"], "correct": 1, "explanation": "A well-encrypted file is mathematically indistinguishable from random noise, giving it very high entropy. This is a primary method for identifying unknown encrypted files." },
                        { "id": 3, "question": "The tool `John the Ripper` is used for what purpose?", "options": ["Network packet capture", "Forensic imaging", "Password cracking", "Steganography detection"], "correct": 2, "explanation": "`John the Ripper` and `Hashcat` are two of the most popular and powerful tools used for password recovery and cracking." }
                    ]
                }
            },
            {
                "id": "lesson-23-anti-forensics",
                "title": "Lesson 23: Anti-Forensics Awareness",
                "duration": "120 min",
                "objectives": [
                    "Recognize techniques used to wipe data and thwart recovery",
                    "Identify the signs of timestamp manipulation",
                    "Detect log tampering and clearing",
                    "Understand how encryption and obfuscation are used to hide data"
                ],
                "content": {
                    "overview": "Skilled adversaries know you will be looking for them, and they take active steps to hide their tracks or destroy evidence. This lesson covers the field of anti-forensics—the techniques used by attackers to subvert your investigation—and, more importantly, how to detect the tell-tale signs of those techniques.",
                    "sections": [
                        {
                            "title": "Data Wiping and Destruction",
                            "content": "<p>Unlike a simple file deletion, data wiping tools are designed to securely overwrite data, making it unrecoverable even with advanced forensic techniques. An attacker may use these tools on their own files or as a final destructive act.</p><h3>Signs of Wiping:</h3><p>Even if the data is gone, the tool that did the wiping might not be. Look for the presence of wiping utilities (like `SDelete` or `CCleaner`) or unusual disk activity logs. A wiped drive will also have very low entropy (filled with zeros or a repeating pattern), which is itself an anomaly.</p>",
                            "image": "https://images.unsplash.com/photo-1547756536-cde55c3f2c65?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Timestamp Manipulation (Timestomping)",
                            "content": "<p>Attackers will often use 'timestomping' tools to change the MAC timestamps of their malicious files. They will modify a file's creation and modification dates to match those of legitimate system files in the same directory, hoping an examiner will overlook them.</p><h3>Detecting Timestomping:</h3><p>This is where the fourth timestamp in an NTFS MFT entry—the Entry Modified (`$FN.Attribute`) time—becomes critical. Timestomping tools often only change the Standard Information (`$SI.Attribute`) timestamps. If an investigator finds a file where the `$SI` created date is years old, but the `$FN` MFT entry modified date is from yesterday, it is a massive red flag for timestomping.</p>",
                            "image": "https://images.unsplash.com/photo-1542438408-abb2021e1837?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Log Tampering Detection",
                            "content": "<p>Attackers will try to clear or modify log files to erase evidence of their presence.</p><h3>Signs of Tampering:</h3><ul><li><strong>Centralized Log Gaps:</strong> The most important defense is a SIEM. If the attacker clears the logs on a local host, but you have the logs from right up until that point in your SIEM, you have evidence of when the tampering occurred.</li><li><strong>Log Discontinuity:</strong> Gaps in the sequence numbers or timestamps within a log file can indicate that entries have been deleted.</li><li><strong>Unusual Log Clearing Events:</strong> For example, Windows Event ID 1102 (The audit log was cleared) in the Security Log is a high-fidelity indicator of this anti-forensic technique.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1555099962-4199c345e541?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "The technique of altering a file's timestamps to make it blend in with older, legitimate files is known as:", "options": ["Log clearing", "Timestomping", "Data carving", "File wiping"], "correct": 1, "explanation": "Timestomping is a classic anti-forensic technique aimed at defeating timeline analysis." },
                        { "id": 2, "question": "What is the best defense against an attacker clearing the local event logs on a compromised machine?", "options": ["Disabling logging on the machine", "Using a hardware write blocker", "Having a centralized log collection system like a SIEM", "Asking the attacker not to clear the logs"], "correct": 2, "explanation": "A SIEM gets the logs off the box in near real-time. Once the logs are on the SIEM, the attacker cannot alter them, and their deletion of the local logs becomes, in itself, a detectable event." },
                        { "id": 3, "question": "Windows Security Event ID 1102 indicates what?", "options": ["A successful user logon", "A failed user logon", "A new software installation", "The audit log was cleared"], "correct": 3, "explanation": "Event ID 1102 is a critical alert for any security monitoring system, as it's a direct indication of an attacker (or rogue administrator) attempting to cover their tracks." }
                    ]
                }
            },
            {
                "id": "lesson-24-reporting",
                "title": "Lesson 24: Report Writing and Presentation",
                "duration": "120 min",
                "objectives": [
                    "Develop a clear and logical structure for a technical forensic report",
                    "Write a concise, non-technical executive summary for leadership",
                    "Effectively present complex technical evidence using visuals",
                    "Understand the basic requirements for preparing to testify in court"
                ],
                "content": {
                    "overview": "The final phase of any investigation is reporting. Your technical skills are wasted if you cannot clearly and persuasively communicate your findings to others. This lesson covers the essential skills of writing a formal forensic report and presenting your findings to both technical and non-technical audiences.",
                    "sections": [
                        {
                            "title": "Technical Report Structure",
                            "content": "<p>A formal forensic report is a detailed, factual account of your investigation. It should be structured in a way that allows a reader to understand your scope, your methods, and your conclusions.</p><h3>Standard Report Sections:</h3><ol><li><strong>Executive Summary:</strong> A brief, high-level summary. (See below).</li><li><strong>Case Details:</strong> Case number, investigator's name, dates of the investigation.</li><li><strong>Objectives:</strong> A clear statement of what the investigation was asked to determine.</li><li><strong>Evidence Analyzed:</strong> A list of all evidence items (e.g., hard drives, mobile devices) with their hashes.</li><li><strong>Methodology:</strong> A description of the forensic process and tools used.</li><li><strong>Findings:</strong> A detailed, factual description of the evidence found, often organized chronologically or by investigative question.</li><li><strong>Conclusion:</strong> A summary of the key findings and conclusions based *only* on the evidence.</li><li><strong>Appendices:</strong> Can include detailed logs, timelines, and examples of key evidence.</li></ol>",
                            "image": "https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Executive Summary Writing",
                            "content": "<p>The executive summary may be the only part of the report that senior leaders read. It must be clear, concise, and non-technical.</p><h3>The 'BLUF' Principle:</h3><p>Follow the military's 'Bottom Line Up Front' (BLUF) principle. Don't build up to your conclusion; state it clearly in the first paragraph.</p><ul><li><strong>What was investigated and why.</strong></li><li><strong>The most significant findings.</strong> (e.g., 'The investigation confirmed that the server was compromised and that 500 customer records were exfiltrated.')</li><li><strong>The key conclusion or recommendation.</strong></li></ul>",
                            "image": "https://images.unsplash.com/photo-1542744173-8e7e53415bb0?w=800&h=400&fit-crop"
                        },
                        {
                            "title": "Court Testimony Preparation",
                            "content": "<p>As a forensic examiner, you may be called to testify in court as a fact witness or an expert witness. This requires a specific set of skills.</p><h3>Key Preparation Steps:</h3><ul><li><strong>Know Your Report:</strong> You must know every detail of your report inside and out. Re-read it and all your case notes multiple times.</li><li><strong>Keep it Simple:</strong> Your job is to explain complex technical topics to a non-technical audience (the judge and jury). Use analogies and avoid jargon.</li><li><strong>Be Unbiased:</strong> You are a neutral expert. Your job is to state the facts as you found them, regardless of which side it helps.</li><li><strong>Work with Counsel:</strong> Work with the lawyer who has retained you to practice your testimony and prepare for cross-examination.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1589216532372-1c2a3679003a?w=800&h=400&fit-crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "What is the primary purpose of the executive summary in a forensic report?", "options": ["To list every file found on the hard drive", "To provide a concise, high-level overview of the findings for a non-technical audience", "To serve as a detailed technical appendix", "To hide the most important findings"], "correct": 1, "explanation": "The executive summary is crucial for communicating the key takeaways to leadership who may not read the full technical report." },
                        { "id": 2, "question": "A forensic report must always be:", "options": ["Based on speculation and opinion", "As short as possible, even if it leaves out details", "Factual, objective, and based only on the evidence uncovered during the investigation", "Written in a way that is difficult for anyone to understand"], "correct": 2, "explanation": "Objectivity and a factual basis are the hallmarks of a professional forensic report. The examiner's opinion must be supported by the evidence." },
                        { "id": 3, "question": "When testifying in court, a forensic examiner's primary role is to:", "options": ["Convince the jury that the defendant is guilty", "Act as a neutral expert and clearly explain the technical evidence and findings", "Act as a member of the legal team", "Use as much technical jargon as possible to sound impressive"], "correct": 1, "explanation": "The expert witness's job is to assist the court by explaining technical matters in an understandable way. They must remain impartial and objective." }
                    ]
                }
            },
            {
                "id": "lesson-25-malware-forensics",
                "title": "Lesson 25: Malware Forensics",
                "duration": "120 min",
                "objectives": [
                    "Combine file system, memory, and network forensics to analyze malware",
                    "Identify persistence mechanisms used by malware",
                    "Investigate command-and-control (C2) channels",
                    "Produce a comprehensive report on the malware's behavior and impact"
                ],
                "content": {
                    "overview": "Malware forensics is an integrated discipline that applies all the techniques you have learned to the specific problem of investigating a malicious software infection. This lesson covers the holistic process of analyzing malware's impact on a system, from its initial execution to its persistence and C2 communication.",
                    "sections": [
                        {
                            "title": "Persistence Mechanism Analysis",
                            "content": "<p>One of the most important goals of malware forensics is to determine how the malware achieves persistence. This is the key to eradicating it.</p><h3>Common Persistence TTPs:</h3><ul><li><strong>Windows Registry Run Keys:</strong> The most common method. The investigator must examine the standard `Run`, `RunOnce` keys and others.</li><li><strong>Scheduled Tasks / Cron Jobs:</strong> Creating a task on Windows or a cron job on Linux that executes the malware at regular intervals.</li><li><strong>Malicious Services:</strong> Creating a new service that starts automatically with the operating system.</li><li><strong>DLL Hijacking:</strong> Replacing a legitimate DLL with a malicious one that is loaded by a trusted application.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1563206767-5b18f218e8de?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Communication Channel Investigation",
                            "content": "<p>Investigating the malware's command-and-control (C2) communication is essential for understanding its capabilities and for containment.</p><h3>Analysis Steps:</h3><ol><li><strong>Identify C2 from Host:</strong> Use memory analysis (`netscan`) or dynamic analysis in a sandbox to see what IP addresses or domains the malware connects to.</li><li><strong>Analyze C2 from Network:</strong> Use your findings from the host to pivot to your network evidence. Search proxy logs, DNS logs, and PCAP for any other systems in your network that have communicated with the same C2 infrastructure.</li><li><strong>Characterize the Protocol:</strong> Is the C2 traffic using plain HTTP? Or is it a custom encrypted protocol? Analyzing the PCAP can reveal the beaconing interval, the commands being sent, and the data being exfiltrated.</li></ol>",
                            "image": "https://images.unsplash.com/photo-1599373922312-5b9340d8a5a5?w=800&h=400&fit-crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "What is a malware persistence mechanism?", "options": ["A technique the malware uses to infect new computers", "A technique the malware uses to ensure it will run again after a system reboot", "A technique the malware uses to steal data", "A technique the malware uses to hide its files"], "correct": 1, "explanation": "Persistence is a critical stage in the attack lifecycle, allowing malware to survive a reboot and maintain access to the compromised system." },
                        { "id": 2, "question": "To determine what other hosts in a network have been compromised by the same malware, an investigator would typically:", "options": ["Ask the user of the first machine", "Take the C2 IP addresses found on the first host and search network logs to find other machines connecting to them", "Shut down the entire network", "Reboot every computer in the company"], "correct": 1, "explanation": "This 'pivoting' from host evidence to network evidence is a fundamental technique for scoping the full extent of a breach." }
                    ]
                }
            },
            {
                "id": "lesson-26-incident-reconstruction",
                "title": "Lesson 26: Incident Reconstruction",
                "duration": "120 min",
                "objectives": [
                    "Synthesize all evidence into a complete event sequence",
                    "Perform a detailed analysis of the attack vectors",
                    "Develop a hypothesis of attacker intent and motivation",
                    "Create a detailed reconstruction narrative for the final report"
                ],
                "content": {
                    "overview": "With all evidence analyzed, the final step is to put the puzzle together. This lesson focuses on incident reconstruction: the process of synthesizing all the individual findings from file system, memory, network, and log analysis into a single, cohesive, end-to-end narrative that tells the complete story of the attack.",
                    "sections": [
                        {
                            "title": "Attack Vector Analysis",
                            "content": "<p>A critical part of the reconstruction is identifying the full attack chain, often mapped to a framework like the MITRE ATT&CK or the Cyber Kill Chain.</p><h3>Reconstructing the Chain:</h3><ul><li><strong>Initial Access:</strong> How did they first get in? (e.g., a phishing email).</li><li><strong>Execution & Persistence:</strong> What did they run and how did they stay? (e.g., ran PowerShell, created a scheduled task).</li><li><strong>Privilege Escalation:</strong> How did they become an administrator? (e.g., exploited a kernel vulnerability).</li><li><strong>Lateral Movement:</strong> How did they move to other machines? (e.g., used stolen credentials with RDP).</li><li><strong>Actions on Objectives:</strong> What was their ultimate goal? (e.g., located and exfiltrated the customer database).</li></ul>",
                            "image": "https://images.unsplash.com/photo-1550645612-82f5d2d77e33?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "The primary goal of incident reconstruction is to:", "options": ["Build a case for law enforcement", "Create a single, cohesive narrative that explains the entire attack from beginning to end", "Justify the purchase of new security tools", "Complete a compliance checklist"], "correct": 1, "explanation": "Reconstruction is the final analysis step, where the investigator acts as a storyteller, using the evidence to narrate the incident." },
                        { "id": 2, "question": "Mapping an attacker's actions to categories like 'Initial Access', 'Lateral Movement', and 'Exfiltration' is an example of using what?", "options": ["A backup plan", "A forensic imaging tool", "A chain of custody form", "An incident response framework like MITRE ATT&CK"], "correct": 3, "explanation": "Frameworks like ATT&CK provide a common vocabulary and structure for understanding and describing how attacks work." }
                    ]
                }
            },
            {
                "id": "lesson-27-expert-witness",
                "title": "Lesson 27: Expert Witness Preparation",
                "duration": "120 min",
                "objectives": [
                    "Understand the role of an expert witness in the legal system",
                    "Learn best practices for preparing and delivering clear testimony",
                    "Prepare for cross-examination by opposing counsel",
                    "Translate complex technical findings into language a jury can understand"
                ],
                "content": {
                    "overview": "Your forensic investigation may end up as evidence in a courtroom, and you may be called to testify as an expert witness. This lesson covers the essentials of preparing for this role, focusing on how to clearly and effectively communicate your findings and withstand legal scrutiny.",
                    "sections": [
                        {
                            "title": "Testimony Best Practices",
                            "content": "<p>The courtroom is a very different environment from the lab. The goal is clear communication, not technical perfection.</p><h3>Keys to Effective Testimony:</h3><ul><li><strong>Simplicity:</strong> Explain things in the simplest possible terms. Use analogies. A jury is not composed of forensic experts.</li><li><strong>Honesty and Integrity:</strong> Never exaggerate. Be honest about what the evidence does and does not show. If you don't know the answer to a question, say so. Your credibility is your most important asset.</li><li><strong>Stay within your Expertise:</strong> Only testify about the areas in which you are a qualified expert.</li><li><strong>Stick to your Report:</strong> Your testimony should be based on what is in your formal, written report. Know it inside and out.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1589216532372-1c2a3679003a?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "Cross-Examination Preparation",
                            "content": "<p>During cross-examination, the opposing lawyer will challenge your findings, your methodology, and your credibility. This is an adversarial process.</p><h3>Surviving Cross-Examination:</h3><ul><li><strong>Stay Calm:</strong> Do not become defensive or argumentative. Remain professional and polite.</li><li><strong>Listen Carefully:</strong> Pay close attention to the exact question being asked. Answer only that question. Do not volunteer extra information.</li><li><strong>It's Not a Debate:</strong> You are not there to debate the lawyer. You are there to answer questions truthfully based on your findings.</li><li><strong>Practice:</strong> Your side's lawyer will help you prepare by conducting mock cross-examination sessions. This is a critical part of preparation.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1556761175-5973dc0f32e7?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "What is the most important asset for an expert witness testifying in court?", "options": ["The speed of their forensic tools", "Their personal opinion of the defendant's guilt", "Their credibility and objectivity", "The number of certifications they have"], "correct": 2, "explanation": "An expert's credibility is everything. Once lost, it cannot be recovered. Testimony must be unbiased, objective, and truthful." },
                        { "id": 2, "question": "When explaining a complex topic like file carving to a jury, an expert should:", "options": ["Use as much technical jargon as possible", "Refuse to answer the question", "Use simple language and analogies to make the concept understandable", "Read directly from a textbook"], "correct": 2, "explanation": "The expert's role is that of a translator, converting complex technical subjects into concepts that a non-technical audience can grasp." }
                    ]
                }
            },
            {
                "id": "lesson-28-qa-validation",
                "title": "Lesson 28: Quality Assurance and Validation",
                "duration": "120 min",
                "objectives": [
                    "Implement a formal peer review process for forensic reports",
                    "Understand methods for validating the accuracy and reliability of forensic tools",
                    "Use checklists and standardized procedures to prevent errors",
                    "Establish a quality control framework for a forensic lab"
                ],
                "content": {
                    "overview": "Forensic findings must be accurate, repeatable, and defensible. A robust Quality Assurance (QA) program is essential for ensuring the integrity of a forensic lab's work. This lesson covers the key components of a QA program, from tool validation to the critical process of peer review.",
                    "sections": [
                        {
                            "title": "Peer Review Processes",
                            "content": "<p>Before any forensic report is finalized, it should go through a technical peer review process. A second, qualified examiner reviews the report and the case notes to ensure the work is sound.</p><h3>What a Peer Reviewer Checks:</h3><ul><li><strong>Technical Accuracy:</strong> Are the examiner's conclusions supported by the evidence in their notes? Did they interpret an artifact correctly?</li><li><strong>Completeness:</strong> Did the examiner follow all standard procedures? Did they overlook any potential sources of evidence?</li><li><strong>Clarity:</strong> Is the report well-written, clear, and free of errors and bias?</li></ul><p>The peer review process is a critical quality control step that catches mistakes and ensures the lab produces a consistently high-quality work product.</p>",
                            "image": "https://images.unsplash.com/photo-1517048676732-d65bc937f952?w=800&h=400&fit-crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "What is the primary purpose of a technical peer review for a forensic report?", "options": ["To find spelling mistakes", "To have a second qualified examiner check the original investigator's work for accuracy and completeness", "To make the report longer", "To approve the budget for the case"], "correct": 1, "explanation": "Peer review is a fundamental quality control process in any scientific discipline, designed to catch errors and ensure the findings are valid." },
                        { "id": 2, "question": "Testing a forensic tool with a known data set to ensure it functions correctly is called:", "options": ["Peer review", "Report writing", "Tool validation", "Chain of custody"], "correct": 2, "explanation": "Validation is the process of testing and documenting that your tools work as expected, which is essential for defending your findings in court." }
                    ]
                }
            },
            {
                "id": "lesson-29-iot-forensics",
                "title": "Lesson 29: IoT Device Forensics",
                "duration": "120 min",
                "objectives": [
                    "Identify potential sources of evidence in a network of IoT devices",
                    "Understand the challenges of acquiring data from embedded systems",
                    "Perform basic firmware analysis to look for vulnerabilities",
                    "Investigate the cloud backends that IoT devices connect to"
                ],
                "content": {
                    "overview": "From smart homes to smart cities, the Internet of Things (IoT) presents a new frontier for digital forensics. This lesson explores the unique challenges of investigating these small, often insecure, and massively numerous devices, focusing on the key sources of evidence in an IoT ecosystem.",
                    "sections": [
                        {
                            "title": "IoT Evidence Sources",
                            "content": "<p>An IoT investigation rarely focuses on just one device. It's an ecosystem investigation, involving the device itself, the network it's on, and the cloud services it uses.</p><h3>The IoT Forensic Triangle:</h3><ul><li><strong>The Device:</strong> Acquiring data from the device itself can be difficult. It often involves directly accessing the flash memory chips or using a JTAG/UART interface to dump the firmware.</li><li><strong>The Network:</strong> Network traffic is often the most valuable source of evidence. Capturing and analyzing the device's network connections can reveal where it is connecting to, what data it is sending, and whether it has been compromised.</li><li><strong>The Cloud:</strong> Almost all IoT devices connect to a cloud backend. Gaining access to the cloud account associated with the device can provide a rich history of its activity, location, and stored data.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1544890225-2fde1e46f71b?w=800&h=400&fit-crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "In an IoT investigation, which of the following is often the most fruitful and accessible source of evidence?", "options": ["The device's physical memory chip", "The device's power cord", "The network traffic to and from the device and the associated cloud account logs", "The device's user manual"], "correct": 2, "explanation": "Because direct acquisition from IoT devices is so challenging, investigators heavily rely on analyzing the device's network behavior and the data stored in its cloud backend." },
                        { "id": 2, "question": "JTAG and UART are interfaces sometimes used in IoT forensics for what purpose?", "options": ["To charge the device's battery", "To connect the device to the internet", "To directly access the device's low-level firmware and memory", "To change the device's password"], "correct": 2, "explanation": "These are low-level debugging interfaces that can provide direct access to the device's embedded hardware, allowing for firmware extraction." }
                    ]
                }
            },
            {
                "id": "lesson-30-blockchain-crypto",
                "title": "Lesson 30: Blockchain and Cryptocurrency",
                "duration": "120 min",
                "objectives": [
                    "Understand the basics of how a public blockchain works",
                    "Use blockchain explorers to trace cryptocurrency transactions",
                    "Investigate wallets and their interaction with exchanges",
                    "Recognize the challenges of privacy coins and mixers"
                ],
                "content": {
                    "overview": "Cryptocurrency is increasingly a factor in a wide range of investigations, from ransomware and fraud to money laundering. This lesson introduces the fundamentals of blockchain forensics, covering how to trace transactions on a public ledger and the techniques used by illicit actors to obscure the flow of funds.",
                    "sections": [
                        {
                            "title": "Blockchain Transaction Analysis",
                            "content": "<p>A public blockchain (like Bitcoin or Ethereum) is a distributed, immutable ledger. Every transaction is publicly visible, permanent, and recorded by the entire network.</p><h3>Tracing Transactions:</h3><p>Investigators use tools called 'blockchain explorers' to trace the flow of cryptocurrency. Starting from a single known wallet address, an investigator can trace every transaction in and out of that wallet, identifying other wallets it has transacted with. The process is often a complex form of link analysis, mapping out a web of transactions to follow the money.</p>",
                            "image": "https://images.unsplash.com/photo-1631603090989-821237a349b8?w=800&h=400&fit-crop"
                        },
                        {
                            "title": "Anonymity and Attribution",
                            "content": "<p>While transactions are public, they are pseudonymous. The challenge is linking a wallet address to a real-world identity.</p><h3>The Role of Exchanges:</h3><p>The key to de-anonymization is the point where cryptocurrency is converted to or from traditional fiat currency. This usually happens at a cryptocurrency exchange. These exchanges are often regulated financial institutions that must follow Know Your Customer (KYC) laws. If an investigator can legally compel an exchange to identify the owner of an account that received stolen funds, they can link a wallet address to a real identity.</p><h3>Obfuscation Techniques:</h3><ul><li><strong>Mixers/Tumblers:</strong> Services that pool together cryptocurrency from many different users and 'mix' it, breaking the chain of ownership and making tracing difficult.</li><li><strong>Privacy Coins:</strong> Cryptocurrencies like Monero or Zcash have built-in privacy features that obscure transaction amounts and addresses, making them almost impossible to trace on the public ledger.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1640826359570-0714b6ac7869?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "On a public blockchain like Bitcoin, are transactions public or private?", "options": ["All transactions are private and encrypted", "All transactions are public, permanent, and visible to anyone", "Only transactions over a certain value are public", "Only the government can see the transactions"], "correct": 1, "explanation": "The public and immutable nature of the ledger is a core feature of most major cryptocurrencies." },
                        { "id": 2, "question": "What is the key point in the cryptocurrency lifecycle for linking a wallet address to a real-world identity?", "options": ["The creation of the wallet", "The point where the cryptocurrency is converted to traditional money at a regulated exchange", "The time of the first transaction", "The use of a mixer"], "correct": 1, "explanation": "Exchanges are the on-ramps and off-ramps to the traditional financial system and are often subject to KYC laws, making them a critical choke point for investigations." },
                        { "id": 3, "question": "Services that are used to obscure the trail of cryptocurrency by mixing funds from many different users are called:", "options": ["Exchanges", "Miners", "Mixers or Tumblers", "Wallets"], "correct": 2, "explanation": "Mixers are a primary tool used for money laundering in the cryptocurrency world." }
                    ]
                }
            },
            {
                "id": "lesson-31-ai-ml-forensics",
                "title": "Lesson 31: AI and Machine Learning Forensics",
                "duration": "120 min",
                "objectives": [
                    "Understand the forensic challenges of investigating AI systems",
                    "Analyze logs and metadata related to machine learning models",
                    "Investigate training data for evidence of poisoning or bias",
                    "Explore methods for detecting AI-driven manipulation"
                ],
                "content": {
                    "overview": "As Artificial Intelligence and Machine Learning become integrated into more critical systems, they also become a target for new types of attacks. This emerging lesson explores the forensic investigation of AI/ML systems, focusing on how to analyze models and their training data to detect compromise or manipulation.",
                    "sections": [
                        {
                            "title": "Investigating AI Systems",
                            "content": "<p>Investigating an AI is not like investigating a traditional computer. The 'logic' is not in procedural code but in the learned patterns of the model itself. The logs and the data become the primary sources of evidence.</p><h3>Key Evidence Sources:</h3><ul><li><strong>Training Data:</strong> The data used to train the model. This is the most critical component. An investigator may need to look for evidence of 'data poisoning', where an attacker subtly manipulates the training data to create a hidden backdoor in the model.</li><li><strong>Model Provenance Logs:</strong> Logs that show the history of the model's versions, who trained it, what data was used, and its performance metrics.</li><li><strong>Inference Logs:</strong> The logs of the live, production model. These show the inputs it received and the outputs (decisions) it produced. Analyzing these logs for anomalous predictions can be a key indicator of compromise.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1620712943543-959bab121695?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "The attack where an adversary subtly manipulates the data used to train a machine learning model to create a hidden backdoor is called:", "options": ["Data exfiltration", "Data poisoning", "Data carving", "Data wiping"], "correct": 1, "explanation": "Data poisoning is a serious threat to ML systems, where the training data itself is the attack vector." },
                        { "id": 2, "question": "When investigating the behavior of a live AI model, the most important log source would be:", "options": ["The network firewall logs", "The system event logs", "The inference logs showing inputs and outputs", "The developer's chat history"], "correct": 2, "explanation": "Inference logs provide the ground truth of what the live model is seeing and deciding, making them key to detecting anomalous behavior." }
                    ]
                }
            },
            {
                "id": "lesson-32-vehicle-forensics",
                "title": "Lesson 32: Vehicle Forensics",
                "duration": "120 min",
                "objectives": [
                    "Understand the sources of digital evidence in modern vehicles",
                    "Analyze data from infotainment and telematics systems",
                    "Recover data from a vehicle's Event Data Recorder (EDR)",
                    "Investigate data from a vehicle's CAN bus"
                ],
                "content": {
                    "overview": "Modern vehicles are computers on wheels, generating and storing vast amounts of data. This specialized lesson introduces the field of vehicle forensics, covering the major sources of evidence in a car, from the infotainment system to the 'black box' Event Data Recorder.",
                    "sections": [
                        {
                            "title": "Automotive System Analysis",
                            "content": "<p>A modern car is a network of dozens of Electronic Control Units (ECUs). Many of these store data that can be of forensic value.</p><h3>Key Data Sources:</h3><ul><li><strong>Infotainment System:</strong> The system that runs the navigation and media player. It often stores a wealth of data, including navigation history (tracklogs), paired mobile phone data (contacts, call logs), and Wi-Fi connection history.</li><li><strong>Telematics System:</strong> The system that provides services like OnStar. It has its own cellular connection and can store GPS location data, vehicle health information, and even driver behavior metrics.</li><li><strong>Event Data Recorder (EDR):</strong> Often called the 'black box'. The EDR records critical vehicle data (speed, braking, throttle) in the few seconds leading up to and during a crash. It is invaluable for accident reconstruction.</li><li><strong>CAN Bus:</strong> The Controller Area Network (CAN) is the internal network that all the ECUs use to communicate. Tapping into the CAN bus can provide a live view of the car's operations.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1549399542-7e692a716530?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "In vehicle forensics, what is the 'EDR'?", "options": ["The Engine Diagnostics Reader", "The Entertainment and Display Radio", "The Event Data Recorder, a 'black box' for crash data", "The Electronic Door Release"], "correct": 2, "explanation": "The EDR is a federally mandated device on all modern cars that captures critical pre-crash data for accident reconstruction." },
                        { "id": 2, "question": "To find a history of where a car has been driven, an investigator would most likely analyze data from the:", "options": ["Radio system", "Engine control unit", "Infotainment and Telematics systems", "Tire pressure monitoring system"], "correct": 2, "explanation": "The GPS navigation history and telematics location logs are the primary sources for a vehicle's past movements." }
                    ]
                }
            },
            {
                "id": "lesson-33-cert-prep",
                "title": "Lesson 33: Certification Preparation",
                "duration": "120 min",
                "objectives": [
                    "Review the domains and objectives of the GIAC GCIH and GCFA certifications",
                    "Understand the forensics domain within the broader CISSP certification",
                    "Develop a personal study plan for pursuing professional certification",
                    "Practice with sample questions for major forensics certifications"
                ],
                "content": {
                    "overview": "Professional certifications are a key way to validate your skills and advance your career in digital forensics and incident response. This lesson provides an overview of the major certifications in the field and offers guidance on how to prepare for them.",
                    "sections": [
                        {
                            "title": "GIAC Certifications (GCIH, GCFA)",
                            "content": "<p>The Global Information Assurance Certification (GIAC) credentials, offered by the SANS Institute, are among the most respected hands-on technical certifications in cybersecurity.</p><h3>Key DFIR Certifications:</h3><ul><li><strong>GCIH (GIAC Certified Incident Handler):</strong> This certification focuses on the incident response process. It covers detection, containment, eradication, and recovery, with a focus on identifying and responding to common attack vectors like phishing, web attacks, and malware.</li><li><strong>GCFA (GIAC Certified Forensic Analyst):</strong> This is a deep-dive technical forensics certification. It covers file system forensics, memory analysis, timeline creation, and advanced artifact analysis on Windows and Linux systems.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1542744173-8e7e53415bb0?w=800&h=400&fit=crop"
                        },
                        {
                            "title": "CISSP (Certified Information Systems Security Professional)",
                            "content": "<p>The CISSP is a high-level, management-focused certification that covers the entire breadth of information security. While it is not a deep technical forensics certification, its 'Security Operations' domain includes key concepts in digital forensics, incident response, and investigation management. It is often a requirement for senior leadership roles in cybersecurity.</p>",
                            "image": "https://images.unsplash.com/photo-1521791136064-7986c2920216?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "Which GIAC certification is focused specifically on deep-dive technical forensics, including memory and file system analysis?", "options": ["GCIH", "GCFA", "GSEC", "GISP"], "correct": 1, "explanation": "The GCFA (Forensic Analyst) is the primary GIAC certification for hands-on digital forensics practitioners." },
                        { "id": 2, "question": "Which certification is a broad, high-level management certification where forensics is one of many security domains covered?", "options": ["GCFA", "GCIH", "OSCP", "CISSP"], "correct": 3, "explanation": "CISSP is a very broad, inch-deep, mile-wide certification that covers management of the entire security program, making it different from the deep technical focus of the GIAC certifications." }
                    ]
                }
            },
            {
                "id": "lesson-34-case-management",
                "title": "Lesson 34: Case Management",
                "duration": "120 min",
                "objectives": [
                    "Understand the importance of dedicated case management systems",
                    "Implement a workflow for tracking cases from inception to closure",
                    "Manage evidence databases and link them to cases",
                    "Optimize resource planning and analyst caseloads"
                ],
                "content": {
                    "overview": "For a forensic lab or IR team that handles more than a few cases a year, a formal case management system is essential. This lesson covers the principles and tools for managing the business of forensics: tracking cases, managing evidence, and optimizing the team's workflow.",
                    "sections": [
                        {
                            "title": "Case Tracking Systems",
                            "content": "<p>A case management system is a centralized database for the entire investigative lifecycle. It ensures that every action is documented and nothing falls through the cracks.</p><h3>Key Features:</h3><ul><li><strong>Case Creation:</strong> A new entry is created for every investigation, assigned a unique case number.</li><li><strong>Tasking and Workflow:</strong> The lead investigator can assign specific tasks (e.g., 'Image hard drive XYZ') to other team members and track their status.</li><li><strong>Evidence Management:</strong> A record of all evidence items associated with the case, including their chain of custody.</li><li><strong>Note Taking and Timelines:</strong> A central place for all analysts to enter their contemporaneous notes, which can be automatically compiled into a master timeline.</li><li><strong>Reporting:</strong> The system can often automatically generate reports and metrics, such as the number of active cases or the average time to closure.</li></ul><p>Examples of tools include TheHive (open source) or commercial platforms that are part of broader SOAR or e-discovery suites.</p>",
                            "image": "https://images.unsplash.com/photo-1556742044-15b56a42a033?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "What is the primary purpose of a case management system in a forensic lab?", "options": ["To perform forensic imaging", "To provide a centralized platform for documenting and managing the entire lifecycle of an investigation", "To analyze malware", "To conduct remote acquisitions"], "correct": 1, "explanation": "Case management provides the administrative and organizational backbone for an investigation, ensuring consistency and completeness." }
                    ]
                }
            },
            {
                "id": "lesson-35-industry-trends",
                "title": "Lesson 35: Industry Trends and Future",
                "duration": "120 min",
                "objectives": [
                    "Analyze how emerging threat landscapes are shaping forensics",
                    "Understand the impact of technology evolution (e.g., end-to-end encryption) on investigations",
                    "Keep up to date with regulatory changes affecting forensics",
                    "Develop strategies for continuous learning and career advancement"
                ],
                "content": {
                    "overview": "The field of digital forensics is constantly changing. New technologies create new types of evidence, and new threats require new investigative techniques. This forward-looking lesson discusses the major trends shaping the future of forensics and emphasizes the importance of lifelong learning to stay current.",
                    "sections": [
                        {
                            "title": "Technology Evolution Impact",
                            "content": "<p>Technology trends are a double-edged sword for forensics. They create new sources of evidence but also new challenges for investigators.</p><h3>Key Trends:</h3><ul><li><strong>The Cloud:</strong> As more data moves to the cloud, investigators need to become experts in cloud forensics and API-based evidence collection.</li><li><strong>Encryption by Default:</strong> Strong, end-to-end encryption is becoming the default on many platforms. This is great for privacy, but it creates huge challenges for investigators when they cannot access the content of communications.</li><li><strong>The Disappearing Computer:</strong> As technology becomes more embedded (IoT) and virtualized, the traditional concept of seizing a physical computer is becoming less relevant. Investigators must adapt to a world of ephemeral, distributed evidence sources.</li></ul>",
                            "image": "https://images.unsplash.com/photo-1518770660439-4636190af475?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "The trend of 'encryption by default' presents what major challenge to forensic investigators?", "options": ["It makes computers run faster", "It makes evidence unreadable and inaccessible without the decryption key or a bypass method", "It reduces the amount of storage needed", "It makes forensics easier"], "correct": 1, "explanation": "While great for user privacy, pervasive encryption is one of the single biggest technical challenges facing the digital forensics community today." }
                    ]
                }
            },
            {
                "id": "lesson-36-integrated-investigation",
                "title": "Lesson 36: Integrated Investigation Project",
                "duration": "180 min",
                "objectives": [
                    "Conduct an investigation that spans multiple platforms (e.g., on-prem, cloud, mobile)",
                    "Correlate complex evidence from different types of artifacts",
                    "Apply advanced analysis techniques to a realistic scenario",
                    "Produce a professional-quality forensic report on the findings"
                ],
                "content": {
                    "overview": "This project is a dry run for the final capstone. You will be given a scenario and a complex set of evidence files from multiple sources—a Windows disk image, network packet captures, and cloud logs. Your task is to perform an integrated investigation, correlating the evidence from all three sources to reconstruct the incident.",
                    "sections": [
                        {
                            "title": "Project Scenario",
                            "content": "<p><strong>The Scenario:</strong> An employee's corporate laptop was compromised. The attacker used this access to pivot to the company's cloud environment and exfiltrate sensitive data. You have been given a forensic image of the laptop, PCAP files from the time of the incident, and the relevant AWS CloudTrail logs.</p><h3>Your Task:</h3><p>Correlate the evidence to answer the following questions:</p><ol><li>How was the laptop initially compromised?</li><li>What tools and commands did the attacker run on the laptop?</li><li>How did the attacker gain access to the cloud environment? (Hint: Look for access keys on the laptop).</li><li>What specific actions did the attacker take in the cloud? (Hint: Analyze the CloudTrail logs).</li><li>What data was exfiltrated? (Hint: Analyze the PCAP files).</li></ol><p>You will submit a full forensic report detailing your findings.</p>",
                            "image": "https://images.unsplash.com/photo-1519389950473-47ba0277781c?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 100,
                    "questions": [
                        { "id": 1, "question": "The primary skill being tested in the integrated investigation project is the ability to:", "options": ["Write a custom script", "Create a forensic image", "Correlate evidence from disparate sources (host, network, cloud) to form a single cohesive timeline", "Perform a memory acquisition"], "correct": 2, "explanation": "Modern investigations are rarely confined to a single machine. The ability to integrate and correlate evidence from multiple platforms is a crucial real-world skill." }
                    ]
                }
            },
            {
                "id": "lesson-37-tool-development",
                "title": "Lesson 37: Specialized Tool Development",
                "duration": "120 min",
                "objectives": [
                    "Write custom scripts (e.g., in Python) to automate repetitive forensic tasks",
                    "Develop tools to parse custom log formats or file types",
                    "Integrate existing tools using APIs to enhance workflows"
                ],
                "content": {
                    "overview": "While commercial and open-source forensic suites are powerful, sometimes an investigation requires a specialized tool for a unique task. This lesson introduces the basics of custom tool development and scripting to automate parts of the forensic process and handle non-standard evidence types.",
                    "sections": [
                        {
                            "title": "Automation with Scripting",
                            "content": "<p>Many tasks in a forensic examination are repetitive. Scripting allows you to automate them, saving time and reducing the chance of human error.</p><h3>Example Use Cases for Scripting:</h3><ul><li><strong>Automated Triage:</strong> A script that automatically extracts key artifacts (like event logs, registry hives, and browser history) from a forensic image.</li><li><strong>Custom Log Parsing:</strong> A script to parse a proprietary, non-standard log file and convert it into a standard format like CSV.</li><li><strong>Large-scale Keyword Searching:</strong> A script to run a keyword search across thousands of files and collate the results.</li></ul><p>Python is the most popular language for this kind of scripting due to its powerful libraries for data manipulation and analysis.</p>",
                            "image": "https://images.unsplash.com/photo-1555066931-4365d14bab8c?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "What is a primary reason for using scripting (e.g., Python) in digital forensics?", "options": ["To replace the need for forensic investigators", "To automate repetitive tasks, saving time and ensuring consistency", "To make investigations more complicated", "Because it is required by law"], "correct": 1, "explanation": "Automation is a force multiplier for a forensic lab, allowing analysts to focus their time on analysis rather than repetitive extraction tasks." }
                    ]
                }
            },
            {
                "id": "lesson-38-research-development",
                "title": "Lesson 38: Research and Development",
                "duration": "120 min",
                "objectives": [
                    "Understand methods for forensic research",
                    "Contribute to the field through tool testing and validation",
                    "Review and critique academic papers on new forensic techniques",
                    "Drive innovation within a forensic practice"
                ],
                "content": {
                    "overview": "The field of digital forensics moves forward because of the research and development efforts of its practitioners. This lesson covers the importance of R&D in a forensic practice, from validating new tools to researching the artifacts left by new applications and operating systems.",
                    "sections": [
                        {
                            "title": "Forensic Research Methods",
                            "content": "<p>When a new application or operating system version comes out, someone has to do the work to figure out where it stores its forensic artifacts. This is a research process.</p><h3>The Research Workflow:</h3><ol><li><strong>Create a Clean Baseline:</strong> Start with a clean installation of the new OS or application.</li><li><strong>Perform an Action:</strong> Perform a single, specific action you want to test (e.g., send a chat message, visit a website).</li><li><strong>Capture Before and After Snapshots:</strong> Take a snapshot of the entire system *before* and *after* the action.</li><li><strong>Compare the Snapshots:</strong> Use forensic tools to compare the two snapshots. Any files or registry keys that changed between them are the artifacts associated with that action.</li></ol><p>This is how the forensic community discovers new artifacts and develops new techniques.</p>",
                            "image": "https://images.unsplash.com/photo-1507413245164-6160d8298b31?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "What is the primary method for discovering new forensic artifacts in a piece of software?", "options": ["Reading the marketing website", "Taking a 'before' and 'after' snapshot of a system and analyzing the differences", "Guessing", "Running an antivirus scan"], "correct": 1, "explanation": "This methodical, scientific process of differential analysis is the core of forensic research and artifact discovery." }
                    ]
                }
            },
            {
                "id": "lesson-39-business-integration",
                "title": "Lesson 39: Business Integration",
                "duration": "120 min",
                "objectives": [
                    "Integrate digital forensics into the overall risk management program",
                    "Conduct a cost-benefit analysis for forensic capabilities (in-house vs. outsourced)",
                    "Align forensic processes with business goals",
                    "Measure the Return on Investment (ROI) for forensic tools and training"
                ],
                "content": {
                    "overview": "A digital forensics capability doesn't exist for its own sake; it exists to support the business by reducing risk and responding to crises. This lesson focuses on the business aspects of a forensic practice, covering how to justify costs, measure value, and integrate forensics into the broader business operations.",
                    "sections": [
                        {
                            "title": "Cost-Benefit Analysis",
                            "content": "<p>One of the key decisions a business has to make is whether to build an in-house forensic team, outsource to a third party, or use a hybrid model.</p><h3>In-house vs. Outsourced:</h3><ul><li><strong>In-house Team:</strong> **Pros:** Deep knowledge of the company's environment, faster initial response time. **Cons:** High fixed cost (salaries, tools, training), difficulty retaining top talent, may lack experience with a wide variety of incidents.</li><li><strong>Outsourced (Retainer):</strong> **Pros:** Access to world-class experts with deep and varied experience, lower fixed cost. **Cons:** Slower initial response time, less knowledge of your specific environment.</li></ul><p>Many companies use a hybrid model: an in-house team for day-to-day incidents and a third-party retainer for major, complex breaches.</p>",
                            "image": "https://images.unsplash.com/photo-1556741533-4020f1b29a28?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 75,
                    "questions": [
                        { "id": 1, "question": "What is the primary advantage of having an in-house digital forensics team?", "options": ["It is always cheaper", "They have a deep, pre-existing knowledge of the company's systems and network", "They have more experience with novel attack types", "They are easier to fire"], "correct": 1, "explanation": "The in-house team's familiarity with the environment can dramatically speed up the initial phases of an investigation." }
                    ]
                }
            },
            {
                "id": "lesson-40-final-capstone-project",
                "title": "Lesson 40: Final Capstone Project",
                "duration": "240 min",
                "objectives": [
                    "Conduct a complex, real-world investigation from start to finish",
                    "Analyze evidence from multiple, diverse sources",
                    "Produce a complete, court-ready documentation package",
                    "Present findings in a professional, expert-level presentation"
                ],
                "content": {
                    "overview": "The final capstone is a master's level project that requires you to synthesize every skill learned in this program. You will be assigned a complex case file based on a real-world intrusion and will act as the lead forensic investigator. Your task is to conduct the entire investigation, from initial evidence intake to the final expert witness report and presentation.",
                    "sections": [
                        {
                            "title": "The Master's Level Investigation",
                            "content": "<p>This project will test your abilities to the fullest.</p><h3>Project Components:</h3><ol><li><strong>Case Intake:</strong> You will be given a scenario and multiple evidence files (e.g., memory dump, disk image, network captures, mobile phone image).</li><li><strong>Forensic Analysis:</strong> You must conduct a full, independent forensic analysis of all the evidence.</li><li><strong>Correlation:</strong> You must correlate the findings from all the different evidence sources to reconstruct a complex, multi-stage attack.</li><li><strong>Reporting:</strong> You will produce a final expert report, complete with a timeline, detailed findings, and conclusions. This report must be written to a standard that would be admissible in court.</li><li><strong>Presentation:</strong> You will prepare and deliver a final presentation of your findings, as if you were briefing a board of directors or testifying as an expert witness.</li></ol>",
                            "image": "https://images.unsplash.com/photo-1521791136064-7986c2920216?w=800&h=400&fit=crop"
                        }
                    ]
                },
                "quiz": {
                    "passingScore": 100,
                    "questions": [
                        { "id": 1, "question": "The final capstone project is designed to assess your ability to:", "options": ["Work as part of a large team", "Perform a single, specific forensic task", "Independently manage and execute a complex, multi-faceted forensic investigation at a professional level", "Write a single line of code"], "correct": 2, "explanation": "This project is the culmination of the entire program, serving as the final, comprehensive evaluation of your mastery of the subject." }
                    ]
                }
            }
        ]
    }
// =====================================================
      // GLOBAL VARIABLES
      // =====================================================
      let currentUser = null;
      let currentLessonIndex = 0;
      let courseProgress = {};
      let userStats = {};
      let quizState = {
        currentQuestion: 0,
        answers: [],
        score: 0,
        isComplete: false,
      };

      // Enhanced session tracking
      let courseSession = {
        startTime: null,
        totalStudyTime: 0,
        lessonsStarted: 0,
        lessonsCompleted: 0,
        pageLoadTime: new Date(),
        interactionCount: 0,
        lastActivityTime: new Date(),
      };

      // Music Player Variables
      let audioPlayer = new Audio();

      // Achievement notification system
      let notificationQueue = [];
      let isShowingNotification = false;

      // =====================================================
      // INITIALIZATION
      // =====================================================
      document.addEventListener("DOMContentLoaded", async () => {
        try {
          showLoadingScreen();
          await checkAuth();

          if (currentUser) {
            // Initialize session tracking
            startCourseSession();

            // Load course data and progress
            await loadCourseData();
            await loadUserProfile();
            await loadProgress();

            // Initialize UI
            initializeEventListeners();
            renderSidebar();
            loadLesson(currentLessonIndex);

            // Initialize additional features
            initMusicPlayer();
            addMusicIndicator();
            initializeActivityTracking();

            hideLoadingScreen();
          } else {
            openAuthModal();
          }
        } catch (error) {
          console.error("Error initializing course:", error);
          hideLoadingScreen();
          showToast("Failed to initialize course system", "error");
        }
      });

      // =====================================================
      // AUTHENTICATION SYSTEM
      // =====================================================
      async function checkAuth() {
        try {
          const {
            data: { session },
            error,
          } = await supabase.auth.getSession();

          if (error) {
            console.error("Auth error:", error);
            currentUser = null;
            openAuthModal();
            return;
          }

          if (!session) {
            currentUser = null;
            openAuthModal();
            return;
          }

          currentUser = session.user;
          updateUIWithUser();
        } catch (error) {
          console.error("Error checking auth:", error);
          currentUser = null;
          openAuthModal();
        }
      }

      function updateUIWithUser() {
        if (!currentUser) return;

        const name =
          currentUser.user_metadata?.full_name ||
          currentUser.email.split("@")[0];
        const userElements = document.querySelectorAll("[data-user-name]");
        userElements.forEach((el) => (el.textContent = name));
      }

      // =====================================================
      // USER PROFILE & STATS MANAGEMENT
      // =====================================================
      async function loadUserProfile() {
        try {
          // 🔍 Step 1: Try to fetch existing profile
          const { data: profile, error } = await supabase
            .from("profiles")
            .select("*")
            .eq("id", currentUser.id)
            .single();

          if (error && error.code !== "PGRST116") {
            throw error;
          }

          if (!profile) {
            // 🆕 Step 2: Create new profile if missing
            await createUserProfile();
          } else {
            // ✅ Step 3: Use existing profile
            userStats = profile;
            await updateLastActivity();
          }
        } catch (error) {
          console.error("❌ Error loading user profile:", error);
          showToast("Failed to load user profile", "error");
        }
      }
      async function createUserProfile() {
        try {
          const newProfile = {
            id: currentUser.id,
            full_name: currentUser.user_metadata?.full_name || "",
            email: currentUser.email,
            level: "Script Kiddie",
            total_points: 0,
            completed_courses: 0,
            current_streak: 0,
            total_certificates: 0,
            total_achievements: 0,
            sections_visited: 0,
            bonus_points: 0,
            in_progress_courses: 0,
            settings_changed: 0,
            midnight_sessions: 0,
            early_sessions: 0,
            weekend_sessions: 0,
            last_activity: new Date().toISOString(),
            created_at: new Date().toISOString(),
          };

          const { error } = await supabase
            .from("profiles")
            .insert([newProfile]);

          if (!error) {
            userStats = newProfile;
            // Award first login achievement
            setTimeout(() => checkAndUnlockAchievement("first_login"), 1000);
          }
        } catch (error) {
          console.error("Error creating user profile:", error);
        }
      }

      async function updateLastActivity() {
        try {
          const now = new Date();

          // Update activity tracking
          courseSession.lastActivityTime = now;

          // Update database
          await supabase
            .from("profiles")
            .update({
              last_activity: now.toISOString(),
            })
            .eq("id", currentUser.id);

          // Check time-based achievements
          await checkTimeBasedAchievements(now);
        } catch (error) {
          console.error("Error updating last activity:", error);
        }
      }

      // =====================================================
      // COURSE SESSION MANAGEMENT
      // =====================================================
      function startCourseSession() {
        courseSession.startTime = new Date();
        courseSession.pageLoadTime = new Date();

        logUserActivity("course_session_start", {
          course_id: COURSE_DATA.id,
          course_title: COURSE_DATA.title,
          user_agent: navigator.userAgent,
          screen_resolution: `${screen.width}x${screen.height}`,
        });

        // Check daily streak
        checkDailyStreak();
      }

      function initializeActivityTracking() {
        // Track page focus/blur for accurate study time
        document.addEventListener("visibilitychange", handleVisibilityChange);

        // Track user interactions
        ["click", "keydown", "scroll", "mousemove"].forEach((event) => {
          document.addEventListener(event, trackUserInteraction, {
            passive: true,
          });
        });

        // Periodic activity updates
        setInterval(updateStudyTime, 60000); // Every minute

        // Save session data before page unload
        window.addEventListener("beforeunload", saveSessionData);
      }

      function handleVisibilityChange() {
        if (document.hidden) {
          courseSession.lastActivityTime = new Date();
        } else {
          // Page became visible again - update activity
          updateLastActivity();
        }
      }

      function trackUserInteraction() {
        courseSession.interactionCount++;
        courseSession.lastActivityTime = new Date();

        // Throttle activity updates
        if (courseSession.interactionCount % 50 === 0) {
          updateLastActivity();
        }
      }

      function updateStudyTime() {
        if (!courseSession.startTime || document.hidden) return;

        const now = new Date();
        const sessionDuration = now - courseSession.startTime;
        courseSession.totalStudyTime = Math.floor(sessionDuration / 1000 / 60); // in minutes

        // Update progress with study time
        saveProgress();
      }

      function saveSessionData() {
        if (!currentUser || !courseSession.startTime) return;

        const sessionData = {
          user_id: currentUser.id,
          course_id: COURSE_DATA.id,
          session_duration: courseSession.totalStudyTime,
          lessons_viewed: courseSession.lessonsStarted,
          lessons_completed: courseSession.lessonsCompleted,
          interactions: courseSession.interactionCount,
          session_date: courseSession.startTime.toISOString().split("T")[0],
        };

        // Store in localStorage as backup
        localStorage.setItem(
          "course_session_backup",
          JSON.stringify(sessionData)
        );

        // Try to save to database
        logUserActivity("course_session_end", sessionData);
      }

      // =====================================================
      // COURSE DATA & PROGRESS MANAGEMENT
      // =====================================================
      async function loadCourseData() {
        try {
          // Update course info in UI
          document.getElementById("courseTitle").textContent =
            COURSE_DATA.title;
          document.getElementById("totalLessons").textContent =
            COURSE_DATA.lessons.length;

          // Log course access
          logUserActivity("course_access", {
            course_id: COURSE_DATA.id,
            course_title: COURSE_DATA.title,
          });
        } catch (error) {
          console.error("Error loading course data:", error);
        }
      }

      async function loadProgress() {
        try {
          // Get existing progress from database
          const { data, error } = await supabase
            .from("course_progress")
            .select("*")
            .eq("user_id", currentUser.id)
            .eq("course_id", COURSE_DATA.id)
            .single();

          if (error && error.code !== "PGRST116") {
            throw error;
          }

          if (data) {
            courseProgress = JSON.parse(data.lesson_progress || "{}");
            currentLessonIndex = data.current_lesson || 0;

            // Update session tracking
            courseSession.lessonsStarted = Object.keys(courseProgress).length;
            courseSession.lessonsCompleted = Object.values(
              courseProgress
            ).filter((p) => p.completed).length;
          } else {
            // Initialize new progress
            courseProgress = {};
            currentLessonIndex = 0;
            await saveProgress();

            // Award first course start achievement
            await checkAndUnlockAchievement("first_course_start");
          }

          updateProgressDisplay();
        } catch (error) {
          console.error("Error loading progress:", error);
          showToast("Failed to load progress", "error");
        }
      }

      async function saveProgress() {
        try {
          if (!currentUser) return;

          const now = new Date();
          const progressData = {
            user_id: currentUser.id,
            course_id: COURSE_DATA.id,
            course_title: COURSE_DATA.title,
            current_lesson: currentLessonIndex,
            lesson_progress: JSON.stringify(courseProgress),
            progress: calculateOverallProgress(),
            lessons_completed: getCompletedLessonsCount(),
            lessons_started: Object.keys(courseProgress).length,
            study_time_minutes: courseSession.totalStudyTime,
            last_accessed: now.toISOString(),
            updated_at: now.toISOString(),
          };

          // Upsert progress
          const { error } = await supabase
            .from("course_progress")
            .upsert([progressData]);

          if (error) throw error;

          // Update user stats
          await updateUserStats();

          updateProgressDisplay();
        } catch (error) {
          console.error("Error saving progress:", error);
          showToast("Failed to save progress", "error");
        }
      }

      async function updateUserStats() {
        try {
          // Get all course progress for this user
          const { data: allProgress, error } = await supabase
            .from("course_progress")
            .select("progress, course_id, study_time_minutes")
            .eq("user_id", currentUser.id);

          if (error) throw error;

          // Calculate stats
          const completedCourses =
            allProgress?.filter((p) => p.progress >= 100).length || 0;
          const inProgressCourses =
            allProgress?.filter((p) => p.progress > 0 && p.progress < 100)
              .length || 0;
          const totalStudyTime =
            allProgress?.reduce(
              (sum, p) => sum + (p.study_time_minutes || 0),
              0
            ) || 0;

          // Calculate points (500 per completed course + achievement points)
          const coursePoints = completedCourses * 500;
          const bonusPoints = userStats.bonus_points || 0;
          const totalPoints = coursePoints + bonusPoints;

          // Update profile
          const updateData = {
            completed_courses: completedCourses,
            in_progress_courses: inProgressCourses,
            total_points: totalPoints,
            total_study_time: totalStudyTime,
            last_activity: new Date().toISOString(),
          };

          const { error: updateError } = await supabase
            .from("profiles")
            .update(updateData)
            .eq("id", currentUser.id);

          if (updateError) throw updateError;

          // Update local stats
          Object.assign(userStats, updateData);
        } catch (error) {
          console.error("Error updating user stats:", error);
        }
      }

      function calculateOverallProgress() {
        const completedLessons = getCompletedLessonsCount();
        return Math.round(
          (completedLessons / COURSE_DATA.lessons.length) * 100
        );
      }

      function getCompletedLessonsCount() {
        return Object.values(courseProgress).filter(
          (lesson) => lesson.completed
        ).length;
      }

      function updateProgressDisplay() {
        const completedCount = getCompletedLessonsCount();
        const progressPercent = calculateOverallProgress();

        // Update UI elements
        const elements = {
          completedLessons: completedCount,
          courseProgressPercent: `${progressPercent}%`,
        };

        Object.entries(elements).forEach(([id, value]) => {
          const element = document.getElementById(id);
          if (element) element.textContent = value;
        });

        // Update progress bar
        const progressBar = document.getElementById("courseProgressFill");
        if (progressBar) progressBar.style.width = `${progressPercent}%`;
      }

      // =====================================================
      // LESSON MANAGEMENT
      // =====================================================
      function loadLesson(index) {
        if (index < 0 || index >= COURSE_DATA.lessons.length) return;

        const lesson = COURSE_DATA.lessons[index];
        currentLessonIndex = index;

        // Mark lesson as started and track activity
        if (!courseProgress[lesson.id]) {
          courseProgress[lesson.id] = {
            started: true,
            completed: false,
            startedAt: new Date().toISOString(),
            timeSpent: 0,
          };

          courseSession.lessonsStarted++;
          saveProgress();

          // Log lesson start
          logUserActivity("lesson_start", {
            lesson_id: lesson.id,
            lesson_title: lesson.title,
            lesson_index: index,
          });
        }

        // Update lesson start time for time tracking
        courseProgress[lesson.id].currentSessionStart = new Date();

        // Update sidebar and navigation
        renderSidebar();
        updateNavigationButtons();

        // Update header info
        updateLessonHeader(lesson, index);

        // Render lesson content
        renderLessonContent(lesson);

        // Smooth scroll and animations
        window.scrollTo({ top: 0, behavior: "smooth" });
        document.getElementById("contentBody").scrollTop = 0;

        const contentBody = document.getElementById("contentBody");
        contentBody.classList.add("fade-in");
        setTimeout(() => contentBody.classList.remove("fade-in"), 500);

        // Check lesson-based achievements
        checkLessonAchievements(index + 1);
      }

      function updateLessonHeader(lesson, index) {
        const elements = {
          currentLessonNumber: index + 1,
          currentLessonTitle: lesson.title,
          navInfo: `Lesson ${index + 1} of ${COURSE_DATA.lessons.length}`,
        };

        Object.entries(elements).forEach(([id, value]) => {
          const element = document.getElementById(id);
          if (element) element.textContent = value;
        });
      }

      function renderSidebar() {
        const lessonNav = document.getElementById("lessonNav");
        if (!lessonNav) return;

        lessonNav.innerHTML = "";

        COURSE_DATA.lessons.forEach((lesson, index) => {
          const lessonItem = document.createElement("div");
          lessonItem.className = "lesson-item";

          // Determine lesson status
          const lessonProgress = courseProgress[lesson.id];
          const isCompleted = lessonProgress?.completed || false;
          const isInProgress = lessonProgress?.started || false;
          const isLocked = !isCompleted && !canAccessLesson(index);
          const isActive = index === currentLessonIndex;

          // Apply status classes
          if (isCompleted) lessonItem.classList.add("completed");
          if (isLocked) lessonItem.classList.add("locked");
          if (isActive) lessonItem.classList.add("active");

          // Determine status display
          let statusClass = "not-started";
          let statusIcon = index + 1;

          if (isCompleted) {
            statusClass = "completed";
            statusIcon = "✓";
          } else if (isInProgress) {
            statusClass = "in-progress";
            statusIcon = "◐";
          }

          // Create lesson item HTML
          lessonItem.innerHTML = `
            <div class="lesson-status ${statusClass}">${statusIcon}</div>
            <div class="lesson-info">
                <div class="lesson-title">${lesson.title}</div>
                <div class="lesson-meta">
                    ${
                      isCompleted
                        ? "Completed"
                        : isInProgress
                        ? "In Progress"
                        : isLocked
                        ? "Locked"
                        : "Not Started"
                    }
                </div>
            </div>
            <div class="lesson-duration">${lesson.duration}</div>
        `;

          // Add click handler if not locked
          if (!isLocked) {
            lessonItem.addEventListener("click", () => {
              if (index !== currentLessonIndex) {
                // Track lesson time before switching
                trackLessonTime();

                currentLessonIndex = index;
                loadLesson(index);
                closeSidebar();
              }
            });
          }

          lessonNav.appendChild(lessonItem);
        });
      }

      function canAccessLesson(index) {
        if (index === 0) return true; // First lesson always accessible

        // Can access if previous lesson is completed
        const previousLessonId = COURSE_DATA.lessons[index - 1].id;
        return courseProgress[previousLessonId]?.completed || false;
      }

      function trackLessonTime() {
        const currentLesson = COURSE_DATA.lessons[currentLessonIndex];
        const lessonProgress = courseProgress[currentLesson.id];

        if (lessonProgress?.currentSessionStart) {
          const sessionTime = Math.floor(
            (new Date() - new Date(lessonProgress.currentSessionStart)) /
              1000 /
              60
          );
          lessonProgress.timeSpent =
            (lessonProgress.timeSpent || 0) + sessionTime;
          delete lessonProgress.currentSessionStart;
        }
      }

      // =====================================================
      // LESSON CONTENT RENDERING
      // =====================================================
      function renderLessonContent(lesson) {
        const contentContainer = document.getElementById("lessonContent");
        if (!contentContainer) return;

        let contentHTML = `
        <div class="content-section">
            <h2>Learning Objectives</h2>
            <ul>
                ${lesson.objectives.map((obj) => `<li>${obj}</li>`).join("")}
            </ul>
        </div>
        
        <div class="content-section">
            <h2>Overview</h2>
            <p>${lesson.content.overview}</p>
        </div>
    `;

        // Render content sections
        lesson.content.sections.forEach((section) => {
          contentHTML += `
            <div class="content-section">
                <h2>${section.title}</h2>
                ${section.content}
                ${
                  section.image
                    ? `<img src="${section.image}" alt="${section.title}" class="content-image" loading="lazy">`
                    : ""
                }
            </div>
        `;
        });

        // Render code examples
        if (
          lesson.content.codeExamples &&
          lesson.content.codeExamples.length > 0
        ) {
          contentHTML += `<div class="content-section"><h2>Code Examples</h2></div>`;

          lesson.content.codeExamples.forEach((example, index) => {
            const codeId = `code-${lesson.id}-${index}`;
            contentHTML += `
                <div class="code-section">
                    <div class="code-header">
                        <span class="code-title">${example.title}</span>
                        <button class="copy-btn" onclick="copyCode('${codeId}')">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                    <pre class="code-block"><code id="${codeId}" class="language-${
              example.language
            }">${escapeHtml(example.code)}</code></pre>
                </div>
            `;
          });
        }

        // Render quiz
        contentHTML += renderQuiz(lesson.quiz);

        contentContainer.innerHTML = contentHTML;

        // Highlight code syntax if Prism is available
        setTimeout(() => {
          if (window.Prism) {
            Prism.highlightAll();
          }
        }, 100);
      }

      // =====================================================
      // QUIZ SYSTEM
      // =====================================================
      function renderQuiz(quiz) {
        const currentLessonProgress =
          courseProgress[COURSE_DATA.lessons[currentLessonIndex].id];
        const isCompleted = currentLessonProgress?.completed || false;

        let quizHTML = `
        <div class="quiz-section" id="quizSection">
            <div class="quiz-header">
                <h2 class="quiz-title">
                    <i class="fas fa-clipboard-check"></i>
                    Knowledge Check
                </h2>
                <p class="quiz-info">
                    Complete this quiz with ${quiz.passingScore}% or higher to unlock the next lesson.
                </p>
            </div>
    `;

        if (isCompleted) {
          const savedScore = currentLessonProgress.quizScore || 0;
          quizHTML += `
            <div class="quiz-results show">
                <div class="quiz-score pass">${savedScore}%</div>
                <div class="quiz-message">
                    <strong>Lesson Completed!</strong><br>
                    You've successfully passed this lesson's quiz.
                </div>
            </div>
        `;
        } else {
          // Render quiz questions
          quiz.questions.forEach((question, qIndex) => {
            quizHTML += `
                <div class="quiz-question ${
                  qIndex === 0 ? "active" : ""
                }" data-question="${qIndex}">
                    <div class="question-header">
                        <span class="question-number">Question ${
                          qIndex + 1
                        }</span>
                        <span class="question-progress">${qIndex + 1}/${
              quiz.questions.length
            }</span>
                    </div>
                    <div class="question-text">${question.question}</div>
                    <div class="question-options">
                        ${question.options
                          .map(
                            (option, oIndex) => `
                            <div class="option" data-option="${oIndex}" onclick="selectOption(${qIndex}, ${oIndex})">
                                <span class="option-letter">${String.fromCharCode(
                                  65 + oIndex
                                )}</span>
                                <span class="option-text">${option}</span>
                            </div>
                        `
                          )
                          .join("")}
                    </div>
                </div>
            `;
          });

          quizHTML += `
            <div class="quiz-controls">
                <button class="btn btn-secondary" id="prevQuestionBtn" onclick="previousQuestion()" disabled>
                    <i class="fas fa-chevron-left"></i>
                    Previous
                </button>
                <div>
                    <button class="btn btn-secondary" id="nextQuestionBtn" onclick="nextQuestion()" disabled>
                        Next
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <button class="btn btn-primary" id="submitQuizBtn" onclick="submitQuiz()" style="display: none;">
                        <i class="fas fa-check"></i>
                        Submit Quiz
                    </button>
                </div>
            </div>

            <div class="quiz-results" id="quizResults">
                <div class="quiz-score" id="quizScore">0%</div>
                <div class="quiz-message" id="quizMessage"></div>
                <div class="quiz-actions">
                    <button class="btn btn-primary" id="continueBtn" onclick="completeLesson()" style="display: none;">
                        <i class="fas fa-arrow-right"></i>
                        Continue to Next Lesson
                    </button>
                    <button class="btn btn-secondary" onclick="retakeQuiz()">
                        <i class="fas fa-redo"></i>
                        Retake Quiz
                    </button>
                </div>
            </div>
        `;
        }

        quizHTML += "</div>";
        return quizHTML;
      }

      // Quiz interaction functions
      function selectOption(questionIndex, optionIndex) {
        // Clear previous selections
        document
          .querySelectorAll(`[data-question="${questionIndex}"] .option`)
          .forEach((opt) => {
            opt.classList.remove("selected");
          });

        // Select current option
        const selectedOption = document.querySelector(
          `[data-question="${questionIndex}"] [data-option="${optionIndex}"]`
        );
        selectedOption.classList.add("selected");

        // Store answer
        quizState.answers[questionIndex] = optionIndex;

        // Update navigation
        const isLastQuestion =
          questionIndex ===
          COURSE_DATA.lessons[currentLessonIndex].quiz.questions.length - 1;
        if (isLastQuestion) {
          document.getElementById("submitQuizBtn").style.display =
            "inline-flex";
          document.getElementById("nextQuestionBtn").style.display = "none";
        } else {
          document.getElementById("nextQuestionBtn").disabled = false;
        }
      }

      function nextQuestion() {
        const currentQuestionEl = document.querySelector(
          ".quiz-question.active"
        );
        const nextQuestionEl = currentQuestionEl.nextElementSibling;

        if (
          nextQuestionEl &&
          nextQuestionEl.classList.contains("quiz-question")
        ) {
          currentQuestionEl.classList.remove("active");
          nextQuestionEl.classList.add("active");
          quizState.currentQuestion++;
          updateQuizNavigation();
        }
      }

      function previousQuestion() {
        const currentQuestionEl = document.querySelector(
          ".quiz-question.active"
        );
        const prevQuestionEl = currentQuestionEl.previousElementSibling;

        if (
          prevQuestionEl &&
          prevQuestionEl.classList.contains("quiz-question")
        ) {
          currentQuestionEl.classList.remove("active");
          prevQuestionEl.classList.add("active");
          quizState.currentQuestion--;
          updateQuizNavigation();
        }
      }

      function updateQuizNavigation() {
        const totalQuestions =
          COURSE_DATA.lessons[currentLessonIndex].quiz.questions.length;
        const prevBtn = document.getElementById("prevQuestionBtn");
        const nextBtn = document.getElementById("nextQuestionBtn");
        const submitBtn = document.getElementById("submitQuizBtn");

        prevBtn.disabled = quizState.currentQuestion === 0;

        const hasAnswer =
          quizState.answers[quizState.currentQuestion] !== undefined;
        const isLastQuestion = quizState.currentQuestion === totalQuestions - 1;

        if (isLastQuestion) {
          nextBtn.style.display = "none";
          submitBtn.style.display = hasAnswer ? "inline-flex" : "none";
        } else {
          nextBtn.style.display = "inline-flex";
          nextBtn.disabled = !hasAnswer;
          submitBtn.style.display = "none";
        }
      }

      async function submitQuiz() {
        const lesson = COURSE_DATA.lessons[currentLessonIndex];
        const quiz = lesson.quiz;
        let correctAnswers = 0;

        // Hide questions and controls
        document
          .querySelectorAll(".quiz-question")
          .forEach((q) => (q.style.display = "none"));
        document.querySelector(".quiz-controls").style.display = "none";

        // Calculate score and highlight answers
        quiz.questions.forEach((question, index) => {
          const userAnswer = quizState.answers[index];
          const correctAnswer = question.correct;
          const isCorrect = userAnswer === correctAnswer;

          if (isCorrect) correctAnswers++;

          // Highlight answers
          const questionEl = document.querySelector(
            `[data-question="${index}"]`
          );
          const options = questionEl.querySelectorAll(".option");

          options[correctAnswer].classList.add("correct");
          if (userAnswer !== correctAnswer && userAnswer !== undefined) {
            options[userAnswer].classList.add("incorrect");
          }
        });

        const score = Math.round(
          (correctAnswers / quiz.questions.length) * 100
        );
        const passed = score >= quiz.passingScore;

        // Update quiz results UI
        const quizScore = document.getElementById("quizScore");
        const quizMessage = document.getElementById("quizMessage");
        const quizActions = document.querySelector(".quiz-actions");

        quizScore.textContent = `${score}%`;
        quizScore.className = `quiz-score ${passed ? "pass" : "fail"}`;

        if (passed) {
          quizMessage.innerHTML = `
            <strong>Congratulations!</strong><br>
            You passed with ${score}%. You can now proceed to the next lesson.
        `;

          quizActions.innerHTML = `
            <button class="btn btn-primary" onclick="completeLesson()">
                <i class="fas fa-arrow-right"></i>
                Continue to Next Lesson
            </button>
        `;

          // Mark lesson as completed
          await markLessonComplete(score);
        } else {
          quizMessage.innerHTML = `
            <strong>Not quite there yet.</strong><br>
            You scored ${score}%. You need ${quiz.passingScore}% to pass. Review the material and try again.
        `;

          quizActions.innerHTML = `
            <button class="btn btn-secondary" onclick="retakeQuiz()">
                <i class="fas fa-redo"></i>
                Retake Quiz
            </button>
        `;
        }

        document.getElementById("quizResults").classList.add("show");

        // Log quiz completion
        logUserActivity("quiz_completed", {
          lesson_id: lesson.id,
          lesson_title: lesson.title,
          score: score,
          passed: passed,
          attempts: (courseProgress[lesson.id]?.quizAttempts || 0) + 1,
        });

        // Scroll to results
        document
          .getElementById("quizResults")
          .scrollIntoView({ behavior: "smooth" });
      }

      function retakeQuiz() {
        // Reset quiz state
        quizState = {
          currentQuestion: 0,
          answers: [],
          score: 0,
          isComplete: false,
        };

        // Track quiz retry
        const lessonId = COURSE_DATA.lessons[currentLessonIndex].id;
        if (!courseProgress[lessonId]) courseProgress[lessonId] = {};
        courseProgress[lessonId].quizAttempts =
          (courseProgress[lessonId].quizAttempts || 0) + 1;

        // Reload lesson content
        loadLesson(currentLessonIndex);

        // Scroll to quiz
        setTimeout(() => {
          document
            .getElementById("quizSection")
            .scrollIntoView({ behavior: "smooth" });
        }, 500);
      }

      async function markLessonComplete(score) {
        const lesson = COURSE_DATA.lessons[currentLessonIndex];
        const lessonId = lesson.id;

        // Track lesson completion time
        trackLessonTime();

        // Update lesson progress
        courseProgress[lessonId] = {
          ...courseProgress[lessonId],
          completed: true,
          quizScore: score,
          completedAt: new Date().toISOString(),
          finalScore: score,
        };

        // Update session tracking
        courseSession.lessonsCompleted++;

        // Save progress to database
        await saveProgress();

        // Update UI
        renderSidebar();
        updateNavigationButtons();

        // Check various achievements
        await checkLessonCompletionAchievements();
        await checkPerfectScoreAchievements(score);
        await checkStudyTimeAchievements();

        // Log lesson completion
        logUserActivity("lesson_completed", {
          lesson_id: lessonId,
          lesson_title: lesson.title,
          final_score: score,
          time_spent: courseProgress[lessonId].timeSpent || 0,
          lesson_number: currentLessonIndex + 1,
        });

        showToast("Lesson completed successfully!", "success");
      }

      async function completeLesson() {
        if (currentLessonIndex < COURSE_DATA.lessons.length - 1) {
          // Move to next lesson
          currentLessonIndex++;
          loadLesson(currentLessonIndex);
        } else {
          // Course completion
          await completeCourse();
        }
      }

      async function completeCourse() {
        try {
          const completionTime = courseSession.totalStudyTime;

          // Update course progress to 100% completed
          await supabase
            .from("course_progress")
            .update({
              progress: 100,
              completed_at: new Date().toISOString(),
              completion_time_minutes: completionTime,
            })
            .eq("user_id", currentUser.id)
            .eq("course_id", COURSE_DATA.id);

          // Award course completion achievements
          await checkAndUnlockAchievement("course_completion_1");
          await checkSpeedCompletionAchievements(completionTime);
          await checkCourseStreakAchievements();

          // Update user stats
          await updateUserStats();

          // Show completion message
          showToast(
            "Congratulations! Course completed successfully!",
            "certificate"
          );

          // Log course completion
          logUserActivity("course_completed", {
            course_id: COURSE_DATA.id,
            course_title: COURSE_DATA.title,
            completion_time_minutes: completionTime,
            total_lessons: COURSE_DATA.lessons.length,
            average_quiz_score: calculateAverageQuizScore(),
          });

          // Redirect to dashboard after delay
          setTimeout(() => {
            window.location.href = "/dashboard";
          }, 3000);
        } catch (error) {
          console.error("Error completing course:", error);
          showToast("Error marking course as complete", "error");
        }
      }

      // =====================================================
      // ACHIEVEMENT INTEGRATION SYSTEM
      // =====================================================
      async function checkAndUnlockAchievement(
        achievementId,
        skipNotification = false
      ) {
        try {
          // Prevent duplicate checks
          const cacheKey = `achievement_${achievementId}_${currentUser.id}`;
          if (sessionStorage.getItem(cacheKey)) return false;

          // Check if already unlocked
          const { data: existing, error } = await supabase
            .from("user_achievements")
            .select("id")
            .eq("user_id", currentUser.id)
            .eq("achievement_id", achievementId)
            .single();

          if (existing) {
            sessionStorage.setItem(cacheKey, "true");
            return false;
          }

          // Award achievement
          const achievementData = {
            user_id: currentUser.id,
            achievement_id: achievementId,
            unlocked_at: new Date().toISOString(),
            points_awarded: getAchievementPoints(achievementId),
            context: "course_system",
          };

          const { data, error: insertError } = await supabase
            .from("user_achievements")
            .insert([achievementData])
            .select()
            .single();

          if (insertError) {
            if (insertError.code === "23505") return false; // Already exists
            throw insertError;
          }

          // Update user points
         await supabase.rpc('increment_user_stats', {
  user_id_param: currentUser.id,
  points_to_add: achievementData.points_awarded,
  achievements_to_add: 1
});

          // Cache and queue notification
          sessionStorage.setItem(cacheKey, "true");

          if (!skipNotification) {
            queueAchievementNotification({
              id: achievementId,
              name: getAchievementName(achievementId),
              description: getAchievementDescription(achievementId),
              points: achievementData.points_awarded,
              rarity: getAchievementRarity(achievementId),
              icon: getAchievementIcon(achievementId),
            });
          }

          return true;
        } catch (error) {
          console.error("Error unlocking achievement:", error);
          return false;
        }
      }

      // Helper functions for achievement data (replace with your actual achievement definitions)
      function getAchievementPoints(id) {
        const pointsMap = {
          first_course_start: 75,
          first_lesson: 100,
          course_completion_1: 500,
          perfect_score: 250,
          speed_demon: 750,
          marathon_learner: 500,
          night_owl: 200,
          early_bird: 200,
          weekend_warrior: 150,
          // Add more as needed
        };
        return pointsMap[id] || 100;
      }

      function getAchievementName(id) {
        const nameMap = {
          first_course_start: "Learning Initiated",
          first_lesson: "First Steps",
          course_completion_1: "Course Conqueror",
          perfect_score: "Perfectionist",
          speed_demon: "Speed Demon",
          // Add more as needed
        };
        return nameMap[id] || "Achievement Unlocked";
      }

      function getAchievementDescription(id) {
        const descMap = {
          first_course_start: "Start your first cybersecurity course",
          first_lesson: "Complete your first lesson",
          course_completion_1: "Complete your first course",
          perfect_score: "Score 100% on any quiz",
          speed_demon: "Complete a course in under 2 hours",
          // Add more as needed
        };
        return descMap[id] || "Achievement description";
      }

      function getAchievementRarity(id) {
        const rarityMap = {
          first_course_start: "common",
          first_lesson: "bronze",
          course_completion_1: "silver",
          perfect_score: "gold",
          speed_demon: "legendary",
          // Add more as needed
        };
        return rarityMap[id] || "common";
      }

      function getAchievementIcon(id) {
        const iconMap = {
          first_course_start: "fas fa-play",
          first_lesson: "fas fa-baby",
          course_completion_1: "fas fa-trophy",
          perfect_score: "fas fa-star",
          speed_demon: "fas fa-rocket",
          // Add more as needed
        };
        return iconMap[id] || "fas fa-award";
      }

      async function checkLessonAchievements(lessonNumber) {
        if (lessonNumber === 1) {
          await checkAndUnlockAchievement("first_lesson");
        }

        // Check if user has completed multiple lessons in one day
        const today = new Date().toISOString().split("T")[0];
        const todayCompletions = Object.values(courseProgress).filter(
          (p) => p.completed && p.completedAt?.startsWith(today)
        ).length;

        if (todayCompletions >= 3) {
          await checkAndUnlockAchievement("lesson_marathon");
        }
      }

      async function checkLessonCompletionAchievements() {
        const completedCount = getCompletedLessonsCount();

        // Lesson-based achievements
        const lessonMilestones = [1, 5, 10, 25, 50, 100];
        for (const milestone of lessonMilestones) {
          if (completedCount >= milestone) {
            await checkAndUnlockAchievement(`lessons_${milestone}`);
          }
        }

        // Course completion achievements
        if (completedCount === COURSE_DATA.lessons.length) {
          await checkAndUnlockAchievement("course_completion_1");

          // Check for additional course completion achievements
          const { data: allCourses } = await supabase
            .from("course_progress")
            .select("course_id")
            .eq("user_id", currentUser.id)
            .eq("progress", 100);

          const totalCompleted = allCourses?.length || 0;

          const courseMilestones = [1, 5, 10, 25];
          for (const milestone of courseMilestones) {
            if (totalCompleted >= milestone) {
              await checkAndUnlockAchievement(`course_completion_${milestone}`);
            }
          }
        }
      }

      async function checkPerfectScoreAchievements(score) {
        if (score === 100) {
          await checkAndUnlockAchievement("perfect_score");

          // Check for consecutive perfect scores
          const recentScores = Object.values(courseProgress)
            .filter((p) => p.completed && p.quizScore)
            .slice(-5) // Last 5 completed
            .map((p) => p.quizScore);

          if (
            recentScores.length >= 3 &&
            recentScores.every((s) => s === 100)
          ) {
            await checkAndUnlockAchievement("perfectionist_streak");
          }
        }
      }

      async function checkSpeedCompletionAchievements(completionTime) {
        // Speed demon: Complete course in under 2 hours (120 minutes)
        if (completionTime <= 120) {
          await checkAndUnlockAchievement("speed_demon");
        }

        // Quick learner: Complete course in under 4 hours (240 minutes)
        if (completionTime <= 240) {
          await checkAndUnlockAchievement("quick_learner");
        }
      }

      async function checkStudyTimeAchievements() {
        const totalTime = courseSession.totalStudyTime;

        // Marathon learner: Study for 8+ hours in a course session
        if (totalTime >= 480) {
          // 8 hours
          await checkAndUnlockAchievement("marathon_learner");
        }

        // Dedicated learner: Study for 4+ hours
        if (totalTime >= 240) {
          // 4 hours
          await checkAndUnlockAchievement("dedicated_learner");
        }
      }

      async function checkCourseStreakAchievements() {
        try {
          // Check for consecutive course completions
          const { data: recentCourses, error } = await supabase
            .from("course_progress")
            .select("completed_at, course_id")
            .eq("user_id", currentUser.id)
            .eq("progress", 100)
            .order("completed_at", { ascending: false })
            .limit(10);

          if (error || !recentCourses) return;

          // Check for courses completed on consecutive days
          let consecutiveDays = 1;
          for (let i = 1; i < recentCourses.length; i++) {
            const prevDate = new Date(
              recentCourses[i - 1].completed_at
            ).toDateString();
            const currentDate = new Date(
              recentCourses[i].completed_at
            ).toDateString();
            const dayDiff =
              Math.abs(new Date(prevDate) - new Date(currentDate)) /
              (1000 * 60 * 60 * 24);

            if (dayDiff <= 1) {
              consecutiveDays++;
            } else {
              break;
            }
          }

          if (consecutiveDays >= 3) {
            await checkAndUnlockAchievement("learning_streak");
          }
        } catch (error) {
          console.error("Error checking course streak achievements:", error);
        }
      }

      // =====================================================
      // TIME-BASED ACHIEVEMENTS
      // =====================================================
      async function checkTimeBasedAchievements(timestamp) {
        const hour = timestamp.getHours();
        const dayOfWeek = timestamp.getDay();

        // Night owl (after midnight, before 6 AM)
        if (hour >= 0 && hour < 6) {
          await incrementTimeBasedCounter("midnight_sessions", "night_owl");
        }

        // Early bird (4 AM to 6 AM)
        if (hour >= 4 && hour < 6) {
          await incrementTimeBasedCounter("early_sessions", "early_bird");
        }

        // Weekend warrior (Saturday = 6, Sunday = 0)
        if (dayOfWeek === 0 || dayOfWeek === 6) {
          await incrementTimeBasedCounter(
            "weekend_sessions",
            "weekend_warrior"
          );
        }
      }

      async function incrementTimeBasedCounter(counterType, achievementId) {
        try {
          const dateStr = new Date().toISOString().split("T")[0];
          const cacheKey = `${counterType}_${currentUser.id}_${dateStr}`;

          // Prevent multiple increments per day
          if (sessionStorage.getItem(cacheKey)) return;

          // Update counter
         await supabase.rpc('increment_profile_counter', {
  user_id_param: currentUser.id,
  counter_field: counterType,
  increment_value: 1
});

          // Cache to prevent double counting
          sessionStorage.setItem(cacheKey, "true");

          // Check related achievement
          if (achievementId) {
            await checkAndUnlockAchievement(achievementId, true);
          }
        } catch (error) {
          console.error(`Error incrementing ${counterType}:`, error);
        }
      }

      async function checkDailyStreak() {
        try {
          const { data: profile, error } = await supabase
            .from("profiles")
            .select("last_activity, current_streak, last_streak_date")
            .eq("id", currentUser.id)
            .single();

          if (error) throw error;

          const now = new Date();
          const today = now.toDateString();
          const lastActivity = profile.last_activity
            ? new Date(profile.last_activity)
            : null;
          const lastStreakDate = profile.last_streak_date
            ? new Date(profile.last_streak_date).toDateString()
            : null;

          let newStreak = profile.current_streak || 0;
          let shouldUpdateStreak = false;

          if (!lastActivity) {
            // First time user
            newStreak = 1;
            shouldUpdateStreak = true;
          } else {
            const daysSinceLastActivity = Math.floor(
              (now - lastActivity) / (1000 * 60 * 60 * 24)
            );

            if (lastStreakDate === today) {
              // Already counted today's streak
              return newStreak;
            } else if (
              daysSinceLastActivity === 1 ||
              (daysSinceLastActivity === 0 && lastStreakDate !== today)
            ) {
              // Consecutive day or same day but not counted yet
              newStreak += 1;
              shouldUpdateStreak = true;
            } else if (daysSinceLastActivity > 1) {
              // Streak broken
              newStreak = 1;
              shouldUpdateStreak = true;
            }
          }

          if (shouldUpdateStreak) {
            await supabase
              .from("profiles")
              .update({
                current_streak: newStreak,
                last_activity: now.toISOString(),
                last_streak_date: now.toISOString(),
              })
              .eq("id", currentUser.id);

            userStats.current_streak = newStreak;

            showToast(`Daily streak: ${newStreak} days!`, "success");
            await checkStreakAchievements(newStreak);
          }

          return newStreak;
        } catch (error) {
          console.error("Error checking daily streak:", error);
          return 0;
        }
      }

      async function checkStreakAchievements(currentStreak) {
        const streakMilestones = [3, 7, 14, 30, 100, 365];

        for (const milestone of streakMilestones) {
          if (currentStreak >= milestone) {
            await checkAndUnlockAchievement(`streak_${milestone}`);
          }
        }
      }

      // =====================================================
      // USER ACTIVITY LOGGING
      // =====================================================
      async function logUserActivity(activityType, metadata = {}) {
        try {
          const now = new Date();

          const activityData = {
            user_id: currentUser.id,
            activity_type: activityType,
            timestamp: now.toISOString(),
            course_id: COURSE_DATA.id,
            lesson_index: currentLessonIndex,
            session_duration: courseSession.totalStudyTime,
            metadata: JSON.stringify(metadata),
            created_at: now.toISOString(),
          };

          // Try to log to activities table
          const { error } = await supabase
            .from("user_activities")
            .insert([activityData]);

          if (error && error.code !== "42P01") {
            console.warn("Activity logging failed:", error.message);
          }

          // Always update last activity in profile
          await supabase
            .from("profiles")
            .update({ last_activity: now.toISOString() })
            .eq("id", currentUser.id);
        } catch (error) {
          console.error("Error logging user activity:", error);
        }
      }

      // =====================================================
      // NAVIGATION SYSTEM
      // =====================================================
      function updateNavigationButtons() {
        const prevBtn = document.getElementById("prevLessonBtn");
        const nextBtn = document.getElementById("nextLessonBtn");

        if (!prevBtn || !nextBtn) return;

        // Previous button
        prevBtn.disabled = currentLessonIndex === 0;

        // Next button logic
        const isLastLesson =
          currentLessonIndex === COURSE_DATA.lessons.length - 1;
        const canGoNext =
          currentLessonIndex < COURSE_DATA.lessons.length - 1 &&
          canAccessLesson(currentLessonIndex + 1);

        if (isLastLesson) {
          const isCurrentCompleted =
            courseProgress[COURSE_DATA.lessons[currentLessonIndex].id]
              ?.completed;
          nextBtn.disabled = !isCurrentCompleted;
          nextBtn.innerHTML = '<i class="fas fa-trophy"></i> Complete Course';
        } else {
          nextBtn.disabled = !canGoNext;
          nextBtn.innerHTML = 'Next <i class="fas fa-chevron-right"></i>';
        }
      }

      // Navigation button event handlers
      function goToPreviousLesson() {
        if (currentLessonIndex > 0) {
          trackLessonTime(); // Track time spent on current lesson
          currentLessonIndex--;
          loadLesson(currentLessonIndex);
        }
      }

      function goToNextLesson() {
        if (currentLessonIndex < COURSE_DATA.lessons.length - 1) {
          const canGoNext = canAccessLesson(currentLessonIndex + 1);
          if (canGoNext) {
            trackLessonTime();
            currentLessonIndex++;
            loadLesson(currentLessonIndex);
          } else {
            showToast("Complete the current lesson quiz to proceed", "warning");
          }
        } else {
          // Complete course
          completeCourse();
        }
      }

      // =====================================================
      // SIDEBAR FUNCTIONS
      // =====================================================
      function toggleSidebar() {
        const sidebar = document.getElementById("sidebar");
        const overlay = document.getElementById("sidebarOverlay");

        if (sidebar) sidebar.classList.toggle("open");
        if (overlay) overlay.classList.toggle("active");
      }

      function closeSidebar() {
        const sidebar = document.getElementById("sidebar");
        const overlay = document.getElementById("sidebarOverlay");

        if (sidebar) sidebar.classList.remove("open");
        if (overlay) overlay.classList.remove("active");
      }

      // =====================================================
      // ACHIEVEMENT NOTIFICATION SYSTEM
      // =====================================================
      function queueAchievementNotification(achievement) {
        notificationQueue.push(achievement);
        processNotificationQueue();
      }

      function processNotificationQueue() {
        if (isShowingNotification || notificationQueue.length === 0) return;

        isShowingNotification = true;
        const achievement = notificationQueue.shift();
        showAchievementNotification(achievement);

        const duration =
          achievement.rarity === "mythic"
            ? 8000
            : achievement.rarity === "legendary"
            ? 7000
            : 6000;

        setTimeout(() => {
          isShowingNotification = false;
          processNotificationQueue();
        }, duration + 500);
      }

      function showAchievementNotification(achievement) {
        const notification = document.getElementById("achievementNotification");
        if (!notification) return;

        const icon = document.getElementById("notificationIcon");
        const title = document.getElementById("notificationTitle");
        const description = document.getElementById("notificationDescription");
        const points = document.getElementById("notificationPoints");

        if (icon) {
          icon.innerHTML = `<i class="${achievement.icon}"></i>`;
          icon.className = `notification-icon ${achievement.rarity}`;
        }
        if (title) title.textContent = achievement.name;
        if (description) description.textContent = achievement.description;
        if (points) points.textContent = `+${achievement.points} Points`;

        notification.className = `achievement-notification ${achievement.rarity}`;
        notification.classList.add("show");

        const duration =
          achievement.rarity === "mythic"
            ? 8000
            : achievement.rarity === "legendary"
            ? 7000
            : 6000;

        setTimeout(() => {
          notification.classList.remove("show");
        }, duration);
      }

      // =====================================================
      // UTILITY FUNCTIONS
      // =====================================================
      function calculateAverageQuizScore() {
        const scores = Object.values(courseProgress)
          .filter((p) => p.completed && p.quizScore)
          .map((p) => p.quizScore);

        if (scores.length === 0) return 0;
        return Math.round(
          scores.reduce((sum, score) => sum + score, 0) / scores.length
        );
      }

      async function resetProgress() {
        if (
          !confirm(
            "Are you sure you want to reset your progress? This action cannot be undone."
          )
        ) {
          return;
        }

        try {
          // Track lesson time before reset
          trackLessonTime();

          // Reset local state
          courseProgress = {};
          currentLessonIndex = 0;
          courseSession = {
            startTime: new Date(),
            totalStudyTime: 0,
            lessonsStarted: 0,
            lessonsCompleted: 0,
            pageLoadTime: new Date(),
            interactionCount: 0,
            lastActivityTime: new Date(),
          };

          // Delete from database
          await supabase
            .from("course_progress")
            .delete()
            .eq("user_id", currentUser.id)
            .eq("course_id", COURSE_DATA.id);

          // Log reset activity
          logUserActivity("progress_reset", {
            course_id: COURSE_DATA.id,
            reset_reason: "manual",
          });

          // Reinitialize
          await saveProgress();
          renderSidebar();
          loadLesson(0);

          showToast("Progress reset successfully", "success");
        } catch (error) {
          console.error("Error resetting progress:", error);
          showToast("Failed to reset progress", "error");
        }
      }

      function copyCode(codeId) {
        const codeElement = document.getElementById(codeId);
        if (!codeElement) return;

        const text = codeElement.textContent;

        navigator.clipboard
          .writeText(text)
          .then(() => {
            showToast("Code copied to clipboard!", "success");

            // Track code copy for achievements
            logUserActivity("code_copied", {
              code_section: codeId,
              lesson_id: COURSE_DATA.lessons[currentLessonIndex].id,
            });
          })
          .catch((err) => {
            console.error("Failed to copy code:", err);
            showToast("Failed to copy code", "error");

            // Fallback for older browsers
            const textArea = document.createElement("textarea");
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            try {
              document.execCommand("copy");
              showToast("Code copied to clipboard!", "success");
            } catch (fallbackError) {
              showToast(
                "Copy failed - please select and copy manually",
                "error"
              );
            }
            document.body.removeChild(textArea);
          });
      }

      function escapeHtml(text) {
        const div = document.createElement("div");
        div.textContent = text;
        return div.innerHTML;
      }

      // =====================================================
      // UI FEEDBACK SYSTEMS
      // =====================================================
      function showToast(message, type = "success") {
        const toast = document.getElementById("toast");
        const messageEl = document.getElementById("toastMessage");

        if (!toast || !messageEl) {
          console.log(`Toast: ${message} (${type})`);
          return;
        }

        messageEl.textContent = message;
        toast.className = `toast ${type} show`;

        setTimeout(() => {
          toast.classList.remove("show");
        }, 4000);
      }

      function showLoadingScreen() {
        const loadingScreen = document.getElementById("loadingScreen");
        if (loadingScreen) loadingScreen.classList.remove("hidden");
      }

      function hideLoadingScreen() {
        const loadingScreen = document.getElementById("loadingScreen");
        if (loadingScreen) {
          setTimeout(() => {
            loadingScreen.classList.add("hidden");
          }, 1000);
        }
      }

      // =====================================================
      // MUSIC PLAYER INTEGRATION
      // =====================================================
      function initMusicPlayer() {
        const btnText = document.getElementById("music-button-text");
        const icon = document.getElementById("music-icon");
        const dropdown = document.getElementById("music-dropdown-content");

        if (!btnText || !icon || !dropdown) return;

        function setUI(state) {
          btnText.textContent =
            state === "Playing" ? "PAUSE MUSIC" : "STUDY MUSIC";
          icon.className =
            state === "Playing"
              ? "fa-solid fa-circle-pause"
              : "fa-solid fa-music";
        }

        // Load saved music state
        const savedSrc = localStorage.getItem("cybersec_music_src");
        const savedTime = parseFloat(
          localStorage.getItem("cybersec_music_time") || 0
        );

        if (savedSrc) {
          audioPlayer.src = savedSrc;
          audioPlayer.currentTime = savedTime;
          audioPlayer
            .play()
            .then(() => setUI("Playing"))
            .catch(() => setUI("Stopped"));
        }

        // Music button click handler
        document
          .getElementById("music-dropdown")
          .querySelector("button")
          .addEventListener("click", (e) => {
            e.stopPropagation();
            dropdown.style.display =
              dropdown.style.display === "block" ? "none" : "block";

            if (audioPlayer.src && !audioPlayer.paused) {
              audioPlayer.pause();
              setUI("Stopped");
            } else if (audioPlayer.src) {
              audioPlayer.play().then(() => setUI("Playing"));
            }
          });

        // Music selection handlers
        dropdown.querySelectorAll("a[data-src]").forEach((link) => {
          link.addEventListener("click", (e) => {
            e.preventDefault();
            audioPlayer.src = link.dataset.src;
            audioPlayer.play().then(() => setUI("Playing"));
            localStorage.setItem("cybersec_music_src", link.dataset.src);
            dropdown.style.display = "none";
          });
        });

        // Stop music handler
        const stopLink = document.getElementById("stop-music-link");
        if (stopLink) {
          stopLink.addEventListener("click", (e) => {
            e.preventDefault();
            audioPlayer.pause();
            audioPlayer.currentTime = 0;
            audioPlayer.removeAttribute("src");
            setUI("Stopped");
            localStorage.removeItem("cybersec_music_src");
            localStorage.removeItem("cybersec_music_time");
            dropdown.style.display = "none";
          });
        }

        // Save music state before page unload
        window.addEventListener("beforeunload", () => {
          if (!audioPlayer.paused && audioPlayer.src) {
            localStorage.setItem("cybersec_music_src", audioPlayer.src);
            localStorage.setItem(
              "cybersec_music_time",
              audioPlayer.currentTime
            );
          }
        });

        // Close dropdown when clicking outside
        window.addEventListener("click", (e) => {
          if (!e.target.closest("#music-dropdown")) {
            dropdown.style.display = "none";
          }
        });
      }

      // Show initial music indicator
      function addMusicIndicator() {
        const musicBtn = document.querySelector("#music-dropdown");
        if (musicBtn) {
          const indicator = document.createElement("div");
          indicator.className = "music-indicator";
          indicator.innerHTML = `<i class="fa-solid fa-music"></i> Try Study Music!`;

          musicBtn.style.position = "relative";
          musicBtn.appendChild(indicator);

          setTimeout(() => indicator.remove(), 3000);
        }
      }

      // Initialize Event Listeners
      function initializeEventListeners() {
        // Navigation buttons
        document
          .getElementById("prevLessonBtn")
          ?.addEventListener("click", goToPreviousLesson);
        document
          .getElementById("nextLessonBtn")
          ?.addEventListener("click", goToNextLesson);

        // Reset progress button
        document
          .getElementById("resetProgressBtn")
          ?.addEventListener("click", resetProgress);

        // Mobile menu toggle
        document
          .getElementById("menuToggle")
          ?.addEventListener("click", toggleSidebar);
        document
          .getElementById("sidebarOverlay")
          ?.addEventListener("click", closeSidebar);

        // Keyboard shortcuts
        document.addEventListener("keydown", handleKeyboardShortcuts);

        // Window resize handler
        window.addEventListener("resize", handleWindowResize);

        // Content interaction tracking
        document.getElementById("contentBody")?.addEventListener(
          "scroll",
          debounce(() => {
            trackUserInteraction();
          }, 1000)
        );
      }

      // Keyboard Shortcuts
      function handleKeyboardShortcuts(e) {
        if (document.querySelector(".quiz-question.active")) return;

        if (e.key === "ArrowLeft" && e.ctrlKey) {
          e.preventDefault();
          goToPreviousLesson();
        } else if (e.key === "ArrowRight" && e.ctrlKey) {
          e.preventDefault();
          goToNextLesson();
        }
      }

      // Window Resize Handler
      function handleWindowResize() {
        if (window.innerWidth > 768) {
          closeSidebar();
        }
      }

      // Debounce Helper
      function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
          const later = () => {
            clearTimeout(timeout);
            func(...args);
          };
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);
        };
      }

      // Initialize responsive behavior
      if (window.innerWidth <= 768) {
        document.getElementById("menuToggle").style.display = "inline-flex";
      }

      // Auto-save progress periodically
      setInterval(async () => {
        if (currentUser && Object.keys(courseProgress).length > 0) {
          await saveProgress();
        }
      }, 60000); // Save every minute

      // System initialization logging
      console.log("CyberSec Academy Course System Initialized");
      console.log("Current Course:", COURSE_DATA.title);
      console.log("Total Lessons:", COURSE_DATA.lessons.length);

      // Google OAuth Integration
      const googleBtn = document.querySelector(".btn-google");
      if (googleBtn) {
        googleBtn.addEventListener("click", async () => {
          const { data, error } = await supabase.auth.signInWithOAuth({
            provider: "google",
            options: {
              redirectTo:
                window.location.origin +
                "/courses/digital-forensics-introduction",
            },
          });

          if (error) {
            console.error("Google login error:", error.message);
            showToast("Google login failed: " + error.message, "error");
          }
        });
      }

      // Check for existing session
      supabase.auth.getSession().then(({ data }) => {
        if (data.session) {
          console.log("User already logged in:", data.session.user);
          currentUser = data.session.user;
          startCourseSession();
        }
      });

      // Add missing auth modal functions
      function openAuthModal() {
        const modal = document.getElementById("authModal");
        if (modal) {
          modal.style.display = "flex";
        }
      }

      function closeAuthModal() {
        const modal = document.getElementById("authModal");
        if (modal) {
          modal.style.display = "none";
        }
      }

      // Add auth tab switching functionality
      document.getElementById("tabSignIn")?.addEventListener("click", () => {
        document.getElementById("tabSignIn").classList.add("active");
        document.getElementById("tabSignUp").classList.remove("active");
        document.getElementById("signInForm").style.display = "block";
        document.getElementById("signUpForm").style.display = "none";
      });

      document.getElementById("tabSignUp")?.addEventListener("click", () => {
        document.getElementById("tabSignUp").classList.add("active");
        document.getElementById("tabSignIn").classList.remove("active");
        document.getElementById("signUpForm").style.display = "block";
        document.getElementById("signInForm").style.display = "none";
      });

      document
        .getElementById("closeAuthModal")
        ?.addEventListener("click", closeAuthModal);

      // Improved error handling for auth session
      supabase.auth.onAuthStateChange((event, session) => {
        if (event === "SIGNED_IN") {
          currentUser = session.user;
          closeAuthModal();
          startCourseSession();
        } else if (event === "SIGNED_OUT") {
          currentUser = null;
          openAuthModal();
        }
      });

      // Add form submission handlers
      document
        .getElementById("emailSignInForm")
        ?.addEventListener("submit", async (e) => {
          e.preventDefault();
          const email = document.getElementById("signInEmail").value;
          const password = document.getElementById("signInPassword").value;

          try {
            const { data, error } = await supabase.auth.signInWithPassword({
              email,
              password,
            });

            if (error) throw error;

            closeAuthModal();
          } catch (error) {
            showToast(error.message, "error");
          }
        });

      document
        .getElementById("emailSignUpForm")
        ?.addEventListener("submit", async (e) => {
          e.preventDefault();
          const email = document.getElementById("signUpEmail").value;
          const password = document.getElementById("signUpPassword").value;
          const name = document.getElementById("signUpName").value;

          try {
            const { data, error } = await supabase.auth.signUp({
              email,
              password,
              options: {
                data: {
                  full_name: name,
                },
              },
            });

            if (error) throw error;

            showToast(
              "Account created successfully! Please check your email.",
              "success"
            );
          } catch (error) {
            showToast(error.message, "error");
          }
        });
    </script>
  </body>
</html>

