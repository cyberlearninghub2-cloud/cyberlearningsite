




<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Exo+2:wght@700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.7/dist/umd/supabase.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css">
    <link rel="stylesheet" href="assets/css/coursepages.css">

    <!-- ========== Start: SEO & Schema Enhancement ========== -->
    <title>Linux Command Line Basics Course | CipherHall</title>
    <meta name="description" content="Master the Linux terminal with our free, hands-on course. Learn file operations, scripting, user management, and essential networking commands.">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon.png" />
    <link rel="shortcut icon" href="/favicon.png" type="image/x-icon" />
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon.png" />
    <link rel="canonical" href="https://www.cipherhall.com/courses/linux-command-line-basics.html" />

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Course",
      "name": "Linux Command Line Basics",
      "description": "Master the Linux terminal for system administration, scripting, and networking. A foundational course for any aspiring cybersecurity professional.",
      "provider": {
        "@type": "Organization",
        "name": "CipherHall",
        "sameAs": "https://www.cipherhall.com"
      },
      "hasCourseInstance": {
        "@type": "CourseInstance",
        "courseMode": "Online",
        "instructor": {
          "@type": "Person",
          "name": "Jasmine 'Bash' Lee"
        }
      }
    }
    </script>
    <!-- ========== End: SEO & Schema Enhancement ========== -->
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loader-icon">
            <i class="fas fa-graduation-cap"></i>
        </div>
        <div class="loader-text">Loading Course Content...</div>
    </div>
    
    <!-- Sidebar Overlay for Mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    
    <!-- Music Player (fixed at top right) -->
    <div class="header-controls">
        <div class="music-dropdown" id="music-dropdown">
            <button class="btn btn-secondary">
                <span id="music-button-text">STUDY MUSIC</span>
                <i id="music-icon" class="fa-solid fa-music"></i>
            </button>
            <div class="music-dropdown-content" id="music-dropdown-content">
                <a href="#" data-src="https://www.learningcontainer.com/wp-content/uploads/2020/02/Kalimba.mp3">1. Coffee Shop Vibes</a>
                <a href="#" data-src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-16.mp3">2. City Lights Lofi</a>
                <a href="#" data-src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-15.mp3">3. Mellow Thoughts</a>
                <a href="#" data-src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-13.mp3">4. Rainy Mood</a>
                <a href="#" data-src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-10.mp3">5. Time Alone</a>
                <a href="#" id="stop-music-link"><i class="fa-solid fa-stop-circle"></i> Stop Music</a>
            </div>
        </div>
        
        <button class="btn btn-secondary" id="resetProgressBtn">
            <i class="fas fa-redo"></i>
            Reset Progress
        </button>
    </div>

    <!-- Auth Modal -->
    <div id="authModal" class="modal" style="display: none">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <span class="close" id="closeAuthModal">&times;</span>
            <div class="auth-tabs">
                <button id="tabSignIn" class="auth-tab active">Sign In</button>
                <button id="tabSignUp" class="auth-tab">Sign Up</button>
            </div>
            <div id="authLoader" style="display: none; text-align: center; padding: 2rem">
                <i class="fas fa-spinner fa-spin fa-2x" style="color: var(--color-green)"></i>
                <p style="margin-top: 0.5rem">Authenticating...</p>
            </div>
            <div id="signInForm" class="auth-form">
                <h2>Sign In to CipherHall</h2>
                <button id="googleSignIn" class="btn btn-google">
                    <i class="fab fa-google"></i> Continue with Google
                </button>
                <div class="divider"><span>or</span></div>
                <form id="emailSignInForm">
                    <input type="email" id="signInEmail" placeholder="Email Address" required>
                    <input type="password" id="signInPassword" placeholder="Password" required>
                    <button type="submit" class="btn btn-primary">Sign In</button>
                </form>
            </div>
            <div id="signUpForm" class="auth-form" style="display: none">
                <h2>Join CipherHall</h2>
                <button id="googleSignUp" class="btn btn-google">
                    <i class="fab fa-google"></i> Continue with Google
                </button>
                <div class="divider"><span>or</span></div>
                <form id="emailSignUpForm">
                    <input type="text" id="signUpName" placeholder="Full Name" required>
                    <input type="email" id="signUpEmail" placeholder="Email Address" required>
                    <input type="password" id="signUpPassword" placeholder="Password (min. 8 characters)" required>
                    <button type="submit" class="btn btn-secondary">Create Account</button>
                </form>
            </div>
            <div id="authMessage"></div>
        </div>
    </div>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="course-info">
                <h1 class="course-title" id="courseTitle">Loading...</h1>
                <div class="course-progress">
                    <div class="progress-header">
                        <span class="progress-label">Course Progress</span>
                        <span class="progress-percentage" id="courseProgressPercent">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="courseProgressFill" style="width: 0%"></div>
                    </div>
                    <div class="progress-stats">
                        <span id="completedLessons">0</span>
                        <span id="totalLessons">0</span>
                    </div>
                </div>
                <a href="/dashboard.html" class="back-to-dashboard">
                    <i class="fas fa-arrow-left"></i>
                    Back to Dashboard
                </a>
            </div>
        </div>

        <nav class="lesson-nav" id="lessonNav">
            <!-- Lessons will be loaded dynamically -->
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <header class="content-header">
            <div class="lesson-header">
                <div class="lesson-header-left">
                    <span class="lesson-number" id="currentLessonNumber">1</span>
                    <h1 class="lesson-header-title" id="currentLessonTitle">Loading...</h1>
                </div>
                <div class="lesson-actions">
                    <button class="mbtn btn-primary" id="menuToggle">
                        <i class="fas fa-bars"></i>
                       
                    </button>
                </div>
            </div>
        </header>

        <div class="content-body" id="contentBody">
            <div class="lesson-content" id="lessonContent">
                <!-- Lesson content will be loaded dynamically -->
            </div>
        </div>

        <footer class="lesson-navigation">
            <div class="nav-info" id="navInfo">
                Lesson 1 of 10
            </div>
            <div class="nav-controls">
                <button class="btn btn-secondary" id="prevLessonBtn" disabled>
                    <i class="fas fa-chevron-left"></i>
                    Previous
                </button>
                <button class="btn btn-primary" id="nextLessonBtn" disabled>
                    Next
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </footer>
    </main>

    <!-- Achievement Notification -->
    <div id="achievementNotification" class="achievement-notification">
        <div class="notification-header">
            <div class="notification-icon" id="notificationIcon">
                <i class="fas fa-trophy"></i>
            </div>
            <div class="notification-content">
                <h3 id="notificationTitle">Achievement Unlocked!</h3>
                <p id="notificationDescription">Description here...</p>
            </div>
        </div>
        <div class="notification-reward" id="notificationReward">
            <i class="fas fa-coins"></i>
            <span id="notificationPoints">+100 Points</span>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <span id="toastMessage"></span>
    </div>

    <script>
       // =====================================================
// SYNCHRONIZED COURSE SYSTEM WITH DASHBOARD INTEGRATION
// =====================================================

// Supabase Configuration - Replace with your config
const supabaseUrl = 'https://lzcmzulemfubjaksoqor.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx6Y216dWxlbWZ1Ympha3NvcW9yIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUzMzM5MDgsImV4cCI6MjA3MDkwOTkwOH0.crhPH4YWtRsr1BJTpAQcmPbWSpwIWRbzoI4sRb2_fPI';
const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

// =====================================================
// COURSE DATA STRUCTURE - REPLACE WITH YOUR COURSE JSON
// =====================================================
const COURSE_DATA = {
    "id": "linux-command-line-basics",
    "title": "Linux Command Line Basics",
    "description": "Master the Linux terminal for system administration, scripting, and networking",
    "category": "linux-fundamentals",
    "difficulty": "Beginner to Intermediate",
    "duration": "25 hours",
    "instructor": "Prof. Alex Rodriguez",
    "lessons": [
        {
            "id": "lesson-1",
            "title": "Introduction to Linux",
            "duration": "60 min",
            "objectives": [
                "Understand Linux history and philosophy",
                "Learn about different Linux distributions",
                "Explore the Linux file system hierarchy",
                "Understand open source concepts"
            ],
            "content": {
                "overview": "Welcome to the fascinating world of Linux! This lesson will introduce you to the history, philosophy, and fundamental concepts of Linux operating systems.",
                "sections": [
                    {
                        "title": "What is Linux?",
                        "content": "<p>Linux is a free and open-source operating system kernel originally created by Linus Torvalds in 1991. It forms the foundation for numerous operating systems known as Linux distributions or \"distros.\"</p><h3>Key Characteristics of Linux:</h3><ul><li><strong>Open Source:</strong> Source code is freely available and modifiable</li><li><strong>Multi-user:</strong> Multiple users can work simultaneously</li><li><strong>Multi-tasking:</strong> Can run multiple processes concurrently</li><li><strong>Portable:</strong> Runs on various hardware architectures</li><li><strong>Secure:</strong> Built-in security features and permission systems</li></ul><div class=\"info-box tip\"><div class=\"info-box-header\"><i class=\"fas fa-lightbulb\"></i><strong>Fun Fact</strong></div><p>Linux powers everything from smartphones (Android) to supercomputers, web servers, and even the International Space Station!</p></div>",
                        "image": "https://images.unsplash.com/photo-1629654297299-c8506221ca97?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Popular Linux Distributions",
                        "content": "<p>Linux distributions are complete operating systems built around the Linux kernel. Each distro has its own package manager, default software, and target audience.</p><h3>Major Distribution Families:</h3><ul><li><strong>Debian-based:</strong> Ubuntu, Linux Mint, Pop!_OS, Kali Linux</li><li><strong>Red Hat-based:</strong> RHEL, CentOS, Fedora, Rocky Linux</li><li><strong>Arch-based:</strong> Arch Linux, Manjaro, EndeavourOS</li><li><strong>SUSE-based:</strong> openSUSE, SUSE Linux Enterprise</li><li><strong>Independent:</strong> Slackware, Gentoo, Alpine Linux</li></ul><div class=\"info-box note\"><div class=\"info-box-header\"><i class=\"fas fa-info-circle\"></i><strong>Choosing a Distribution</strong></div><p>For beginners, Ubuntu, Linux Mint, or Pop!_OS are excellent choices due to their user-friendly interfaces and extensive community support.</p></div>",
                        "image": "https://images.unsplash.com/photo-1518432031352-d6fc5c10da5a?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Linux File System Hierarchy",
                        "content": "<p>Linux follows the Filesystem Hierarchy Standard (FHS), which defines the directory structure and directory contents in Linux distributions.</p><h3>Key Directories:</h3><ul><li><strong>/</strong> - Root directory (top of the hierarchy)</li><li><strong>/home</strong> - User home directories</li><li><strong>/etc</strong> - System configuration files</li><li><strong>/var</strong> - Variable data (logs, databases)</li><li><strong>/usr</strong> - User programs and data</li><li><strong>/bin</strong> - Essential system binaries</li><li><strong>/sbin</strong> - System administration binaries</li><li><strong>/tmp</strong> - Temporary files</li><li><strong>/dev</strong> - Device files</li><li><strong>/proc</strong> - Virtual filesystem (process information)</li></ul><div class=\"info-box warning\"><div class=\"info-box-header\"><i class=\"fas fa-exclamation-triangle\"></i><strong>Important Note</strong></div><p>Unlike Windows, Linux uses forward slashes (/) for directory separation, and everything starts from the root directory (/).</p></div>",
                        "image": "https://images.unsplash.com/photo-1558494949-ef010cbdcc31?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Open Source Philosophy",
                        "content": "<p>The open source philosophy is fundamental to understanding Linux and its ecosystem. It's built on principles of collaboration, transparency, and freedom.</p><h3>The Four Essential Freedoms:</h3><ol><li><strong>Freedom 0:</strong> Use the program for any purpose</li><li><strong>Freedom 1:</strong> Study how the program works and modify it</li><li><strong>Freedom 2:</strong> Redistribute copies to help others</li><li><strong>Freedom 3:</strong> Distribute modified versions</li></ol><h3>Benefits of Open Source:</h3><ul><li>Transparency and security through code review</li><li>No vendor lock-in</li><li>Cost-effective solutions</li><li>Rapid innovation through collaboration</li><li>Educational opportunities</li></ul>",
                        "image": "https://images.unsplash.com/photo-1556075798-4825dfaaf498?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Checking Linux System Information",
                        "language": "bash",
                        "code": "# Check Linux distribution\ncat /etc/os-release\n\n# Display kernel version\nuname -a\n\n# Show system hostname\nhostname\n\n# Display current user\nwhoami\n\n# Show system uptime\nuptime\n\n# Display memory information\nfree -h\n\n# Show disk usage\ndf -h"
                    },
                    {
                        "title": "Exploring the File System Structure",
                        "language": "bash",
                        "code": "# List root directory contents\nls -la /\n\n# Show directory tree structure (install tree first: sudo apt install tree)\ntree -L 2 /\n\n# Display current working directory\npwd\n\n# Show file system hierarchy\nls -la /home\nls -la /etc\nls -la /var/log\n\n# Check mounted file systems\nmount | column -t"
                    },
                    {
                        "title": "System Hardware Information",
                        "language": "bash",
                        "code": "# Display CPU information\nlscpu\n\n# Show memory details\ncat /proc/meminfo\n\n# List PCI devices\nlspci\n\n# Show USB devices\nlsusb\n\n# Display block devices\nlsblk\n\n# Show hardware information\nsudo dmidecode -t system"
                    }
                ]
            },
            "quiz": {
                "passingScore": 75,
                "questions": [
                    {"id": 1, "question": "Who originally created the Linux kernel?", "options": ["Richard Stallman", "Linus Torvalds", "Ken Thompson", "Dennis Ritchie"], "correct": 1, "explanation": "Linus Torvalds created the Linux kernel in 1991 while he was a computer science student at the University of Helsinki."},
                    {"id": 2, "question": "Which directory contains user home directories in Linux?", "options": ["/usr", "/var", "/home", "/etc"], "correct": 2, "explanation": "The /home directory contains individual user home directories, such as /home/username."},
                    {"id": 3, "question": "What is the root directory in Linux represented by?", "options": ["~", "/", "\\", "root"], "correct": 1, "explanation": "The root directory is represented by a forward slash (/) and is the top-level directory in the Linux file system hierarchy."},
                    {"id": 4, "question": "Which of the following is NOT a characteristic of Linux?", "options": ["Multi-user", "Open source", "Single-tasking", "Portable"], "correct": 2, "explanation": "Linux is multi-tasking, not single-tasking. It can run multiple processes simultaneously."},
                    {"id": 5, "question": "What does the /etc directory typically contain?", "options": ["User programs", "System configuration files", "Temporary files", "Log files"], "correct": 1, "explanation": "The /etc directory contains system configuration files that control various aspects of the Linux system."},
                    {"id": 6, "question": "Which Linux distribution is known for being beginner-friendly?", "options": ["Arch Linux", "Gentoo", "Ubuntu", "Slackware"], "correct": 2, "explanation": "Ubuntu is widely considered one of the most beginner-friendly Linux distributions due to its user-friendly interface and extensive documentation."},
                    {"id": 7, "question": "What command shows the current Linux kernel version?", "options": ["version -k", "uname -a", "kernel --version", "linux -v"], "correct": 1, "explanation": "The 'uname -a' command displays detailed system information including the kernel version, hostname, and architecture."}
                ]
            }
        },
        {
            "id": "lesson-2",
            "title": "Getting Started with Terminal",
            "duration": "75 min",
            "objectives": [
                "Understand different shell types and their features",
                "Learn command structure and syntax",
                "Master command options and arguments",
                "Navigate terminal efficiently"
            ],
            "content": {
                "overview": "The terminal is your gateway to the power of Linux. Learn how to use different shells effectively and understand command structure for efficient system interaction.",
                "sections": [
                    {
                        "title": "Understanding Shells",
                        "content": "<p>A shell is a command-line interface that interprets and executes commands. It acts as an intermediary between you and the Linux kernel.</p><h3>Popular Linux Shells:</h3><ul><li><strong>Bash (Bourne Again Shell):</strong> Most common default shell</li><li><strong>Zsh (Z Shell):</strong> Advanced features, better customization</li><li><strong>Fish (Friendly Interactive Shell):</strong> User-friendly with syntax highlighting</li><li><strong>Dash:</strong> Lightweight, POSIX-compliant</li><li><strong>Tcsh:</strong> Enhanced C shell</li></ul><h3>Shell Features:</h3><ul><li>Command history and editing</li><li>Tab completion</li><li>Job control</li><li>Scripting capabilities</li><li>Environment variable management</li></ul><div class=\"info-box tip\"><div class=\"info-box-header\"><i class=\"fas fa-lightbulb\"></i><strong>Shell Prompt</strong></div><p>The shell prompt typically shows: username@hostname:current_directory$ (for regular users) or # (for root users).</p></div>",
                        "image": "https://images.unsplash.com/photo-1629654297299-c8506221ca97?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Command Structure and Syntax",
                        "content": "<p>Linux commands follow a consistent structure that makes them predictable and powerful once you understand the pattern.</p><h3>Basic Command Structure:</h3><code>command [options] [arguments]</code><h3>Examples:</h3><ul><li><code>ls</code> - List directory contents</li><li><code>ls -l</code> - List with detailed information (option)</li><li><code>ls -l /home</code> - List /home directory with details</li><li><code>cp file1.txt file2.txt</code> - Copy file1.txt to file2.txt</li></ul><h3>Types of Options:</h3><ul><li><strong>Short options:</strong> -l, -a, -h (can be combined: -lah)</li><li><strong>Long options:</strong> --help, --version, --recursive</li></ul><div class=\"info-box note\"><div class=\"info-box-header\"><i class=\"fas fa-info-circle\"></i><strong>Getting Help</strong></div><p>Use 'man command' for detailed manual pages, 'command --help' for quick help, or 'info command' for comprehensive documentation.</p></div>",
                        "image": "https://images.unsplash.com/photo-1555949963-aa79dcee981c?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Terminal Navigation and Shortcuts",
                        "content": "<p>Mastering keyboard shortcuts and navigation techniques will dramatically improve your terminal productivity.</p><h3>Essential Keyboard Shortcuts:</h3><ul><li><strong>Ctrl + C:</strong> Interrupt/cancel current command</li><li><strong>Ctrl + Z:</strong> Suspend current process</li><li><strong>Ctrl + D:</strong> Exit current shell or send EOF</li><li><strong>Ctrl + L:</strong> Clear screen</li><li><strong>Ctrl + A:</strong> Move cursor to beginning of line</li><li><strong>Ctrl + E:</strong> Move cursor to end of line</li><li><strong>Ctrl + U:</strong> Delete from cursor to beginning</li><li><strong>Ctrl + K:</strong> Delete from cursor to end</li></ul><h3>History Navigation:</h3><ul><li><strong>Up/Down arrows:</strong> Navigate command history</li><li><strong>Ctrl + R:</strong> Reverse search through history</li><li><strong>history:</strong> Display command history</li><li><strong>!!:</strong> Repeat last command</li><li><strong>!n:</strong> Run command number n from history</li></ul>",
                        "image": "https://images.unsplash.com/photo-1587620962725-abab7fe55159?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Tab Completion and Wildcards",
                        "content": "<p>Tab completion and wildcards are powerful features that save time and reduce typing errors.</p><h3>Tab Completion:</h3><ul><li>Press Tab to auto-complete commands, filenames, and paths</li><li>Double-tap Tab to show all possible completions</li><li>Works for commands, file names, directory names, and variables</li></ul><h3>Wildcard Characters:</h3><ul><li><strong>*</strong> - Matches zero or more characters</li><li><strong>?</strong> - Matches exactly one character</li><li><strong>[...]</strong> - Matches any character in brackets</li><li><strong>{...}</strong> - Brace expansion for multiple patterns</li></ul><h3>Wildcard Examples:</h3><ul><li><code>ls *.txt</code> - List all .txt files</li><li><code>ls file?.txt</code> - Match file1.txt, fileA.txt, etc.</li><li><code>ls [abc]*</code> - Files starting with a, b, or c</li><li><code>ls {*.txt,*.pdf}</code> - All .txt and .pdf files</li></ul>",
                        "image": "https://images.unsplash.com/photo-1515879218367-8466d910aaa4?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Basic Shell Commands and Information",
                        "language": "bash",
                        "code": "# Check current shell\necho $SHELL\n\n# List available shells\ncat /etc/shells\n\n# Change shell (requires logout/login)\nchsh -s /bin/zsh\n\n# Display shell prompt variables\necho $PS1\n\n# Show environment variables\nenv | head -10\n\n# Check bash version\nbash --version"
                    },
                    {
                        "title": "Command Structure Examples",
                        "language": "bash",
                        "code": "# Simple command\ndate\n\n# Command with options\nls -la\n\n# Command with arguments\nmkdir new_directory\n\n# Command with options and arguments\ncp -r source_dir destination_dir\n\n# Multiple options (combined)\nls -lah /home\n\n# Long format options\nls --all --human-readable --long\n\n# Command with multiple arguments\ntouch file1.txt file2.txt file3.txt"
                    },
                    {
                        "title": "Getting Help and Documentation",
                        "language": "bash",
                        "code": "# Manual pages\nman ls\nman cp\nman bash\n\n# Quick help\nls --help\ncp --help\n\n# Info documentation\ninfo coreutils\n\n# Which command shows command location\nwhich ls\nwhich python3\n\n# Type command shows command type\ntype ls\ntype cd\n\n# Apropos searches man pages\napropos copy"
                    },
                    {
                        "title": "History and Shortcuts Demo",
                        "language": "bash",
                        "code": "# View command history\nhistory\n\n# Run last command\n!!\n\n# Run command from history by number\n!150\n\n# Search history (Ctrl+R in interactive mode)\nhistory | grep \"ls\"\n\n# Clear history\nhistory -c\n\n# Save current session history\nhistory -w\n\n# Set history size\nexport HISTSIZE=1000\nexport HISTFILESIZE=2000"
                    },
                    {
                        "title": "Wildcard Pattern Examples",
                        "language": "bash",
                        "code": "# Create test files for demonstration\ntouch file1.txt file2.txt document.pdf script.sh backup.txt\n\n# Match all .txt files\nls *.txt\n\n# Match single character\nls file?.txt\n\n# Match character ranges\nls [fd]*\n\n# Exclude patterns\nls [!b]*\n\n# Brace expansion\nls {*.txt,*.pdf,*.sh}\n\n# Complex patterns\nfind . -name \"*.{txt,pdf}\" -type f"
                    }
                ]
            },
            "quiz": {
                "passingScore": 75,
                "questions": [
                    {"id": 1, "question": "What is the most common default shell in Linux systems?", "options": ["Zsh", "Fish", "Bash", "Tcsh"], "correct": 2, "explanation": "Bash (Bourne Again Shell) is the most common default shell in Linux distributions."},
                    {"id": 2, "question": "Which keyboard shortcut clears the terminal screen?", "options": ["Ctrl + C", "Ctrl + L", "Ctrl + Z", "Ctrl + D"], "correct": 1, "explanation": "Ctrl + L clears the terminal screen, similar to running the 'clear' command."},
                    {"id": 3, "question": "What does the wildcard character '*' represent?", "options": ["Exactly one character", "Zero or more characters", "Any digit", "Beginning of line"], "correct": 1, "explanation": "The asterisk (*) wildcard matches zero or more characters in filename patterns."},
                    {"id": 4, "question": "How do you repeat the last executed command?", "options": ["!1", "!!", "!last", "repeat"], "correct": 1, "explanation": "The double exclamation mark (!!) repeats the last executed command."},
                    {"id": 5, "question": "Which command shows the manual page for a command?", "options": ["help command", "manual command", "man command", "doc command"], "correct": 2, "explanation": "The 'man' command displays the manual pages for other commands, e.g., 'man ls'."},
                    {"id": 6, "question": "What is the correct basic structure of a Linux command?", "options": ["arguments command options", "command [options] [arguments]", "options command arguments", "command arguments options"], "correct": 1, "explanation": "Linux commands follow the structure: command [options] [arguments], where options and arguments are optional."},
                    {"id": 7, "question": "Which shortcut moves the cursor to the beginning of the command line?", "options": ["Ctrl + A", "Ctrl + E", "Ctrl + B", "Ctrl + F"], "correct": 0, "explanation": "Ctrl + A moves the cursor to the beginning of the command line, while Ctrl + E moves it to the end."},
                    {"id": 8, "question": "What does 'ls *.txt' command do?", "options": ["Lists all files", "Lists all .txt files in current directory", "Creates .txt files", "Deletes .txt files"], "correct": 1, "explanation": "The command 'ls *.txt' lists all files with .txt extension in the current directory using wildcard matching."}
                ]
            }
        },
        {
            "id": "lesson-3",
            "title": "Navigating the File System",
            "duration": "60 min",
            "objectives": [
                "Determine your current location with 'pwd'",
                "List directory contents effectively with 'ls'",
                "Change directories using 'cd'",
                "Understand the difference between absolute and relative paths"
            ],
            "content": {
                "overview": "Learn the essential commands for moving around the Linux file system. Mastering navigation is a fundamental skill for any command-line user.",
                "sections": [
                    {
                        "title": "Finding Your Way: pwd",
                        "content": "<p>The <code>pwd</code> (print working directory) command is your GPS in the Linux terminal. It tells you exactly where you are in the file system hierarchy.</p><div class=\"info-box tip\"><div class=\"info-box-header\"><i class=\"fas fa-lightbulb\"></i><strong>Key Point</strong></div><p>Always use <code>pwd</code> if you're unsure of your current location before performing file operations.</p></div>",
                        "image": "https://images.unsplash.com/photo-1589998059171-988d887df646?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Listing Contents: ls",
                        "content": "<p>The <code>ls</code> command lists the files and directories in the current location. It has many powerful options:</p><ul><li><code>-l</code>: Long format, showing permissions, owner, size, and modification date.</li><li><code>-a</code>: Shows all files, including hidden ones (those starting with a dot).</li><li><code>-h</code>: Human-readable sizes (e.g., KB, MB, GB).</li><li><code>-t</code>: Sorts by modification time, newest first.</li></ul><p>These can be combined, for example: <code>ls -lah</code>.</p>",
                        "image": "https://images.unsplash.com/photo-1506784983877-45594efa4cbe?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Changing Directories: cd",
                        "content": "<p>The <code>cd</code> (change directory) command is used to move between directories.</p><h3>Special Directories:</h3><ul><li><code>cd /</code>: Go to the root directory.</li><li><code>cd ~</code> or just <code>cd</code>: Go to your home directory.</li><li><code>cd ..</code>: Go up one directory level.</li><li><code>cd .</code>: Refers to the current directory.</li><li><code>cd -</code>: Go to the previous directory you were in.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1484480974693-6ca0a78fb36b?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Absolute vs. Relative Paths",
                        "content": "<p>Understanding paths is crucial for navigation.</p><ul><li><strong>Absolute Path:</strong> Starts from the root directory (<code>/</code>). It's a complete, unambiguous path. Example: <code>/home/alex/documents/report.txt</code>.</li><li><strong>Relative Path:</strong> Starts from your current directory. It's a path relative to your current location. Example: If you are in <code>/home/alex</code>, the relative path to the same file is <code>documents/report.txt</code>.</li></ul><div class=\"info-box warning\"><div class=\"info-box-header\"><i class=\"fas fa-exclamation-triangle\"></i><strong>Best Practice</strong></div><p>Use relative paths for short distances and absolute paths when you need to be certain, especially in scripts.</p></div>"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Basic Navigation Commands",
                        "language": "bash",
                        "code": "# Print the current directory\npwd\n\n# Change to the /var/log directory\ncd /var/log\n\n# Verify your new location\npwd\n\n# List contents in long format\nls -l\n\n# Go back to your home directory\ncd ~\n\n# Verify you are home\npwd"
                    },
                    {
                        "title": "Using Special Directory Notations",
                        "language": "bash",
                        "code": "# Go to /etc\ncd /etc\n\n# Now go to the parent directory (/)\ncd ..\npwd\n\n# Go back to /etc\ncd -\npwd\n\n# Go home\ncd\npwd"
                    }
                ]
            },
            "quiz": {
                "passingScore": 75,
                "questions": [
                    {"id": 1, "question": "Which command shows your current directory?", "options": ["whereami", "location", "pwd", "cd"], "correct": 2, "explanation": "The 'pwd' (print working directory) command displays the full path of your current location."},
                    {"id": 2, "question": "How do you navigate to the parent directory of your current location?", "options": ["cd /", "cd ~", "cd ..", "cd ."], "correct": 2, "explanation": "The 'cd ..' command moves you one level up in the directory hierarchy."},
                    {"id": 3, "question": "What is an absolute path?", "options": ["A path relative to the home directory", "A path that always starts from the root directory (/)", "A path that uses wildcards", "The shortest path to a file"], "correct": 1, "explanation": "An absolute path is a complete path that starts from the topmost directory, the root (/)."},
                    {"id": 4, "question": "Which 'ls' option will show hidden files?", "options": ["-h", "-l", "-a", "-t"], "correct": 2, "explanation": "The '-a' option for 'ls' stands for 'all' and includes files and directories whose names begin with a dot (.)."}
                ]
            }
        },
        {
            "id": "lesson-4",
            "title": "File Operations",
            "duration": "90 min",
            "objectives": [
                "Create, copy, move, and rename files",
                "Safely remove files",
                "View file contents using various tools"
            ],
            "content": {
                "overview": "Files are the core of any operating system. This lesson covers the essential commands for managing files: creating, copying, moving, deleting, and viewing them.",
                "sections": [
                    {
                        "title": "Creating Files: touch",
                        "content": "<p>The <code>touch</code> command is the quickest way to create an empty file. It can also be used to update a file's timestamp.</p><p>Example: <code>touch report.txt</code></p>"
                    },
                    {
                        "title": "Copying Files: cp",
                        "content": "<p>Use the <code>cp</code> command to copy files or directories.</p><p>Syntax: <code>cp [options] source destination</code></p><h3>Common Options:</h3><ul><li><code>-r</code>: Recursive, used for copying directories.</li><li><code>-v</code>: Verbose, shows the progress of the copy.</li></ul><p>Example: <code>cp report.txt backup/report_backup.txt</code></p>"
                    },
                    {
                        "title": "Moving and Renaming: mv",
                        "content": "<p>The <code>mv</code> command is used for both moving and renaming files.</p><p><strong>To Move:</strong> <code>mv file.txt /new/directory/</code></p><p><strong>To Rename:</strong> <code>mv old_name.txt new_name.txt</code></p><div class=\"info-box tip\"><div class=\"info-box-header\"><i class=\"fas fa-lightbulb\"></i><strong>Key Concept</strong></div><p>Renaming a file is simply moving it to the same directory but with a new name.</p></div>"
                    },
                    {
                        "title": "Removing Files: rm",
                        "content": "<p>The <code>rm</code> (remove) command deletes files permanently. Be careful with this command!</p><h3>Common Options:</h3><ul><li><code>-i</code>: Interactive, prompts for confirmation before deleting.</li><li><code>-r</code>: Recursive, for deleting directories and their contents.</li><li><code>-f</code>: Force, overrides prompts (use with extreme caution).</li></ul><div class=\"info-box warning\"><div class=\"info-box-header\"><i class=\"fas fa-exclamation-triangle\"></i><strong>Warning!</strong></div><p>There is no 'Recycle Bin' in the Linux command line. Once a file is deleted with <code>rm</code>, it is gone for good.</p></div>"
                    },
                    {
                        "title": "Viewing Files: cat, less, more, head, tail",
                        "content": "<p>There are several ways to view file contents:</p><ul><li><code>cat</code>: Concatenates and displays entire files. Best for short files.</li><li><code>less</code>: Lets you view a file page by page, allowing you to scroll up and down. The best general-purpose viewer.</li><li><code>more</code>: Similar to <code>less</code>, but with limited functionality (can't scroll backward easily).</li><li><code>head</code>: Shows the first few lines of a file (10 by default).</li><li><code>tail</code>: Shows the last few lines of a file. Use <code>tail -f</code> to watch a file for changes in real-time (great for logs).</li></ul>"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "File Creation and Manipulation",
                        "language": "bash",
                        "code": "# Create a new empty file\ntouch notes.txt\n\n# Create a backup copy\ncp notes.txt notes.bak\n\n# Rename the original file\nmv notes.txt important_notes.txt\n\n# Create a directory for backups\nmkdir backups\n\n# Move the backup file into the directory\nmv notes.bak backups/"
                    },
                    {
                        "title": "Viewing File Contents",
                        "language": "bash",
                        "code": "# Display the entire content of a system file\ncat /etc/passwd\n\n# View a log file interactively\nless /var/log/syslog\n\n# Show the first 5 lines of the file\nhead -n 5 /etc/passwd\n\n# Show the last 5 lines of the file\ntail -n 5 /etc/passwd\n\n# Watch a log file for new entries (press Ctrl+C to exit)\nsudo tail -f /var/log/syslog"
                    }
                ]
            },
            "quiz": {
                "passingScore": 75,
                "questions": [
                    {"id": 1, "question": "Which command is used to rename a file?", "options": ["rename", "mv", "cp", "rn"], "correct": 1, "explanation": "The 'mv' command is used to both move and rename files. Renaming is moving a file to the same location with a different name."},
                    {"id": 2, "question": "What is the safest way to remove a file if you are unsure?", "options": ["rm -f file.txt", "rm -r file.txt", "rm -i file.txt", "del file.txt"], "correct": 2, "explanation": "The '-i' (interactive) option prompts for confirmation before every removal, making it the safest choice."},
                    {"id": 3, "question": "You want to view a large log file. Which command is most suitable?", "options": ["cat", "less", "head", "echo"], "correct": 1, "explanation": "'less' allows you to scroll forward and backward through a file, making it ideal for large files."},
                    {"id": 4, "question": "What does the command 'cp -r documents/ backups/' do?", "options": ["Copies a file named 'documents' to 'backups'", "Renames 'documents' to 'backups'", "Recursively copies the 'documents' directory to 'backups'", "Compares the contents of 'documents' and 'backups'"], "correct": 2, "explanation": "The '-r' option stands for 'recursive', which is necessary to copy a directory and all of its contents."}
                ]
            }
        },
        {
            "id": "lesson-5",
            "title": "Working with Directories",
            "duration": "45 min",
            "objectives": [
                "Create single and nested directories",
                "Remove empty and non-empty directories",
                "Visualize directory structures"
            ],
            "content": {
                "overview": "Organizing files into directories is key to maintaining a clean system. This lesson focuses on the commands for creating and removing directories.",
                "sections": [
                    {
                        "title": "Making Directories: mkdir",
                        "content": "<p>The <code>mkdir</code> command creates new directories.</p><p>Syntax: <code>mkdir [options] directory_name</code></p><h3>Creating Nested Directories:</h3><p>To create a full path of directories at once, use the <code>-p</code> (parents) option.</p><p>Example: <code>mkdir -p project/src/components</code> will create 'project', 'src', and 'components' if they don't exist.</p>"
                    },
                    {
                        "title": "Removing Directories: rmdir and rm -r",
                        "content": "<p>There are two ways to remove directories:</p><ul><li><code>rmdir</code>: Removes <strong>only empty</strong> directories. It's a safe command that will fail if the directory contains any files or other directories.</li><li><code>rm -r</code>: Recursively removes a directory and <strong>all of its contents</strong>. This is powerful and potentially destructive. Always double-check your command before executing.</li></ul><div class=\"info-box warning\"><div class=\"info-box-header\"><i class=\"fas fa-exclamation-triangle\"></i><strong>Caution!</strong></div><p><code>rm -r</code> is permanent. Be very careful when using it, especially with paths like <code>/</code> or your home directory.</p></div>"
                    },
                    {
                        "title": "Visualizing Structures: tree",
                        "content": "<p>The <code>tree</code> command displays the contents of a directory in a tree-like format, which is excellent for visualizing the structure.</p><p>You may need to install it first: <code>sudo apt install tree</code> (for Debian/Ubuntu).</p>"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Directory Management",
                        "language": "bash",
                        "code": "# Create a new directory\nmkdir reports\n\n# Create a nested directory structure\nmkdir -p project/assets/images\n\n# Create an empty directory to be removed\nmkdir temp_folder\n\n# Remove the empty directory\nrmdir temp_folder\n\n# Remove the entire project directory (use with caution!)\nrm -r project"
                    },
                    {
                        "title": "Using the 'tree' Command",
                        "language": "bash",
                        "code": "# First, create a sample structure\nmkdir -p my_app/{src,dist,tests}\ntouch my_app/src/main.js\ntouch my_app/dist/bundle.js\n\n# Now, visualize it with tree\ntree my_app"
                    }
                ]
            },
            "quiz": {
                "passingScore": 75,
                "questions": [
                    {"id": 1, "question": "Which command creates a directory and its parent directories if they don't exist?", "options": ["mkdir -a", "mkdir --all", "mkdir -p", "mkdir -c"], "correct": 2, "explanation": "The '-p' or '--parents' option allows 'mkdir' to create the entire directory path."},
                    {"id": 2, "question": "You try to use 'rmdir my_stuff' and it fails. What is the most likely reason?", "options": ["You don't have permission", "The directory is not empty", "The directory is hidden", "rmdir is not a valid command"], "correct": 1, "explanation": "'rmdir' can only remove directories that are completely empty."},
                    {"id": 3, "question": "What is the command to delete a directory named 'old_project' and all the files inside it?", "options": ["rmdir old_project", "del old_project", "rm -r old_project", "rm old_project"], "correct": 2, "explanation": "'rm -r' recursively deletes a directory and its contents. This command is permanent and should be used with care."}
                ]
            }
        },
        {
            "id": "lesson-6",
            "title": "Viewing & Editing Files",
            "duration": "75 min",
            "objectives": [
                "Understand the concept of terminal-based text editors",
                "Learn the basics of editing files with 'nano'",
                "Get an introduction to the power of 'vim'"
            ],
            "content": {
                "overview": "Viewing files is one thing, but editing them is where the real work happens. This lesson introduces you to the most common command-line text editors.",
                "sections": [
                    {
                        "title": "Beginner-Friendly Editing: nano",
                        "content": "<p><code>nano</code> is a simple, intuitive, and easy-to-use text editor. It's perfect for beginners.</p><p>To open a file, just type <code>nano filename.txt</code>.</p><p>The bottom of the screen always displays the most important commands (e.g., <code>^X</code> means <code>Ctrl+X</code> for Exit). It's a great editor for quick configuration file changes.</p>"
                    },
                    {
                        "title": "The Powerful Editor: vim",
                        "content": "<p><code>vim</code> (Vi IMproved) is an extremely powerful and efficient text editor, but it has a steep learning curve. It is a 'modal' editor, meaning it has different modes of operation.</p><h3>The Two Most Important Modes:</h3><ul><li><strong>Normal Mode:</strong> The default mode. Used for navigation (h, j, k, l keys) and commands (like 'd' for delete, 'y' for yank/copy, 'p' for paste).</li><li><strong>Insert Mode:</strong> Used for typing text. You enter it by pressing 'i' and exit back to Normal mode by pressing 'Esc'.</li></ul><div class=\"info-box tip\"><div class=\"info-box-header\"><i class=\"fas fa-lightbulb\"></i><strong>Getting Started with Vim</strong></div><p>To start, remember: <code>i</code> to insert text, <code>Esc</code> to get back to normal mode, and then type <code>:wq</code> to write (save) and quit.</p></div>"
                    },
                    {
                        "title": "Graphical Editors",
                        "content": "<p>If you're using a desktop version of Linux, you also have access to graphical text editors like <code>gedit</code> (for GNOME) or <code>kate</code> (for KDE). You can launch them from the terminal, but they will open in a separate window.</p><p>Example: <code>gedit my_script.sh &</code> (The <code>&</code> runs it in the background, giving you your terminal back).</p>"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Using nano",
                        "language": "bash",
                        "code": "# Open a new or existing file with nano\nnano my_shopping_list.txt\n\n# Common nano commands (used inside the editor):\n# Ctrl + X : Exit (will prompt to save)\n# Ctrl + O : Write Out (Save)\n# Ctrl + W : Where is (Search)"
                    },
                    {
                        "title": "Using vim",
                        "language": "bash",
                        "code": "# Open a new or existing file with vim\nvim my_config.conf\n\n# Common vim commands (from Normal Mode):\n# i        : Enter Insert Mode\n# Esc      : Return to Normal Mode\n# :wq      : Write (save) and quit\n# :q!      : Quit without saving\n# dd       : Delete the current line\n# /search  : Search for text"
                    }
                ]
            },
            "quiz": {
                "passingScore": 75,
                "questions": [
                    {"id": 1, "question": "Which text editor is generally considered the most beginner-friendly?", "options": ["vim", "emacs", "ed", "nano"], "correct": 3, "explanation": "'nano' is known for its simplicity and on-screen help, making it ideal for beginners."},
                    {"id": 2, "question": "In vim, how do you switch from Insert Mode back to Normal Mode?", "options": ["Ctrl + C", "Shift", "Esc", "Tab"], "correct": 2, "explanation": "The 'Escape' (Esc) key is used to exit the current mode and return to Normal Mode, where you can enter commands."},
                    {"id": 3, "question": "What does the command ':wq' do in vim's Normal Mode?", "options": ["Quit without saving", "Wait and quit", "Write (save) and quit", "Word search and quit"], "correct": 2, "explanation": "':' enters command mode, 'w' stands for write (save), and 'q' stands for quit. So, ':wq' saves the changes and exits the editor."}
                ]
            }
        },
        {
            "id": "lesson-7",
            "title": "File Permissions & Ownership",
            "duration": "90 min",
            "objectives": [
                "Understand the Linux permissions model (read, write, execute)",
                "Change file permissions using 'chmod' in symbolic and octal mode",
                "Change file ownership with 'chown'"
            ],
            "content": {
                "overview": "Linux is a multi-user system, and permissions are at its core, ensuring users can only access and modify the files they are supposed to. This lesson demystifies file permissions.",
                "sections": [
                    {
                        "title": "Reading Permissions",
                        "content": "<p>When you run <code>ls -l</code>, the first column (e.g., <code>-rwxr-xr--</code>) shows the file's permissions.</p><ul><li>The first character is the file type (<code>-</code> for file, <code>d</code> for directory).</li><li>The next 9 characters are three sets of permissions: for the <strong>User</strong> (owner), the <strong>Group</strong>, and <strong>Others</strong>.</li><li>Each set has three permission types: <strong>r</strong> (read), <strong>w</strong> (write), and <strong>x</strong> (execute).</li></ul><p>Example: <code>rwxr-xr--</code> means the owner can read, write, and execute; the group can read and execute; others can only read.</p>"
                    },
                    {
                        "title": "Changing Permissions: chmod",
                        "content": "<p>The <code>chmod</code> (change mode) command modifies permissions. It has two common syntaxes:</p><h3>Symbolic Mode (Easier to read):</h3><ul><li><code>u</code> (user), <code>g</code> (group), <code>o</code> (others), <code>a</code> (all)</li><li><code>+</code> (add), <code>-</code> (remove), <code>=</code> (set exactly)</li><li><code>r</code> (read), <code>w</code> (write), <code>x</code> (execute)</li></ul><p>Example: <code>chmod u+x script.sh</code> adds execute permission for the user.</p><h3>Octal (Numeric) Mode (Faster to type):</h3><p>Permissions are represented by numbers:</p><ul><li>4 = read (r)</li><li>2 = write (w)</li><li>1 = execute (x)</li></ul><p>Add them up for each set (user, group, other). Example: <code>rwx</code> is 4+2+1=<strong>7</strong>. <code>r-x</code> is 4+1=<strong>5</strong>. <code>r--</code> is <strong>4</strong>. So, <code>chmod 754 file.txt</code> sets permissions to <code>rwxr-xr--</code>.</p>"
                    },
                    {
                        "title": "Changing Ownership: chown",
                        "content": "<p>The <code>chown</code> (change owner) command changes who owns a file or directory.</p><p>Syntax: <code>chown new_owner:new_group filename</code></p><p>Example: <code>sudo chown alex:developers config.yml</code> makes the user 'alex' and the group 'developers' the new owners. You usually need <code>sudo</code> to run this command.</p>"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Using Symbolic 'chmod'",
                        "language": "bash",
                        "code": "# Create a script file\ntouch my_script.sh\nls -l my_script.sh\n\n# Add execute permission for the owner (user)\nchmod u+x my_script.sh\nls -l my_script.sh\n\n# Remove write permission for the group and others\nchmod go-w my_script.sh\nls -l my_script.sh\n\n# Set permissions for everyone at once\nchmod a=rwx my_script.sh\nls -l my_script.sh"
                    },
                    {
                        "title": "Using Octal 'chmod' and 'chown'",
                        "language": "bash",
                        "code": "# Set permissions to rwxr-xr-x (common for scripts)\nchmod 755 my_script.sh\n\n# Set permissions to rw-r--r-- (common for files)\nchmod 644 config.txt\n\n# Change the owner of the script to user 'www-data'\nsudo chown www-data my_script.sh\nls -l my_script.sh\n\n# Change both owner and group\nsudo chown www-data:www-data my_script.sh\nls -l my_script.sh"
                    }
                ]
            },
            "quiz": {
                "passingScore": 75,
                "questions": [
                    {"id": 1, "question": "What do the permissions 'rwxr-xr--' mean?", "options": ["Everyone can read, write, and execute", "The owner can read/write, the group can read/execute, others can only read", "The owner can read/write/execute, the group can read/execute, others can only read", "The owner can do anything, others can do nothing"], "correct": 2, "explanation": "The permissions are in sets of three: user (rwx), group (r-x), and others (r--)."},
                    {"id": 2, "question": "Which command makes a script named 'run.sh' executable for the owner?", "options": ["chmod +x run.sh", "chmod u+x run.sh", "chown x run.sh", "executable run.sh"], "correct": 1, "explanation": "'chmod u+x' specifically adds ('+') the execute permission ('x') for the user ('u'). 'chmod +x' would add it for everyone."},
                    {"id": 3, "question": "What is the octal representation for read, write, and execute permissions (rwx)?", "options": ["5", "6", "7", "8"], "correct": 2, "explanation": "The octal value is calculated by adding the values for each permission: read (4) + write (2) + execute (1) = 7."},
                    {"id": 4, "question": "Which command changes the owner of 'file.txt' to 'sara'?", "options": ["chmod sara file.txt", "chown sara file.txt", "user sara file.txt", "owner sara file.txt"], "correct": 1, "explanation": "The 'chown' (change owner) command is used to change the user and/or group ownership of files."}
                ]
            }
        },
        {
            "id": "lesson-8",
            "title": "User & Group Management",
            "duration": "75 min",
            "objectives": [
                "Add and remove users",
                "Set and change user passwords",
                "Understand the purpose of groups and how to manage them",
                "Use 'sudo' to perform administrative tasks"
            ],
            "content": {
                "overview": "Managing users and groups is a fundamental system administration task. This lesson covers how to create user accounts, manage groups, and grant administrative privileges.",
                "sections": [
                    {
                        "title": "Adding and Deleting Users",
                        "content": "<p>User management commands typically require administrative privileges (using <code>sudo</code>).</p><ul><li><code>adduser</code>: A user-friendly, interactive command for creating a new user. It sets up the home directory and prompts for a password. (Recommended)</li><li><code>useradd</code>: A lower-level utility. Creates a user but doesn't set up the password or home directory by default.</li><li><code>deluser</code> or <code>userdel</code>: Commands for deleting a user account.</li></ul>"
                    },
                    {
                        "title": "Managing Passwords",
                        "content": "<p>The <code>passwd</code> command is used to manage passwords.</p><ul><li><code>passwd</code>: Executed by a normal user, it allows them to change their own password.</li><li><code>sudo passwd username</code>: Executed by an administrator, it allows them to change (or set) the password for another user.</li></ul>"
                    },
                    {
                        "title": "Group Management",
                        "content": "<p>Groups are used to organize users and manage permissions for multiple users at once.</p><ul><li><code>groups</code>: Shows which groups you belong to.</li><li><code>groupadd</code>: Creates a new group.</li><li><code>usermod</code>: Modifies a user's properties, including group membership. The <code>-aG</code> options are commonly used to <strong>a</strong>ppend a user to a supplementary <strong>G</strong>roup.</li></ul><p>Example: <code>sudo usermod -aG sudo alex</code> adds the user 'alex' to the 'sudo' group, granting them admin rights.</p>"
                    },
                    {
                        "title": "Executing Commands as an Administrator: sudo",
                        "content": "<p><code>sudo</code> (superuser do) allows a permitted user to execute a command as another user, by default the superuser (root). It is the standard way to perform administrative tasks without logging in as the root user.</p><div class=\"info-box note\"><div class=\"info-box-header\"><i class=\"fas fa-info-circle\"></i><strong>Best Practice</strong></div><p>Always use <code>sudo</code> for individual administrative commands instead of logging in as the root user directly. This improves security and provides an audit trail.</p></div>"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "User Management Commands",
                        "language": "bash",
                        "code": "# Add a new user interactively\nsudo adduser ben\n\n# Change ben's password\nsudo passwd ben\n\n# View your own group memberships\ngroups\n\n# View ben's group memberships\ngroups ben\n\n# Delete the user ben and remove his home directory\nsudo deluser --remove-home ben"
                    },
                    {
                        "title": "Group and Sudo Management",
                        "language": "bash",
                        "code": "# Create a new group called 'developers'\nsudo groupadd developers\n\n# Add user 'ben' to the 'developers' group\nsudo usermod -aG developers ben\n\n# Verify ben is now in the new group\ngroups ben\n\n# Grant ben administrative privileges\nsudo usermod -aG sudo ben # On Debian/Ubuntu\nsudo usermod -aG wheel ben # On RHEL/CentOS"
                    }
                ]
            },
            "quiz": {
                "passingScore": 75,
                "questions": [
                    {"id": 1, "question": "What is the recommended command for interactively adding a new user on Debian/Ubuntu systems?", "options": ["useradd", "adduser", "newuser", "createuser"], "correct": 1, "explanation": "'adduser' is a higher-level script that automates setting the password, creating a home directory, and other user setup tasks."},
                    {"id": 2, "question": "What does 'sudo' stand for?", "options": ["super user do", "substitute user do", "system user do", "secure user do"], "correct": 0, "explanation": "'sudo' stands for 'superuser do', as it allows you to execute commands with the privileges of the superuser (root)."},
                    {"id": 3, "question": "How would you add an existing user 'maria' to a supplementary group named 'editors'?", "options": ["sudo addgroup maria editors", "sudo usermod -g editors maria", "sudo usermod -aG editors maria", "sudo groupmod -a maria editors"], "correct": 2, "explanation": "'usermod -aG' is the correct command to append ('-a') a user to a supplementary group ('-G') without removing them from other groups."},
                    {"id": 4, "question": "Which command lets you change your own password?", "options": ["chpass", "password", "passwd", "setpass"], "correct": 2, "explanation": "The 'passwd' command is used by users to change their own password and by administrators to change any user's password."}
                ]
            }
        },
        {
            "id": "lesson-9",
            "title": "Process Management",
            "duration": "60 min",
            "objectives": [
                "View running processes with 'ps' and 'top'",
                "Understand Process IDs (PIDs)",
                "Terminate processes using 'kill'",
                "Manage background and foreground jobs"
            ],
            "content": {
                "overview": "A process is simply a running program. Learning how to view, manage, and terminate processes is a critical skill for troubleshooting and system administration.",
                "sections": [
                    {
                        "title": "Listing Processes: ps and top",
                        "content": "<ul><li><code>ps</code>: Takes a 'snapshot' of the current processes. A very common usage is <code>ps aux</code>, which shows <strong>a</strong>ll processes for <strong>u</strong>sers in a user-oriented format (<strong>x</strong>).</li><li><code>top</code>: Provides a real-time, interactive view of running processes. It's excellent for seeing what is using the most CPU or memory. Press 'q' to quit.</li></ul>"
                    },
                    {
                        "title": "Terminating Processes: kill",
                        "content": "<p>The <code>kill</code> command sends a signal to a process, which is identified by its Process ID (PID). You can find the PID using <code>ps</code> or <code>top</code>.</p><p>The default signal (<code>-15</code> or <code>SIGTERM</code>) asks the process to terminate gracefully.</p><p>Example: <code>kill 12345</code></p><p>If a process is unresponsive, you can force it to terminate with the <code>SIGKILL</code> signal (<code>-9</code>).</p><p>Example: <code>kill -9 12345</code></p><div class=\"info-box warning\"><div class=\"info-box-header\"><i class=\"fas fa-exclamation-triangle\"></i><strong>Use with Caution</strong></div><p><code>kill -9</code> is a last resort. It doesn't allow the program to clean up after itself, which can lead to data corruption.</p></div>"
                    },
                    {
                        "title": "Job Control: Background and Foreground",
                        "content": "<p>You can run a process in the background by adding an ampersand (<code>&</code>) at the end of the command.</p><p>Example: <code>sleep 300 &</code></p><ul><li><code>jobs</code>: Lists all background jobs.</li><li><code>fg %1</code>: Brings job number 1 to the <strong>f</strong>ore<strong>g</strong>round.</li><li><code>bg %1</code>: Resumes a stopped job in the <strong>b</strong>ack<strong>g</strong>round.</li><li><code>Ctrl+Z</code>: Suspends the current foreground process, allowing you to resume it with <code>fg</code> or <code>bg</code>.</li></ul>"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Viewing and Finding Processes",
                        "language": "bash",
                        "code": "# Get a snapshot of all running processes\nps aux\n\n# Find a specific process (e.g., firefox)\nps aux | grep firefox\n\n# Use top for a live view (press 'q' to exit)\ntop"
                    },
                    {
                        "title": "Job Control and Killing Processes",
                        "language": "bash",
                        "code": "# Run a command in the background\nsleep 60 &\n\n# List background jobs\njobs\n\n# Bring the sleep command to the foreground\nfg %1\n\n# Suspend it with Ctrl+Z\n# (Press Ctrl+Z in your terminal now)\n\n# Now resume it in the background\nbg %1\n\n# Find the PID of the sleep command\npgrep sleep\n\n# Terminate it gracefully (replace PID with actual number)\nkill <PID>\n\n# If it were stuck, force terminate it\n# kill -9 <PID>"
                    }
                ]
            },
            "quiz": {
                "passingScore": 75,
                "questions": [
                    {"id": 1, "question": "Which command provides a real-time, interactive view of your system's processes?", "options": ["ps", "proc", "top", "jobs"], "correct": 2, "explanation": "'top' provides a continuously updated list of processes, CPU usage, and memory usage."},
                    {"id": 2, "question": "You have an unresponsive application. Which is the most forceful way to terminate it?", "options": ["kill -15 <PID>", "kill -9 <PID>", "stop <PID>", "Ctrl+C"], "correct": 1, "explanation": "'kill -9' sends the SIGKILL signal, which cannot be ignored by the process and forces it to terminate immediately."},
                    {"id": 3, "question": "How do you start a command in the background?", "options": ["Add 'bg' before the command", "Add '&' after the command", "Add '--background' to the command", "Press Ctrl+B after starting it"], "correct": 1, "explanation": "Appending an ampersand (&) to a command tells the shell to execute it in the background."},
                    {"id": 4, "question": "What keyboard shortcut is used to suspend the current foreground process?", "options": ["Ctrl+C", "Ctrl+D", "Ctrl+S", "Ctrl+Z"], "correct": 3, "explanation": "Ctrl+C terminates a process, while Ctrl+Z suspends it, allowing you to resume it later with 'fg' or 'bg'."}
                ]
            }
        },
        {
            "id": "lesson-10",
            "title": "Package Management",
            "duration": "90 min",
            "objectives": [
                "Understand the role of package managers and repositories",
                "Install, update, and remove software using 'apt' (Debian/Ubuntu)",
                "Learn the equivalents for 'dnf'/'yum' (Fedora/RHEL)"
            ],
            "content": {
                "overview": "Package managers are one of the most powerful features of Linux, simplifying the process of installing, updating, and removing software. This lesson covers the most common package management tools.",
                "sections": [
                    {
                        "title": "What is a Package Manager?",
                        "content": "<p>A package manager is a tool that automates the process of installing, updating, configuring, and removing software packages. It handles dependencies automatically, meaning if a program you want to install requires another library, the package manager will install it for you.</p><p>Software is stored in central locations called <strong>repositories</strong>.</p>"
                    },
                    {
                        "title": "Debian/Ubuntu: The 'apt' Command",
                        "content": "<p><code>apt</code> (Advanced Package Tool) is the command-line tool used on Debian, Ubuntu, and other derivatives.</p><h3>Most Common 'apt' Commands:</h3><ul><li><code>sudo apt update</code>: Refreshes the local list of available packages from the repositories. <strong>You should always run this before installing or upgrading.</strong></li><li><code>sudo apt upgrade</code>: Upgrades all installed packages to their newest versions.</li><li><code>sudo apt install &lt;package_name&gt;</code>: Installs a new package.</li><li><code>sudo apt remove &lt;package_name&gt;</code>: Uninstalls a package.</li><li><code>apt search &lt;keyword&gt;</code>: Searches for a package in the repositories.</li></ul>"
                    },
                    {
                        "title": "Fedora/RHEL/CentOS: 'dnf' and 'yum'",
                        "content": "<p>On Red Hat-based systems like Fedora, CentOS, and RHEL, the package manager is <code>dnf</code> (Dandified YUM). It replaced the older <code>yum</code>, but the commands are largely the same.</p><h3>Common 'dnf'/'yum' Commands:</h3><ul><li><code>sudo dnf check-update</code>: Checks for available updates.</li><li><code>sudo dnf upgrade</code>: Upgrades all installed packages.</li><li><code>sudo dnf install &lt;package_name&gt;</code>: Installs a new package.</li><li><code>sudo dnf remove &lt;package_name&gt;</code>: Uninstalls a package.</li><li><code>dnf search &lt;keyword&gt;</code>: Searches for a package.</li></ul>"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Using 'apt' on Debian/Ubuntu",
                        "language": "bash",
                        "code": "# First, update your package list\nsudo apt update\n\n# Now, upgrade installed packages\nsudo apt upgrade\n\n# Search for the 'htop' utility\napt search htop\n\n# Install 'htop'\nsudo apt install htop\n\n# Run the newly installed program\nhtop\n\n# Remove 'htop'\nsudo apt remove htop"
                    },
                    {
                        "title": "Using 'dnf' on Fedora/RHEL",
                        "language": "bash",
                        "code": "# Update your system\nsudo dnf upgrade\n\n# Search for the 'htop' utility\ndnf search htop\n\n# Install 'htop'\nsudo dnf install htop\n\n# Remove 'htop'\nsudo dnf remove htop"
                    }
                ]
            },
            "quiz": {
                "passingScore": 75,
                "questions": [
                    {"id": 1, "question": "On an Ubuntu system, what is the first command you should run before installing new software?", "options": ["sudo apt upgrade", "sudo apt install", "sudo apt update", "sudo apt check"], "correct": 2, "explanation": "'sudo apt update' refreshes your local package index, ensuring you have the latest information about available software versions and dependencies."},
                    {"id": 2, "question": "Which command installs the package 'neofetch' on a Debian-based system?", "options": ["sudo apt get neofetch", "sudo apt install neofetch", "sudo apt add neofetch", "sudo apt neofetch"], "correct": 1, "explanation": "The syntax for installing a package with apt is 'sudo apt install <package_name>'."},
                    {"id": 3, "question": "What is the modern equivalent of the 'yum' command on Fedora systems?", "options": ["apt", "pacman", "dnf", "zypper"], "correct": 2, "explanation": "'dnf' (Dandified YUM) is the next-generation package manager for RPM-based distributions, replacing yum."},
                    {"id": 4, "question": "What is a 'repository' in the context of package management?", "options": ["A file on your local system", "A central server that stores software packages", "A type of software license", "A command to view installed packages"], "correct": 1, "explanation": "A repository is a centralized storage location where software packages are kept and from which they can be retrieved and installed."}
                ]
            }
        },
        
    {
        "id": "lesson-11",
        "title": "Disk & File System Management",
        "duration": "90 min",
        "objectives": [
            "Analyze overall disk usage with 'df'",
            "Inspect file and directory sizes with 'du'",
            "Understand block devices and partitions with 'lsblk'",
            "Learn to mount and unmount filesystems"
        ],
        "content": {
            "overview": "Properly managing disk space is a critical skill for any system administrator. This lesson covers the essential tools for monitoring disk usage, analyzing what's taking up space, and managing removable devices and filesystems.",
            "sections": [
                {
                    "title": "Checking Overall Disk Space with 'df'",
                    "content": "<p>The <code>df</code> (disk free) command provides a summary of the total, used, and available disk space on all mounted filesystems.</p><h3>Common 'df' Options:</h3><ul><li><code>-h</code>: Human-readable format (e.g., KB, MB, GB). This is the most common option.</li><li><code>-T</code>: Shows the filesystem type (e.g., ext4, xfs, ntfs).</li><li><code>-i</code>: Displays inode usage instead of block usage.</li></ul><div class=\"info-box tip\"><div class=\"info-box-header\"><i class=\"fas fa-lightbulb\"></i><strong>Key Point</strong></div><p><code>df</code> gives you a high-level overview of your partitions and their capacity. It's the first command to run when you suspect a disk is getting full.</p></div>",
                    "image": "https://images.unsplash.com/photo-1580833246815-c172a15c26e2?w=800&h=400&fit=crop"
                },
                {
                    "title": "Analyzing Directory Sizes with 'du'",
                    "content": "<p>While <code>df</code> shows partition usage, the <code>du</code> (disk usage) command estimates and summarizes file and directory space usage. It's perfect for finding out which specific folders are consuming the most space.</p><h3>Useful 'du' Options:</h3><ul><li><code>-h</code>: Human-readable format.</li><li><code>-s</code>: Summary, displays only the total size for each argument.</li><li><code>-c</code>: Produces a grand total at the end.</li><li><code>--max-depth=N</code>: Displays the total for a directory only if it is N or fewer levels below the command line argument.</li></ul><div class=\"info-box note\"><div class=\"info-box-header\"><i class=\"fas fa-info-circle\"></i><strong>Practical Usage</strong></div><p>A common pattern is <code>du -sh *</code> in a directory like <code>/var/log</code> to see which log file subdirectories are largest.</p></div>",
                    "image": "https://images.unsplash.com/photo-1593349319931-06c15c89a940?w=800&h=400&fit=crop"
                },
                {
                    "title": "Mounting and Unmounting Filesystems",
                    "content": "<p>In Linux, you must <code>mount</code> a filesystem (like a USB drive or a new hard disk partition) to a specific directory (a 'mount point') before you can access its files.</p><h3>Key Commands:</h3><ul><li><code>lsblk</code>: Lists block devices (disks and partitions), which helps you identify the device you want to mount (e.g., <code>/dev/sdb1</code>).</li><li><code>sudo mount /dev/sdb1 /mnt/usb</code>: Mounts the device <code>/dev/sdb1</code> to the directory <code>/mnt/usb</code>. The directory must exist first.</li><li><code>sudo umount /mnt/usb</code>: Safely detaches (unmounts) the filesystem. Always unmount before physically removing a device.</li></ul><div class=\"info-box warning\"><div class=\"info-box-header\"><i class=\"fas fa-exclamation-triangle\"></i><strong>Caution</strong></div><p>Never unplug a mounted device without unmounting it first. This can lead to data corruption as the system may still be writing data to it.</p></div>",
                    "image": "https://images.unsplash.com/photo-1518770660439-4636190af475?w=800&h=400&fit=crop"
                }
            ],
            "codeExamples": [
                {
                    "title": "df Command Examples",
                    "language": "bash",
                    "code": "# Display disk space in human-readable format\ndf -h\n\n# Include filesystem type\ndf -hT\n\n# Exclude temporary filesystems (tmpfs)\ndf -hT -x tmpfs\n\n# Check inode usage\ndf -i\n\n# Show usage for the home directory's partition only\ndf -h /home"
                },
                {
                    "title": "du Command Examples",
                    "language": "bash",
                    "code": "# Show summary of current directory size\ndu -sh\n\n# Show sizes of all files and folders in current directory\ndu -h\n\n# Show sizes of top-level directories in /var\nsudo du -sh /var/*\n\n# Find the top 10 largest directories\nsudo du -h / | sort -rh | head -n 10"
                },
                {
                    "title": "Mounting Workflow Example",
                    "language": "bash",
                    "code": "# 1. List block devices to identify the target partition (e.g., a USB drive)\nlsblk\n\n# 2. Create a mount point directory\nsudo mkdir /media/myusb\n\n# 3. Mount the partition (replace /dev/sdb1 with your actual device)\nsudo mount /dev/sdb1 /media/myusb\n\n# 4. Verify it is mounted\ndf -h\n\n# 5. Access the files\nls /media/myusb\n\n# 6. Unmount when finished\nsudo umount /media/myusb"
                }
            ]
        },
        "quiz": {
            "passingScore": 75,
            "questions": [
                {
                    "id": 1,
                    "question": "Which command is best for getting a quick, high-level overview of all mounted partitions' disk space usage?",
                    "options": ["du -h", "lsblk", "df -h", "mount"],
                    "correct": 2,
                    "explanation": "The 'df -h' command is designed to show disk free space on all mounted filesystems in a human-readable summary format."
                },
                {
                    "id": 2,
                    "question": "You need to find out which subdirectory within `/var/log` is taking up the most space. What is the most effective command?",
                    "options": ["df -h /var/log", "du -sh /var/log/*", "ls -l /var/log", "mount /var/log"],
                    "correct": 1,
                    "explanation": "'du -sh /var/log/*' will calculate and display a human-readable summary of disk usage for each file and directory inside `/var/log`, making it easy to spot the largest ones."
                },
                {
                    "id": 3,
                    "question": "What is the purpose of the 'umount' command?",
                    "options": ["To format a device", "To delete a mount point", "To eject a device from the system", "To safely detach a filesystem from the directory tree"],
                    "correct": 3,
                    "explanation": "The 'umount' command safely detaches the filesystem from its mount point, ensuring all data is written and the device can be safely removed."
                },
                {
                    "id": 4,
                    "question": "Before mounting a new device like `/dev/sdc1` to `/mnt/data`, what must you do first?",
                    "options": ["Run 'umount /mnt/data'", "Ensure the directory `/mnt/data` exists", "Format the device", "Run 'df -h'"],
                    "correct": 1,
                    "explanation": "The mount point, which is the directory where you attach the filesystem, must exist before you can run the `mount` command."
                },
                {
                    "id": 5,
                    "question": "What does the `lsblk` command do?",
                    "options": ["Lists all files in a directory", "Lists all mounted filesystems", "Lists all block devices like disks and partitions", "Lists all system logs"],
                    "correct": 2,
                    "explanation": "`lsblk` stands for 'list block devices' and it shows all available disks, partitions, and their relationships, whether they are mounted or not."
                }
            ]
        }
    },
    {
        "id": "lesson-12",
        "title": "Search & Find Files",
        "duration": "100 min",
        "objectives": [
            "Master the 'find' command for searching by name, type, size, and time",
            "Use 'locate' for rapid, database-driven file searches",
            "Learn to search for text patterns inside files with 'grep'",
            "Understand basic Regular Expressions (Regex) for powerful pattern matching"
        ],
        "content": {
            "overview": "Finding files and searching for content within them are fundamental Linux skills. This lesson introduces three powerful utilities—find, locate, and grep—and the basics of regular expressions, giving you the ability to locate anything on your system.",
            "sections": [
                {
                    "title": "Powerful Searches with 'find'",
                    "content": "<p>The <code>find</code> command is an incredibly powerful and flexible utility for searching for files and directories based on a wide range of criteria.</p><h3>Key 'find' Criteria:</h3><ul><li><code>-name \"pattern\"</code>: Search by filename (use quotes for wildcards like \"*.log\").</li><li><code>-type f</code>: Find only files.</li><li><code>-type d</code>: Find only directories.</li><li><code>-size +100M</code>: Find files larger than 100 Megabytes.</li><li><code>-mtime -7</code>: Find files modified within the last 7 days.</li><li><code>-exec command {} \\;</code>: Execute a command on each found file.</li></ul><div class=\"info-box note\"><div class=\"info-box-header\"><i class=\"fas fa-info-circle\"></i><strong>Syntax</strong></div><p>The basic syntax is <code>find [path] [expression]</code>. For example, <code>find /home/user -name \"*.txt\"</code> searches for .txt files in the user's home directory.</p></div>",
                    "image": "https://images.unsplash.com/photo-1585899981850-8b1b88302f8f?w=800&h=400&fit=crop"
                },
                {
                    "title": "Instant Searches with 'locate'",
                    "content": "<p>The <code>locate</code> command is much faster than <code>find</code> because it searches a pre-built database of all files on the system. However, this means it won't find files created since the last database update.</p><h3>Usage:</h3><ul><li><code>locate httpd.conf</code>: Quickly finds the location of the Apache config file.</li><li><code>sudo updatedb</code>: Manually forces an update of the file database. Most systems do this automatically once a day.</li><li><code>-i</code>: Perform a case-insensitive search.</li></ul><div class=\"info-box tip\"><div class=\"info-box-header\"><i class=\"fas fa-lightbulb\"></i><strong>When to Use 'locate'</strong></div><p>Use <code>locate</code> when you know the name of a file and just need to find its path quickly. Use <code>find</code> when you need to search by criteria other than just the name (like size or modification time).</p></div>",
                    "image": "https://images.unsplash.com/photo-1526628953301-3e589a6a8b74?w=800&h=400&fit=crop"
                },
                {
                    "title": "Searching Inside Files with 'grep'",
                    "content": "<p>The <code>grep</code> (Global Regular Expression Print) command is the go-to tool for searching for text patterns within files.</p><h3>Essential 'grep' Options:</h3><ul><li><code>-i</code>: Case-insensitive search.</li><li><code>-r</code> or <code>-R</code>: Recursive search, looks inside all files in a directory and its subdirectories.</li><li><code>-v</code>: Invert match, shows lines that DO NOT contain the pattern.</li><li><code>-n</code>: Show the line number of the match.</li><li><code>-c</code>: Count the number of matching lines.</li></ul><div class=\"info-box warning\"><div class=\"info-box-header\"><i class=\"fas fa-exclamation-triangle\"></i><strong>Combining with Pipes</strong></div><p><code>grep</code> is extremely powerful when combined with other commands via pipes. For example: <code>ps aux | grep nginx</code> finds running processes related to nginx.</p></div>",
                    "image": "https://images.unsplash.com/photo-1504639725590-771ab665e141?w=800&h=400&fit=crop"
                },
                {
                    "title": "Introduction to Regular Expressions (Regex)",
                    "content": "<p>Regular Expressions are a special sequence of characters that define a search pattern. They provide a way to perform complex and flexible searches that simple text matching cannot.</p><h3>Basic Regex Metacharacters:</h3><ul><li><code>^</code>: Start of a line (e.g., <code>grep '^error' file.log</code>).</li><li><code>$</code>: End of a line.</li><li><code>.</code>: Any single character.</li><li><code>*</code>: Zero or more of the preceding character.</li><li><code>[]</code>: A set of characters to match (e.g., <code>[aeiou]</code> matches any vowel).</li></ul><p>Mastering regex is a skill in itself, but knowing these basics will dramatically enhance your use of <code>grep</code> and other tools.</p>",
                    "image": "https://images.unsplash.com/photo-1555949963-aa79dcee981c?w=800&h=400&fit=crop"
                }
            ],
            "codeExamples": [
                {
                    "title": "Advanced 'find' Command Examples",
                    "language": "bash",
                    "code": "# Find all .conf files in /etc modified in the last 2 days\nfind /etc -name \"*.conf\" -mtime -2\n\n# Find all empty directories in the current folder\nfind . -type d -empty\n\n# Find all files larger than 500M and ask to delete them\nfind / -type f -size +500M -exec rm -i {} \\;\n\n# Find files owned by a specific user\nfind /home -user jsmith"
                },
                {
                    "title": "'grep' in Action",
                    "language": "bash",
                    "code": "# Search for 'error' case-insensitively in a log file, showing line numbers\ngrep -in \"error\" /var/log/syslog\n\n# Recursively search for the term 'API_KEY' in a project directory\ngrep -r \"API_KEY\" /home/user/project\n\n# Show all lines in a file that DO NOT contain the word 'debug'\ngrep -v \"debug\" application.log\n\n# Count how many times an IP address appears in a log\ngrep -c \"192.168.1.100\" access.log"
                },
                {
                    "title": "Combining Commands for Powerful Searches",
                    "language": "bash",
                    "code": "# List all running processes and filter for only the 'sshd' service\nps aux | grep sshd\n\n# Find all .php files and then search within them for a specific function\nfind . -name \"*.php\" -exec grep -l \"database_connect\" {} \\;\n\n# List all installed packages (on Debian/Ubuntu) and find a specific one\ndpkg -l | grep 'apache2'"
                }
            ]
        },
        "quiz": {
            "passingScore": 75,
            "questions": [
                {
                    "id": 1,
                    "question": "You need to find a configuration file named `sshd_config` somewhere on your system, but you're not sure where. What is the fastest command to use?",
                    "options": ["find / -name sshd_config", "grep sshd_config /etc", "locate sshd_config", "search sshd_config"],
                    "correct": 2,
                    "explanation": "`locate` is the fastest command for finding files by name because it uses a pre-built database, making it much quicker than `find` which has to traverse the filesystem in real-time."
                },
                {
                    "id": 2,
                    "question": "Which `grep` option would you use to find all lines that *do not* contain the word 'SUCCESS'?",
                    "options": ["-i", "-r", "-v", "-n"],
                    "correct": 2,
                    "explanation": "The `-v` option for `grep` inverts the match, meaning it will print only the lines that do not match the specified pattern."
                },
                {
                    "id": 3,
                    "question": "What does the command `find . -type f -size +1G` do?",
                    "options": ["Finds all directories larger than 1 Gigabyte", "Finds all files exactly 1 Gigabyte in size", "Finds all files in the current directory and subdirectories that are larger than 1 Gigabyte", "Finds all files in the root directory that are larger than 1 Gigabyte"],
                    "correct": 2,
                    "explanation": "`.` specifies the current directory, `-type f` specifies files, and `-size +1G` specifies a size greater than 1 Gigabyte."
                },
                {
                    "id": 4,
                    "question": "In a regular expression, what does the `^` character typically signify?",
                    "options": ["Any single character", "The end of a line", "The start of a line", "Zero or more of the previous character"],
                    "correct": 2,
                    "explanation": "The caret `^` is a regex metacharacter that anchors the search pattern to the beginning of a line."
                },
                {
                    "id": 5,
                    "question": "Why might `locate` fail to find a file that you just created?",
                    "options": ["It can only find directories", "The file is too small", "The locate database has not been updated yet", "You need to use `sudo` with `locate`"],
                    "correct": 2,
                    "explanation": "`locate` relies on a database that is typically updated once a day. If a file was created after the last update, `locate` will not know it exists until the database is updated again via `updatedb`."
                },
                {
                    "id": 6,
                    "question": "How can you search for the word 'warning' inside every file in the current directory and all its subdirectories?",
                    "options": ["grep 'warning'", "grep -r 'warning' .", "find 'warning'", "locate 'warning' ."],
                    "correct": 1,
                    "explanation": "The `-r` option makes `grep` perform a recursive search, and `.` tells it to start in the current directory."
                }
            ]
        }
    },
    {
        "id": "lesson-13",
        "title": "Input/Output Redirection",
        "duration": "75 min",
        "objectives": [
            "Understand standard input, standard output, and standard error",
            "Redirect output to files using `>` and `>>`",
            "Use the pipe `|` to chain commands together",
            "Learn to redirect standard error and use the `tee` command"
        ],
        "content": {
            "overview": "Learn how to control where your commands get input from and where their output goes. Mastering I/O redirection and piping is a hallmark of a proficient command-line user, allowing you to build complex and powerful command chains.",
            "sections": [
                {
                    "title": "Standard Streams (stdin, stdout, stderr)",
                    "content": "<p>In Linux, every process starts with three open file descriptors, known as standard streams:</p><ul><li><strong>Standard Input (stdin, fd 0):</strong> Where a command receives its input, by default from the keyboard.</li><li><strong>Standard Output (stdout, fd 1):</strong> Where a command sends its normal output, by default to the screen.</li><li><strong>Standard Error (stderr, fd 2):</strong> Where a command sends its error messages, also by default to the screen.</li></ul><p>Understanding these three streams is the key to controlling your command-line environment.</p><div class=\"info-box note\"><div class=\"info-box-header\"><i class=\"fas fa-info-circle\"></i><strong>Why Separate stdout and stderr?</strong></div><p>Separating normal output from errors allows you to redirect them independently. You can save the successful output of a script to a file while still seeing any error messages on your screen.</p></div>",
                    "image": "https://images.unsplash.com/photo-1542831371-29b0f74f9713?w=800&h=400&fit=crop"
                },
                {
                    "title": "Redirecting Output with `>` and `>>`",
                    "content": "<p>You can redirect the standard output of a command to a file instead of the screen.</p><ul><li><code>></code>: The 'overwrite' redirector. It creates the file if it doesn't exist or overwrites it completely if it does.</li><li><code>>></code>: The 'append' redirector. It creates the file if it doesn't exist, but if it does, it adds the new output to the end of the file.</li></ul><h3>Examples:</h3><ul><li><code>ls -l > file_list.txt</code>: Saves the directory listing to a file, overwriting any previous content.</li><li><code>echo \"New log entry\" >> application.log</code>: Adds a new line to the end of a log file.</li></ul><div class=\"info-box warning\"><div class=\"info-box-header\"><i class=\"fas fa-exclamation-triangle\"></i><strong>Be Careful with `>`</strong></div><p>A common mistake is using `>` when you meant to use `>>`, which can accidentally wipe out an important file. Always double-check your redirector.</p></div>",
                    "image": "https://images.unsplash.com/photo-1516131206008-dd941138843I?w=800&h=400&fit=crop"
                },
                {
                    "title": "Piping Commands with `|`",
                    "content": "<p>The pipe <code>|</code> is one of the most powerful features of the shell. It lets you take the standard output of one command and use it as the standard input for another command.</p><h3>Example Workflow:</h3><p>The command <code>ps aux | grep 'nginx' | wc -l</code> demonstrates a chain:</p><ol><li><code>ps aux</code>: Lists all running processes (produces a lot of output).</li><li><code>| grep 'nginx'</code>: Its output is 'piped' as input to <code>grep</code>, which filters for lines containing 'nginx'.</li><li><code>| wc -l</code>: The filtered output is then piped to <code>wc -l</code>, which counts the number of lines.</li></ol><p>This chain tells you how many 'nginx' processes are currently running, without creating any intermediate files.</p>",
                    "image": "https://images.unsplash.com/photo-1618477388954-7852f32655ec?w=800&h=400&fit=crop"
                },
                {
                    "title": "Advanced Redirection (`2>`, `&>`, `tee`)",
                    "content": "<p>You can redirect standard error and both streams simultaneously.</p><ul><li><code>2></code>: Redirects only standard error. For example, <code>find / -name \"*.conf\" 2> errors.txt</code> saves any 'Permission denied' errors to a file.</li><li><code>&></code> or <code>> ... 2>&1</code>: Redirects both stdout and stderr to the same place. <code>script.sh &> output.log</code>.</li><li><code>/dev/null</code>: A special file that discards anything written to it. Use it to suppress output: <code>command > /dev/null 2>&1</code>.</li><li><code>tee</code>: Reads from standard input and writes to both standard output and one or more files. Useful for seeing output on the screen *and* saving it to a log. <code>ls -l | tee file_list.txt</code>.</li></ul>",
                    "image": "https://images.unsplash.com/photo-1587397845756-230954736914?w=800&h=400&fit=crop"
                }
            ],
            "codeExamples": [
                {
                    "title": "Basic Redirection",
                    "language": "bash",
                    "code": "# Overwrite file_list.txt with current directory listing\nls -la > file_list.txt\n\n# Append current date and time to log.txt\ndate >> log.txt\n\n# The `cat` command can take stdin from a file\ncat < file_list.txt"
                },
                {
                    "title": "Piping Examples",
                    "language": "bash",
                    "code": "# List files, sort them, and show the top 5\nls | sort | head -n 5\n\n# Show disk usage, filter for the 'sda' disk, and extract the usage percentage\ndf -h | grep 'sda' | awk '{print $5}'\n\n# Count the number of users currently logged in\nwho | wc -l"
                },
                {
                    "title": "Handling Standard Error",
                    "language": "bash",
                    "code": "# Run a command and redirect only errors to a file\nfind /root -name \"*.txt\" 2> permission_errors.log\n\n# Redirect successful output to one file and errors to another\nmy_script.sh > output.log 2> errors.log\n\n# Redirect both stdout and stderr to the same file\nmy_script.sh &> full_log.log\n\n# Suppress all output from a command (stdout and stderr)\nmy_command > /dev/null 2>&1\n\n# See the output and also save it to a file\ncat /var/log/syslog | grep 'CRON' | tee cron_jobs.log"
                }
            ]
        },
        "quiz": {
            "passingScore": 80,
            "questions": [
                {
                    "id": 1,
                    "question": "What is the primary function of the pipe `|` operator?",
                    "options": ["To save command output to a file", "To use the output of one command as the input for another", "To run multiple commands at the same time", "To suppress error messages"],
                    "correct": 1,
                    "explanation": "The pipe `|` is used to create a chain of commands, where the standard output of the command on the left becomes the standard input of the command on the right."
                },
                {
                    "id": 2,
                    "question": "You run `echo \"hello\" > welcome.txt`. Then you run `echo \"world\" > welcome.txt`. What will be the content of `welcome.txt`?",
                    "options": ["hello", "world", "hello\nworld", "world\nhello"],
                    "correct": 1,
                    "explanation": "The single greater-than sign `>` overwrites the file. The first command creates the file with 'hello', and the second command overwrites it completely with 'world'."
                },
                {
                    "id": 3,
                    "question": "How would you append the output of the `date` command to a file named `events.log`?",
                    "options": ["date > events.log", "date | events.log", "date >> events.log", "date < events.log"],
                    "correct": 2,
                    "explanation": "The double greater-than sign `>>` is the append operator, which adds output to the end of a file without overwriting its existing content."
                },
                {
                    "id": 4,
                    "question": "What does the command `my_command 2> /dev/null` accomplish?",
                    "options": ["It deletes the command's output", "It saves the command's output to a file named 'null'", "It suppresses only the standard output", "It suppresses only the standard error messages"],
                    "correct": 3,
                    "explanation": "`2>` redirects standard error (file descriptor 2), and `/dev/null` is a special file that discards all data written to it. This effectively silences any error messages."
                },
                {
                    "id": 5,
                    "question": "What is the purpose of the `tee` command in the line `dmesg | tee kernel_messages.log`?",
                    "options": ["It filters the output of `dmesg`", "It only shows the output on the screen", "It only saves the output to the file", "It shows the output on the screen AND saves it to the file"],
                    "correct": 3,
                    "explanation": "`tee` acts like a T-splitter in a pipe, sending its input to two destinations: standard output (the screen) and the specified file(s)."
                }
            ]
        }
    },
    {
        "id": "lesson-14",
        "title": "Environment Variables & Aliases",
        "duration": "75 min",
        "objectives": [
            "Understand the concept of environment variables",
            "View, set, and export variables",
            "Understand the importance of the PATH variable",
            "Create and use aliases to simplify long commands"
        ],
        "content": {
            "overview": "Customize your shell environment to work more efficiently. This lesson covers environment variables, which store important system information, and aliases, which let you create shortcuts for your most-used commands.",
            "sections": [
                {
                    "title": "What are Environment Variables?",
                    "content": "<p>Environment variables are dynamic, named values that affect the way processes behave on a computer. They store information like the current user, the default text editor, and the paths to executable programs.</p><h3>Key Commands:</h3><ul><li><code>env</code> or <code>printenv</code>: Display all environment variables.</li><li><code>echo $VARNAME</code>: Display the value of a specific variable (e.g., <code>echo $HOME</code>).</li><li><code>export VARNAME=\"value\"</code>: Sets an environment variable, making it available to all child processes spawned from that shell.</li></ul><p>By convention, environment variable names are in all uppercase.</p>",
                    "image": "https://images.unsplash.com/photo-1566837945700-30057527ade0?w=800&h=400&fit=crop"
                },
                {
                    "title": "The PATH Variable",
                    "content": "<p>The <code>$PATH</code> variable is one of the most important. It is a colon-separated list of directories that the shell searches through whenever you enter a command. This is how Linux knows where to find executables like <code>ls</code>, <code>grep</code>, and others without you having to type their full path (e.g., <code>/bin/ls</code>).</p><h3>Modifying the PATH:</h3><p>To add a new directory (like a custom scripts folder) to your PATH, you use the export command:</p><code>export PATH=\"$HOME/bin:$PATH\"</code><p>This prepends <code>/home/user/bin</code> to the existing PATH. To make this change permanent, you must add this line to your shell's startup file (e.g., <code>~/.bashrc</code>).</p><div class=\"info-box note\"><div class=\"info-box-header\"><i class=\"fas fa-info-circle\"></i><strong>`which` command</strong></div><p>Use the <code>which</code> command (e.g., <code>which ls</code>) to see the exact location of an executable that the shell finds in your PATH.</p></div>",
                    "image": "https://images.unsplash.com/photo-1507925921958-8a62f3d1a50d?w=800&h=400&fit=crop"
                },
                {
                    "title": "Creating Shortcuts with 'alias'",
                    "content": "<p>An alias is a shell command that replaces a longer, more complex command string with a shorter, easier-to-remember one.</p><h3>Creating Aliases:</h3><ul><li><code>alias</code>: Lists all currently defined aliases.</li><li><code>alias ll='ls -alF'</code>: Creates an alias named `ll` that runs the long listing command.</li><li><code>unalias ll</code>: Removes the 'll' alias.</li></ul><p>To make aliases permanent, you must add the alias definitions to your shell's startup file, typically <code>~/.bashrc</code> or <code>~/.bash_aliases</code>.</p><div class=\"info-box tip\"><div class=\"info-box-header\"><i class=\"fas fa-lightbulb\"></i><strong>Useful Aliases</strong></div><p>Common aliases include <code>alias..='cd ..'</code>, <code>alias update='sudo apt update && sudo apt upgrade -y'</code>, and <code>alias myip='curl ifconfig.me'</code>.</p></div>",
                    "image": "https://images.unsplash.com/photo-1550439062-609e1531270e?w=800&h=400&fit=crop"
                },
                {
                    "title": "Making Changes Permanent: `~/.bashrc`",
                    "content": "<p>Changes made with <code>export</code> and <code>alias</code> are only valid for the current shell session. To make them permanent, you need to add them to your shell's configuration file. For the Bash shell, this is usually <code>~/.bashrc</code>.</p><h3>Workflow:</h3><ol><li>Open the file with a text editor: <code>nano ~/.bashrc</code></li><li>Go to the end of the file and add your new lines (e.g., <code>export EDITOR=\"nano\"</code> or <code>alias cls='clear'</code>).</li><li>Save and close the file.</li><li>For the changes to take effect in your current shell, you must reload the configuration: <code>source ~/.bashrc</code></li></ol><p>Any new terminals you open will now have your new settings automatically.</p>",
                    "image": "https://images.unsplash.com/photo-1517694712202-14dd9538aa97?w=800&h=400&fit=crop"
                }
            ],
            "codeExamples": [
                {
                    "title": "Working with Variables",
                    "language": "bash",
                    "code": "# Display the value of the HOME variable\necho $HOME\n\n# Display the value of the SHELL variable\necho $SHELL\n\n# Set a temporary variable for the current session\nMY_VAR=\"Hello World\"\n\n# Display it. Note this is NOT an environment variable yet.\necho $MY_VAR\n\n# Export the variable to make it an environment variable\nexport MY_VAR\n\n# Verify it's in the environment\nenv | grep MY_VAR"
                },
                {
                    "title": "Managing the PATH",
                    "language": "bash",
                    "code": "# View the current PATH\necho $PATH\n\n# Add a new directory to the end of the PATH\nexport PATH=\"$PATH:$HOME/.local/bin\"\n\n# Add a new directory to the beginning of the PATH (higher priority)\nexport PATH=\"$HOME/my_scripts:$PATH\"\n\n# See where the python3 executable is located\nwhich python3"
                },
                {
                    "title": "Alias Examples",
                    "language": "bash",
                    "code": "# Create a simple alias for clearing the screen\nalias c='clear'\n\n# Create a more complex alias for a detailed, human-readable, time-sorted directory listing\nalias llt='ls -alhtr'\n\n# Create an alias to protect against accidental file removal\nalias rm='rm -i'\n\n# List all current aliases\nalias\n\n# Remove an alias\nunalias c"
                },
                {
                    "title": "Editing `.bashrc`",
                    "language": "bash",
                    "code": "# Open .bashrc in the nano editor\nnano ~/.bashrc\n\n# --- Add these lines to the end of the file ---\n# Custom Environment Variables\nexport EDITOR=\"nano\"\nexport PROJECTS_DIR=\"$HOME/projects\"\n\n# Custom Aliases\nalias update=\"sudo apt update && sudo apt upgrade -y\"\nalias ..=\"cd ..\"\n# ------------------------------------------\n\n# After saving and exiting nano, reload the file\nsource ~/.bashrc\n\n# Test your new alias\nupdate"
                }
            ]
        },
        "quiz": {
            "passingScore": 80,
            "questions": [
                {
                    "id": 1,
                    "question": "Which command would you use to create a shortcut named `ll` for the command `ls -la`?",
                    "options": ["export ll='ls -la'", "set ll='ls -la'", "alias ll='ls -la'", "path ll='ls -la'"],
                    "correct": 2,
                    "explanation": "The `alias` command is used to create command shortcuts, or aliases, in the shell."
                },
                {
                    "id": 2,
                    "question": "What is the purpose of the `$PATH` environment variable?",
                    "options": ["It stores the path to the current user's home directory", "It lists the directories the shell searches for executable programs", "It defines the path to the system's log files", "It stores the history of visited directories"],
                    "correct": 1,
                    "explanation": "The `$PATH` variable contains a colon-separated list of directories that are searched when you type a command, so you don't have to provide the full path to the executable."
                },
                {
                    "id": 3,
                    "question": "You've added a new alias to your `~/.bashrc` file. What must you do for the change to apply to your *current* terminal session?",
                    "options": ["Log out and log back in", "Restart the computer", "Run the command `source ~/.bashrc`", "Nothing, it applies automatically"],
                    "correct": 2,
                    "explanation": "The `source` command reads and executes the commands from a file in the current shell session, making the changes immediately available without needing to log out."
                },
                {
                    "id": 4,
                    "question": "How do you display the value of an environment variable named `USER`?",
                    "options": ["print USER", "get $USER", "var USER", "echo $USER"],
                    "correct": 3,
                    "explanation": "The `echo` command prints its arguments, and the `$` prefix is used to get the value of a variable."
                },
                {
                    "id": 5,
                    "question": "What is the difference between setting a variable like `MYVAR=\"hello\"` and `export MYVAR=\"hello\"`?",
                    "options": ["There is no difference", "The `export` command makes the variable permanent", "The `export` command makes the variable available to child processes", "The `export` command encrypts the variable's value"],
                    "correct": 2,
                    "explanation": "Setting a variable without `export` makes it a shell variable, only available in that specific shell. `export` turns it into an environment variable, which is inherited by any new processes or scripts started from that shell."
                }
            ]
        }
    },
    {
        "id": "lesson-15",
        "title": "Shell Scripting Basics",
        "duration": "120 min",
        "objectives": [
            "Write and execute a basic shell script",
            "Understand the importance of the shebang `#!/bin/bash`",
            "Use variables and accept user input",
            "Implement basic control structures like `if/else` statements"
        ],
        "content": {
            "overview": "Automate repetitive tasks by writing your own shell scripts. This lesson introduces the fundamental building blocks of scripting, including creating a script, using variables, handling user input, and making decisions with conditional logic.",
            "sections": [
                {
                    "title": "Creating Your First Script",
                    "content": "<p>A shell script is simply a text file containing a series of commands. To create one, you use a text editor and save the file, typically with a <code>.sh</code> extension.</p><h3>The Shebang:</h3><p>The very first line of a script should be the 'shebang', which tells the system which interpreter to use to execute the script. For Bash scripts, this is:</p><code>#!/bin/bash</code><h3>Executing a Script:</h3><p>Before you can run a script, you must make it executable using the <code>chmod</code> command:</p><code>chmod +x my_script.sh</code><p>Then you can execute it by providing its path:</p><code>./my_script.sh</code>",
                    "image": "https://images.unsplash.com/photo-1618423377884-a81a2b72c312?w=800&h=400&fit=crop"
                },
                {
                    "title": "Using Variables and User Input",
                    "content": "<p>Variables allow you to store and manipulate data in your scripts. You can also make scripts interactive by prompting the user for input.</p><h3>Variables:</h3><ul><li><strong>Assignment:</strong> <code>NAME=\"Alice\"</code> (no spaces around the equals sign).</li><li><strong>Usage:</strong> <code>echo \"Hello, $NAME\"</code> (use a dollar sign to retrieve the value).</li></ul><h3>User Input with `read`:</h3><p>The <code>read</code> command pauses the script and waits for the user to type something and press Enter.</p><code>echo \"What is your name?\"</code><br><code>read USER_NAME</code><br><code>echo \"Welcome, $USER_NAME\"</code>",
                    "image": "https://images.unsplash.com/photo-1573495627361-d9b87960b12d?w=800&h=400&fit=crop"
                },
                {
                    "title": "Positional Parameters and Special Variables",
                    "content": "<p>Scripts can accept arguments from the command line, known as positional parameters. There are also special variables that provide useful information about the script's execution.</p><h3>Positional Parameters:</h3><ul><li><code>$1</code>, <code>$2</code>, etc.: The first, second, etc., argument passed to the script.</li><li><code>$0</code>: The name of the script itself.</li></ul><h3>Special Variables:</h3><ul><li><code>$#</code>: The total number of arguments passed to the script.</li><li><code>$@</code>: All the arguments, individually quoted.</li><li><code>$?</code>: The exit status of the most recently executed command (0 means success, non-zero means failure).</li></ul>",
                    "image": "https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=800&h=400&fit=crop"
                },
                {
                    "title": "Conditional Logic with `if/else`",
                    "content": "<p>The <code>if</code> statement allows your script to make decisions and execute different code blocks based on whether a condition is true or false.</p><h3>Basic Syntax:</h3><pre><code>if [ condition ]\nthen\n  # commands to run if condition is true\nelse\n  # commands to run if condition is false\nfi</code></pre><p>Conditions often involve comparing numbers (<code>-gt</code> for greater than, <code>-eq</code> for equal) or strings (<code>==</code> for equal, <code>!=</code> for not equal).</p><div class=\"info-box tip\"><div class=\"info-box-header\"><i class=\"fas fa-lightbulb\"></i><strong>Test Conditions</strong></div><p>The square brackets <code>[ ]</code> are actually a command called <code>test</code>. It's crucial to have spaces inside the brackets, like <code>[ \"$VAR\" == \"value\" ]</code>.</p></div>",
                    "image": "https://images.unsplash.com/photo-1504868584819-f8e8b4b6d7e3?w=800&h=400&fit=crop"
                }
            ],
            "codeExamples": [
                {
                    "title": "Simple Greeting Script",
                    "language": "bash",
                    "code": "#!/bin/bash\n# A simple script that greets the user.\n\nNAME=\"World\"\necho \"Hello, $NAME!\"\n\n# Show system info\necho \"Your current user is: $USER\"\necho \"Your home directory is: $HOME\""
                },
                {
                    "title": "Interactive Backup Script",
                    "language": "bash",
                    "code": "#!/bin/bash\n\n# Ask the user for a file to back up\necho \"Which file would you like to back up?\"\nread FILENAME\n\n# Check if the file exists\nif [ -f \"$FILENAME\" ]\nthen\n  # Create a backup with a timestamp\n  BACKUP_FILE=\"${FILENAME}.$(date +%F-%H-%M-%S).bak\"\n  cp \"$FILENAME\" \"$BACKUP_FILE\"\n  echo \"Backup of '$FILENAME' created as '$BACKUP_FILE'\"\nelse\n  echo \"Error: File '$FILENAME' not found.\"\nfi"
                },
                {
                    "title": "Script with Command-Line Arguments",
                    "language": "bash",
                    "code": "#!/bin/bash\n\n# Check if exactly two arguments were provided\nif [ \"$#\" -ne 2 ]\nthen\n  echo \"Usage: $0 <source_file> <destination_file>\"\n  exit 1\nfi\n\n# Assign arguments to variables for clarity\nSOURCE=$1\nDESTINATION=$2\n\n# Copy the file\ncp \"$SOURCE\" \"$DESTINATION\"\n\n# Check if the copy was successful\nif [ \"$?\" -eq 0 ]\nthen\n  echo \"Successfully copied $SOURCE to $DESTINATION\"\nelse\n  echo \"An error occurred during the copy.\"\nfi"
                }
            ]
        },
        "quiz": {
            "passingScore": 80,
            "questions": [
                {
                    "id": 1,
                    "question": "What is the purpose of the `#!/bin/bash` line at the beginning of a script?",
                    "options": ["It's a comment explaining the script", "It sets the script's title", "It tells the system which interpreter to use to run the script", "It loads the bash library"],
                    "correct": 2,
                    "explanation": "This line, called the 'shebang', is a directive to the operating system to execute the script using the /bin/bash interpreter."
                },
                {
                    "id": 2,
                    "question": "Which command is used to make a shell script executable?",
                    "options": ["exec my_script.sh", "run my_script.sh", "chmod +x my_script.sh", "set -e my_script.sh"],
                    "correct": 2,
                    "explanation": "The `chmod +x` command adds the execute permission to a file, which is necessary before the system will allow you to run it as a program."
                },
                {
                    "id": 3,
                    "question": "Inside a script, how would you access the first argument passed to it from the command line?",
                    "options": ["$ARG1", "$1", "%1", "#1"],
                    "correct": 1,
                    "explanation": "Positional parameters are accessed using a dollar sign followed by their number. `$1` is the first argument, `$2` is the second, and so on."
                },
                {
                    "id": 4,
                    "question": "What does the special variable `$?` contain?",
                    "options": ["The total number of arguments", "The name of the script", "The process ID of the script", "The exit status of the last command executed"],
                    "correct": 3,
                    "explanation": "The `$?` variable holds the exit code of the previously executed command. A value of 0 indicates success, while any non-zero value indicates an error."
                },
                {
                    "id": 5,
                    "question": "Which command is used to read input from the user and store it in a variable named `CHOICE`?",
                    "options": ["input CHOICE", "read CHOICE", "get CHOICE", "prompt CHOICE"],
                    "correct": 1,
                    "explanation": "The `read` command is the standard shell built-in for accepting user input from the keyboard."
                }
            ]
        }
    },
    {
        "id": "lesson-16",
        "title": "Cron Jobs & Automation",
        "duration": "60 min",
        "objectives": [
            "Understand the purpose of the cron daemon",
            "Learn the syntax of a crontab entry",
            "Schedule your own automated tasks using `crontab`",
            "Schedule a one-time task with the `at` command"
        ],
        "content": {
            "overview": "Harness the power of automation by scheduling scripts and commands to run at specific times and intervals. This lesson covers `cron`, the standard Linux task scheduler, allowing you to automate backups, system updates, report generation, and more.",
            "sections": [
                {
                    "title": "Understanding the Cron Daemon",
                    "content": "<p>The <code>cron</code> daemon is a background service that runs continuously and executes scheduled commands at specific times. The schedule for each user is stored in a file called a <code>crontab</code> (cron table).</p><h3>Key Commands:</h3><ul><li><code>crontab -e</code>: Edit your personal crontab file.</li><li><code>crontab -l</code>: List the contents of your crontab file.</li><li><code>crontab -r</code>: Remove your crontab file (use with caution!).</li></ul><p>System-wide cron jobs are often defined in files within <code>/etc/cron.d/</code>, <code>/etc/cron.daily/</code>, <code>/etc/cron.hourly/</code>, and so on.</p>",
                    "image": "https://images.unsplash.com/photo-1558522195-e12713519528?w=800&h=400&fit=crop"
                },
                {
                    "title": "Crontab Syntax",
                    "content": "<p>Each line in a crontab file represents a single job and follows a specific format consisting of five time-and-date fields, followed by the command to be run.</p><pre><code># ┌───────────── minute (0 - 59)\n# │ ┌───────────── hour (0 - 23)\n# │ │ ┌───────────── day of month (1 - 31)\n# │ │ │ ┌───────────── month (1 - 12)\n# │ │ │ │ ┌───────────── day of week (0 - 6) (Sunday to Saturday)\n# │ │ │ │ │\n# * * * * *  command_to_execute</code></pre><h3>Special Characters:</h3><ul><li><code>*</code>: Asterisk. Represents 'every'. For example, an asterisk in the hour field means 'every hour'.</li><li><code>,</code>: Comma. Specifies a list of values (e.g., <code>1,15,30</code> in the minute field).</li><li><code>-</code>: Hyphen. Specifies a range of values (e.g., <code>9-17</code> in the hour field).</li><li><code>/</code>: Slash. Specifies step values (e.g., <code>*/15</code> in the minute field means 'every 15 minutes').</li></ul>",
                    "image": "https://images.unsplash.com/photo-1507925921958-8a62f3d1a50d?w=800&h=400&fit=crop"
                },
                {
                    "title": "Scheduling a One-Time Task with `at`",
                    "content": "<p>While cron is for recurring tasks, the <code>at</code> command is designed to execute a command or script once at a specific time in the future.</p><h3>Usage:</h3><p>You run <code>at</code> with a time specification. It then gives you a prompt where you can type the commands to be executed. You press <code>Ctrl+D</code> to finish.</p><code>at now + 10 minutes</code><br><code>at> /usr/bin/notify-send \"Your tea is ready!\"</code><br><code>at> job 1 at ...</code><p>Other commands include <code>atq</code> (to view the queue of pending jobs) and <code>atrm</code> (to remove a job).</p><div class=\"info-box note\"><div class=\"info-box-header\"><i class=\"fas fa-info-circle\"></i><strong>`atd` Service</strong></div><p>The <code>at</code> command relies on a background service, often called `atd`, to be running. You can check its status with `systemctl status atd`.</p></div>",
                    "image": "https://images.unsplash.com/photo-1516116216624-53e697320964?w=800&h=400&fit=crop"
                }
            ],
            "codeExamples": [
                {
                    "title": "Common Crontab Examples",
                    "language": "bash",
                    "code": "# Run a backup script every day at 2:30 AM\n30 2 * * * /home/user/scripts/backup.sh\n\n# Check for system updates every Sunday at 4:00 AM\n0 4 * * 0 /usr/bin/apt update\n\n# Run a monitoring script every 15 minutes\n*/15 * * * * /home/user/scripts/monitor.sh\n\n# Run a command on the first day of every month\n0 0 1 * * /home/user/scripts/monthly_report.sh\n\n# Special string for running at reboot\n@reboot /home/user/scripts/startup_task.sh"
                },
                {
                    "title": "Handling Cron Job Output",
                    "language": "bash",
                    "code": "# By default, cron emails any output. It's better to redirect it.\n\n# Append both stdout and stderr to a log file\n* * * * * /my/command >> /var/log/my_command.log 2>&1\n\n# Discard all output if you don't need to log it\n* * * * * /my/command > /dev/null 2>&1"
                },
                {
                    "title": "Using the `at` Command",
                    "language": "bash",
                    "code": "# Schedule a reboot for 11:00 PM tonight\necho \"/sbin/reboot\" | at 11pm\n\n# Interactively schedule a reminder in 5 minutes\nat now + 5 min\n# Enter commands at the 'at>' prompt, then press Ctrl+D\nat> /usr/bin/notify-send \"Time for a break!\"\nat> <EOT>\n\n# View the pending job queue\natq\n\n# Remove job number 2 from the queue\natrm 2"
                }
            ]
        },
        "quiz": {
            "passingScore": 80,
            "questions": [
                {
                    "id": 1,
                    "question": "Which command do you use to edit your personal cron job file?",
                    "options": ["cron -e", "crontab -l", "crontab -e", "cronedit"],
                    "correct": 2,
                    "explanation": "`crontab -e` opens your user-specific crontab file in the default text editor so you can add, remove, or modify scheduled jobs."
                },
                {
                    "id": 2,
                    "question": "What does the crontab entry `* * * * * /bin/date` do?",
                    "options": ["Runs the `date` command once", "Runs the `date` command every minute", "Runs the `date` command once a day", "This is an invalid entry"],
                    "correct": 1,
                    "explanation": "The asterisk `*` in all five time fields means 'every'. Therefore, `* * * * *` matches every minute of every hour of every day, and so on."
                },
                {
                    "id": 3,
                    "question": "How would you schedule a script at `/home/scripts/cleanup.sh` to run every Friday at 5 PM?",
                    "options": ["* 17 * * 5 /home/scripts/cleanup.sh", "17 5 * * Fri /home/scripts/cleanup.sh", "5 17 * * 5 /home/scripts/cleanup.sh", "* 5 * * 5 /home/scripts/cleanup.sh"],
                    "correct": 0,
                    "explanation": "The format is Min Hour DayOfMonth Month DayOfWeek. `*` for minute, `17` for 5 PM (24-hour clock), `*` for DayOfMonth, `*` for Month, and `5` for Friday (where Sunday=0)."
                },
                {
                    "id": 4,
                    "question": "You want to run a computationally expensive command, but only once, at 2 AM tomorrow when the system is idle. Which command is most appropriate?",
                    "options": ["cron", "at", "sleep", "job"],
                    "correct": 1,
                    "explanation": "The `at` command is specifically designed for scheduling commands to run a single time in the future, making it perfect for this use case. Cron is for recurring tasks."
                },
                {
                    "id": 5,
                    "question": "What is the purpose of adding `> /dev/null 2>&1` to the end of a cron job command?",
                    "options": ["To run the command in the background", "To log all output to a file named 'null'", "To prevent cron from sending an email by redirecting all output and errors to be discarded", "To increase the priority of the command"],
                    "correct": 2,
                    "explanation": "By default, cron emails any output from a command. `> /dev/null` discards standard output, and `2>&1` redirects standard error to the same place, effectively silencing the command and preventing emails."
                }
            ]
        }
    },
    {
        "id": "lesson-17",
        "title": "Networking Commands",
        "duration": "90 min",
        "objectives": [
            "Inspect network interfaces and IP addresses with `ip`",
            "Test network connectivity with `ping`",
            "Download files from the web with `curl` and `wget`",
            "Examine network connections with `ss` or `netstat`"
        ],
        "content": {
            "overview": "Every modern computer is connected to a network. This lesson covers the essential command-line tools for configuring, troubleshooting, and interacting with network services, from checking your IP address to downloading files from the internet.",
            "sections": [
                {
                    "title": "Inspecting Network Interfaces (`ip` command)",
                    "content": "<p>The <code>ip</code> command is the modern and powerful tool for network configuration. The older <code>ifconfig</code> command is now deprecated. The most common use is to view network interface details.</p><h3>Key Commands:</h3><ul><li><code>ip addr show</code> (or <code>ip a</code>): Shows all network interfaces along with their IP addresses (both IPv4 and IPv6), MAC addresses, and state.</li><li><code>ip route show</code>: Displays the kernel's routing table, showing you the default gateway.</li></ul>",
                    "image": "https://images.unsplash.com/photo-1573497161211-a55e3742b4b4?w=800&h=400&fit=crop"
                },
                {
                    "title": "Testing Connectivity (`ping`)",
                    "content": "<p>The <code>ping</code> command is the primary tool for testing network connectivity. It sends a special network packet (an ICMP ECHO_REQUEST) to a target host and waits for a reply. It helps you answer the question: 'Can my computer reach that other computer?'</p><h3>Usage:</h3><ul><li><code>ping google.com</code>: Pings the domain 'google.com'. This also tests if your DNS resolution is working.</li><li><code>ping 8.8.8.8</code>: Pings the IP address for Google's public DNS server.</li><li><code>-c 4</code>: The 'count' flag. Pings the target 4 times and then stops. (On Linux, ping runs forever until you stop it with Ctrl+C).</li></ul><p>Key things to look for in the output are the round-trip time (in ms) and whether any packets were lost.</p>",
                    "image": "https://images.unsplash.com/photo-1517420704952-d9f39e95b43e?w=800&h=400&fit=crop"
                },
                {
                    "title": "Downloading Files (`wget` and `curl`)",
                    "content": "<p><code>wget</code> and <code>curl</code> are two powerful command-line tools for transferring data from or to a server.</p><h3>Wget:</h3><p><code>wget</code> is a straightforward file downloader. It's simple and robust.</p><ul><li><code>wget https://example.com/file.zip</code>: Downloads the file to the current directory.</li><li><code>-c</code>: Resumes a partially downloaded file.</li><li><code>-r</code>: Recursively downloads, like mirroring a website.</li></ul><h3>Curl:</h3><p><code>curl</code> (Client for URLs) is a more versatile tool. It can do much more than just download files, such as testing APIs. It prints its output to standard output by default.</p><ul><li><code>curl https://example.com</code>: Displays the HTML source of the page on your screen.</li><li><code>curl -o filename.html https://example.com</code>: Saves the output to a file.</li><li><code>-L</code>: Follows redirects.</li></ul>",
                    "image": "https://images.unsplash.com/photo-1542621334-a254cf47733d?w=800&h=400&fit=crop"
                },
                {
                    "title": "Viewing Network Connections (`ss` and `netstat`)",
                    "content": "<p>To see what network connections are active on your system (both incoming and outgoing), you can use the <code>ss</code> or the older <code>netstat</code> command. <code>ss</code> is now the recommended tool as it is faster and provides more information.</p><h3>Key `ss` Options:</h3><ul><li><code>-t</code>: Display TCP connections.</li><li><code>-u</code>: Display UDP connections.</li><li><code>-l</code>: Display listening sockets (servers).</li><li><code>-p</code>: Show the process using the socket.</li><li><code>-n</code>: Do not resolve service names (show port numbers instead of 'http').</li><li><code>-a</code>: Display all sockets (both listening and non-listening).</li></ul><div class=\"info-box note\"><div class=\"info-box-header\"><i class=\"fas fa-info-circle\"></i><strong>Common Combination</strong></div><p>A very useful command is <code>sudo ss -tulpn</code>, which shows all listening TCP and UDP ports, the processes using them, and doesn't waste time on name lookups.</p></div>",
                    "image": "https://images.unsplash.com/photo-1487058792275-0ad4aaf24ca7?w=800&h=400&fit=crop"
                }
            ],
            "codeExamples": [
                {
                    "title": "`ip` Command Examples",
                    "language": "bash",
                    "code": "# Show all network interfaces\nip a\n\n# Show information for a specific interface (e.g., eth0)\nip a show eth0\n\n# Show the routing table\nip r\n\n# Show network statistics for interfaces\nip -s link"
                },
                {
                    "title": "Practical `ping` and `curl` Usage",
                    "language": "bash",
                    "code": "# Ping a host 5 times with a 1-second interval\nping -c 5 -i 1 google.com\n\n# Check your public IP address using an external service\ncurl ifconfig.me\n\n# Test if a web server is responding by fetching only the headers\ncurl -I https://www.google.com\n\n# Download a file and save it with a different name\nwget -O ubuntu-server.iso https://releases.ubuntu.com/22.04/ubuntu-22.04.1-live-server-amd64.iso"
                },
                {
                    "title": "`ss` Command Examples",
                    "language": "bash",
                    "code": "# List all established TCP connections\nss -t\n\n# List all TCP sockets in a listening state\nss -lt\n\n# List all listening ports (TCP and UDP) and the processes using them\nsudo ss -tulpn\n\n# Find connections to a specific destination IP\nss -t src 192.168.1.100\n\n# Filter for connections on port 443 (HTTPS)\nss -tn 'dport = :443'"
                }
            ]
        },
        "quiz": {
            "passingScore": 80,
            "questions": [
                {
                    "id": 1,
                    "question": "What is the modern command to view all IP addresses on a Linux system?",
                    "options": ["ifconfig", "netstat -i", "ip addr show", "ipconfig"],
                    "correct": 2,
                    "explanation": "The `ip addr show` (or its shortcut `ip a`) is the current standard command for displaying network interfaces and their addresses, replacing the older `ifconfig`."
                },
                {
                    "id": 2,
                    "question": "You run `ping example.com` and get no response. What is a good next step to diagnose if the problem is DNS-related?",
                    "options": ["Ping your own IP address", "Ping a known IP address like 8.8.8.8", "Run `ifconfig` again", "Use `wget` on example.com"],
                    "correct": 1,
                    "explanation": "If `ping example.com` fails but `ping 8.8.8.8` succeeds, it means your computer has internet connectivity, but is failing to resolve the domain name. This points to a DNS issue."
                },
                {
                    "id": 3,
                    "question": "What is the primary difference between how `curl` and `wget` handle output by default?",
                    "options": ["`wget` saves to a file, `curl` prints to standard output", "`curl` saves to a file, `wget` prints to standard output", "They both save to a file by default", "They both print to standard output by default"],
                    "correct": 0,
                    "explanation": "By default, `wget` is designed as a downloader and will save the resource to a file with the same name. `curl` is a more general data transfer tool and will display the resource on standard output unless redirected."
                },
                {
                    "id": 4,
                    "question": "Which command would you use to see which program is listening for connections on TCP port 80?",
                    "options": ["ping -p 80", "ip a | grep 80", "sudo ss -ltp | grep :80", "wget localhost:80"],
                    "correct": 2,
                    "explanation": "`ss` is the tool for inspecting sockets. `-l` shows listening sockets, `-t` specifies TCP, and `-p` shows the process. Grepping for `:80` filters for the correct port."
                },
                {
                    "id": 5,
                    "question": "What is the purpose of the `-c` flag in the `ping` command (e.g., `ping -c 5 google.com`)?",
                    "options": ["To set the packet color", "To set a count for how many ping packets to send", "To check for connectivity", "To specify a character set"],
                    "correct": 1,
                    "explanation": "By default on Linux, `ping` runs indefinitely. The `-c` (count) flag is used to specify a fixed number of packets to send before the command automatically exits."
                }
            ]
        }
    },
    {
        "id": "lesson-18",
        "title": "System Monitoring & Logs",
        "duration": "75 min",
        "objectives": [
            "Navigate the `/var/log` directory and understand key log files",
            "View kernel ring buffer messages with `dmesg`",
            "Query the systemd journal with `journalctl`",
            "Monitor log files in real-time with `tail -f`"
        ],
        "content": {
            "overview": "Understanding how to read system logs is a fundamental skill for troubleshooting. This lesson explores the different locations where Linux stores log data, from traditional text files in `/var/log` to the modern systemd journal, and how to use the right tools to find the information you need.",
            "sections": [
                {
                    "title": "The `/var/log` Directory",
                    "content": "<p>The <code>/var/log</code> directory is the traditional location for most system and application log files. These are typically plain text files that you can read with commands like <code>cat</code>, <code>less</code>, or <code>tail</code>.</p><h3>Common Log Files:</h3><ul><li><code>/var/log/syslog</code> (or <code>/var/log/messages</code> on Red Hat systems): A general-purpose log file for system events.</li><li><code>/var/log/auth.log</code> (or <code>/var/log/secure</code>): Authentication-related events, such as logins (successful and failed) and <code>sudo</code> usage.</li><li><code>/var/log/kern.log</code>: Kernel-specific messages.</li><li><code>/var/log/boot.log</code>: Messages related to the system startup process.</li><li>Subdirectories like <code>/var/log/apache2/</code> or <code>/var/log/nginx/</code> for specific services.</li></ul>",
                    "image": "https://images.unsplash.com/photo-1526374965328-5f61d4dc18c5?w=800&h=400&fit=crop"
                },
                {
                    "title": "Kernel Messages with `dmesg`",
                    "content": "<p>The <code>dmesg</code> command is used to print the kernel's ring buffer. This buffer contains messages generated by the Linux kernel, including detailed information about hardware devices that were detected during the boot process.</p><p>It's an invaluable tool for troubleshooting hardware issues. For example, if you plug in a USB drive and it doesn't work, running <code>dmesg</code> is often the first step to see if the kernel even detected it and if it produced any errors.</p><div class=\"info-box tip\"><div class=\"info-box-header\"><i class=\"fas fa-lightbulb\"></i><strong>Paging Output</strong></div><p>The output of `dmesg` can be very long. It's almost always a good idea to pipe it into `less`: <code>dmesg | less</code>.</p></div>",
                    "image": "https://images.unsplash.com/photo-1591799264318-7e6cb8dd785b?w=800&h=400&fit=crop"
                },
                {
                    "title": "The Systemd Journal with `journalctl`",
                    "content": "<p>Modern Linux distributions using <code>systemd</code> have a centralized logging system called the journal. The <code>journalctl</code> command is the tool used to query and view these logs.</p><h3>Key `journalctl` Options:</h3><ul><li><code>-f</code>: Follow the log in real-time (like <code>tail -f</code>).</li><li><code>-u &lt;unit&gt;</code>: Show logs for a specific service, e.g., <code>journalctl -u nginx.service</code>.</li><li><code>-b</code>: Show messages from the current boot. <code>-b -1</code> shows messages from the previous boot.</li><li><code>--since \"YYYY-MM-DD HH:MM:SS\"</code>: Show logs since a specific time. You can also use relative times like `\"1 hour ago\"`.</li><li><code>-p &lt;priority&gt;</code>: Filter by priority, from `emerg` (0) to `debug` (7). E.g., <code>journalctl -p err</code> shows only errors and higher-priority messages.</li></ul>",
                    "image": "https://images.unsplash.com/photo-1633613286900-327345e47855?w=800&h=400&fit=crop"
                },
                {
                    "title": "Monitoring Logs in Real-Time",
                    "content": "<p>One of the most common tasks when troubleshooting is watching a log file for new entries as they happen. The <code>tail</code> command with the <code>-f</code> (follow) option is perfect for this.</p><code>tail -f /var/log/syslog</code><p>This command will display the last few lines of the file and then wait. As new lines are added to the file by the system, they will instantly appear on your screen. This is essential for watching the impact of your actions in real-time. You can stop it by pressing <code>Ctrl+C</code>.</p>",
                    "image": "https://images.unsplash.com/photo-1544256718-3bcf237f3974?w=800&h=400&fit=crop"
                }
            ],
            "codeExamples": [
                {
                    "title": "Viewing Traditional Logs",
                    "language": "bash",
                    "code": "# View the entire system log (might be long!)\nless /var/log/syslog\n\n# View the last 50 lines of the authentication log\ntail -n 50 /var/log/auth.log\n\n# Watch the system log for new messages in real-time\ntail -f /var/log/syslog\n\n# Search for all failed login attempts\nsudo grep 'Failed password' /var/log/auth.log"
                },
                {
                    "title": "`dmesg` Examples",
                    "language": "bash",
                    "code": "# View all kernel messages, piped to less\ndmesg | less\n\n# Filter for messages related to USB devices\ndmesg | grep -i usb\n\n# Filter for messages related to your disk drives (e.g., sda, nvme)\ndmesg | grep -i 'sda\\|nvme'\n\n# Show messages with human-readable timestamps\ndmesg -H"
                },
                {
                    "title": "`journalctl` Examples",
                    "language": "bash",
                    "code": "# Follow all new journal entries\njournalctl -f\n\n# View all logs for the SSH service since yesterday\njournalctl -u ssh.service --since yesterday\n\n# Show only error-level messages from the current boot\njournalctl -b -p err\n\n# Check the logs for a specific executable\njournalctl /usr/sbin/sshd\n\n# Show the last 20 journal entries\njournalctl -n 20"
                }
            ]
        },
        "quiz": {
            "passingScore": 80,
            "questions": [
                {
                    "id": 1,
                    "question": "Which command would you use to watch the `/var/log/auth.log` file for new entries in real-time?",
                    "options": ["cat /var/log/auth.log", "less /var/log/auth.log", "tail -f /var/log/auth.log", "head /var/log/auth.log"],
                    "correct": 2,
                    "explanation": "The `tail` command shows the end of a file, and the `-f` (follow) option tells it to keep running and display new lines as they are added to the file."
                },
                {
                    "id": 2,
                    "question": "You just plugged in a new webcam and it's not working. Which command is the best first step for seeing low-level kernel messages about the hardware detection?",
                    "options": ["journalctl", "dmesg", "cat /var/log/syslog", "tail /var/log/auth.log"],
                    "correct": 1,
                    "explanation": "`dmesg` prints the kernel ring buffer, which contains the most direct information about hardware detection, initialization, and errors."
                },
                {
                    "id": 3,
                    "question": "On a modern systemd-based OS, how would you view all the logs specifically from the `nginx.service` unit?",
                    "options": ["grep nginx /var/log/syslog", "journalctl -u nginx.service", "dmesg | grep nginx", "tail -f /var/log/nginx/access.log"],
                    "correct": 1,
                    "explanation": "The `journalctl` command with the `-u` (unit) flag is the correct and most direct way to filter the centralized systemd journal for logs from a specific service."
                },
                {
                    "id": 4,
                    "question": "Where would you most likely find logs related to user logins and `sudo` command usage?",
                    "options": ["/var/log/kern.log", "/var/log/boot.log", "/var/log/syslog", "/var/log/auth.log (or /var/log/secure)"],
                    "correct": 3,
                    "explanation": "Authentication events, including logins, switching users, and privilege escalation via `sudo`, are logged to the authentication log file by default."
                },
                {
                    "id": 5,
                    "question": "What does the command `journalctl -b -1 -p warning` show?",
                    "options": ["All logs from the current boot", "Only the first warning from the previous boot", "All logs from the previous boot with a priority of 'warning' or higher (more severe)", "All logs containing the word 'warning'"],
                    "correct": 2,
                    "explanation": "`-b -1` specifies the previous boot, and `-p warning` filters for messages at the 'warning', 'err', 'crit', 'alert', and 'emerg' levels."
                }
            ]
        }
    },
    {
        "id": "lesson-19",
        "title": "SSH & Remote Connections",
        "duration": "90 min",
        "objectives": [
            "Connect to a remote server using SSH",
            "Understand the difference between password and key-based authentication",
            "Generate and use SSH keys for secure, passwordless logins",
            "Securely copy files to and from a remote server with `scp` and `sftp`"
        ],
        "content": {
            "overview": "Secure Shell (SSH) is the primary tool for remotely managing Linux systems. This lesson covers how to establish secure connections, set up highly secure key-based authentication, and transfer files across the network safely.",
            "sections": [
                {
                    "title": "Connecting with SSH",
                    "content": "<p>SSH (Secure Shell) provides an encrypted channel over an unsecured network, allowing you to securely run a shell on a remote machine. The basic syntax is simple:</p><code>ssh username@hostname_or_ip</code><p>The first time you connect to a new host, SSH will ask you to verify the host's fingerprint. This is a security measure to prevent 'man-in-the-middle' attacks. After you accept it, it will be stored in <code>~/.ssh/known_hosts</code>.</p>",
                    "image": "https://images.unsplash.com/photo-1614063217255-911b55c82245?w=800&h=400&fit=crop"
                },
                {
                    "title": "Key-Based Authentication",
                    "content": "<p>While you can log in with a password, the much more secure and convenient method is to use SSH keys. This involves creating a pair of cryptographic keys: a private key (which you keep secret on your local machine) and a public key (which you place on the remote server).</p><h3>How it Works:</h3><ol><li>Your client tells the server it wants to authenticate with a key.</li><li>The server finds your public key in its authorized list and sends your client a challenge, encrypted with that public key.</li><li>Only your corresponding private key can decrypt the challenge. Your client decrypts it, proves its identity, and you are logged in without ever typing a password.</li></ol><div class=\"info-box tip\"><div class=\"info-box-header\"><i class=\"fas fa-lightbulb\"></i><strong>Security Benefit</strong></div><p>This method prevents brute-force password attacks. An attacker would need to steal your private key file, which is much harder than guessing a password.</p></div>",
                    "image": "https://images.unsplash.com/photo-1555949963-ff9b8c4c2031?w=800&h=400&fit=crop"
                },
                {
                    "title": "Generating and Using SSH Keys",
                    "content": "<p>Setting up key-based authentication is a simple, two-step process.</p><h3>1. Generate the Keys:</h3><p>On your local machine, run the <code>ssh-keygen</code> command. It will prompt you for a file to save the key and a passphrase (optional but recommended for extra security).</p><code>ssh-keygen -t rsa -b 4096</code><h3>2. Copy the Public Key to the Server:</h3><p>The easiest way is to use the <code>ssh-copy-id</code> utility. It automatically appends your public key to the correct file (<code>~/.ssh/authorized_keys</code>) on the server with the correct permissions.</p><code>ssh-copy-id username@remote_host</code><p>After this, your next <code>ssh username@remote_host</code> command should log you in without asking for a password (though it might ask for your key's passphrase if you set one).</p>",
                    "image": "https://images.unsplash.com/photo-1526374965328-5f61d4dc18c5?w=800&h=400&fit=crop"
                },
                {
                    "title": "Secure File Transfer (`scp` and `sftp`)",
                    "content": "<p>SSH also provides tools for securely transferring files.</p><h3>SCP (Secure Copy):</h3><p><code>scp</code> works very much like the regular <code>cp</code> command, but it can copy files to or from a remote host.</p><ul><li><strong>Local to Remote:</strong> <code>scp /local/path/file.txt user@remote:/remote/path/</code></li><li><strong>Remote to Local:</strong> <code>scp user@remote:/remote/path/file.txt /local/path/</code></li><li>Use the <code>-r</code> flag to copy directories recursively.</li></ul><h3>SFTP (SSH File Transfer Protocol):</h3><p><code>sftp</code> provides an interactive, FTP-like session for managing remote files over an SSH connection. You connect with <code>sftp user@remote</code> and then use commands like <code>ls</code>, <code>get</code>, <code>put</code>, and <code>cd</code> to navigate and transfer files.</p>",
                    "image": "https://images.unsplash.com/photo-1563330394-2396e9f698b6?w=800&h=400&fit=crop"
                }
            ],
            "codeExamples": [
                {
                    "title": "Basic SSH Connection",
                    "language": "bash",
                    "code": "# Connect to a server using the username 'admin'\nssh admin@192.168.1.100\n\n# Connect to a server on a non-standard port (e.g., 2222)\nssh -p 2222 user@server.example.com\n\n# Run a single command on the remote server without a full shell\nssh user@remote 'df -h'"
                },
                {
                    "title": "SSH Key Management Workflow",
                    "language": "bash",
                    "code": "# 1. Generate a strong key pair on your local machine\nssh-keygen -t ed25519 -C \"your_email@example.com\"\n\n# 2. Copy the public key to the remote server\nssh-copy-id user@remote_server\n\n# 3. Log in without a password\nssh user@remote_server\n\n# You can view your public key anytime\ncat ~/.ssh/id_ed25519.pub"
                },
                {
                    "title": "`scp` and `sftp` Examples",
                    "language": "bash",
                    "code": "# Copy a local file to the remote user's home directory\nscp my_document.txt user@remote:~\n\n# Copy a remote log file back to the current local directory\nscp user@remote:/var/log/syslog .\n\n# Recursively copy an entire local project directory to the server\nscp -r ./my_project user@remote:/var/www/\n\n# Start an interactive SFTP session\nsftp user@remote\n# Inside SFTP: get remote_file.zip\n# Inside SFTP: put local_file.txt"
                }
            ]
        },
        "quiz": {
            "passingScore": 80,
            "questions": [
                {
                    "id": 1,
                    "question": "Which command is used to securely connect to a remote Linux server from your terminal?",
                    "options": ["telnet", "ftp", "ssh", "rdp"],
                    "correct": 2,
                    "explanation": "SSH (Secure Shell) is the standard, encrypted protocol for command-line access to remote servers."
                },
                {
                    "id": 2,
                    "question": "When using SSH key authentication, which key do you place on the remote server?",
                    "options": ["The private key", "The public key", "Both the private and public key", "A shared secret key"],
                    "correct": 1,
                    "explanation": "The public key is placed on the server in the `~/.ssh/authorized_keys` file. The private key must be kept secret and secure on your local client machine."
                },
                {
                    "id": 3,
                    "question": "What is the recommended command to copy your public key to a remote server to set up key-based login?",
                    "options": ["scp ~/.ssh/id_rsa.pub user@remote:~/", "ssh-keygen -c user@remote", "ssh-copy-id user@remote", "cat ~/.ssh/id_rsa.pub | ssh user@remote"],
                    "correct": 2,
                    "explanation": "`ssh-copy-id` is the preferred utility because it handles appending the key to the `authorized_keys` file and setting the correct file and directory permissions automatically."
                },
                {
                    "id": 4,
                    "question": "How would you copy a file named `report.pdf` from your local machine to the home directory of `user` on `remote.server`?",
                    "options": ["scp report.pdf user@remote.server:~", "ftp report.pdf user@remote.server", "ssh report.pdf user@remote.server:~", "get report.pdf user@remote.server"],
                    "correct": 0,
                    "explanation": "The `scp` command follows the syntax `scp <source> <destination>`. In this case, the source is the local file and the destination is the remote path."
                },
                {
                    "id": 5,
                    "question": "What is the primary security advantage of using SSH keys over passwords?",
                    "options": ["Keys are easier to remember", "Keys cannot be stolen", "Keys are much longer and more complex than passwords, making them resistant to brute-force attacks", "Keys allow multiple users to share one account"],
                    "correct": 2,
                    "explanation": "A strong SSH key is cryptographically infeasible to guess or 'brute-force'. An attacker would need to steal the private key file itself, which is a much more difficult attack to pull off than guessing a password."
                }
            ]
        }
    },
    {
        "id": "lesson-20",
        "title": "Practical Linux Project",
        "duration": "120 min",
        "objectives": [
            "Combine previously learned skills in a practical project",
            "Update the system and install a web server (Nginx)",
            "Create and edit a simple website using command-line tools",
            "Manage file permissions and check the status of a system service"
        ],
        "content": {
            "overview": "It's time to put it all together! This capstone lesson walks you through a practical project: setting up a basic live web server. You will use package management, file operations, permissions, and service management to deploy and serve a simple HTML page.",
            "sections": [
                {
                    "title": "Step 1: System Preparation and Update",
                    "content": "<p>The first step for any new server is to ensure it is up-to-date with the latest security patches and software updates.</p><h3>Commands:</h3><ol><li><code>sudo apt update</code>: Fetches the latest list of available packages from the repositories.</li><li><code>sudo apt upgrade -y</code>: Upgrades all installed packages to their newest versions. The <code>-y</code> flag automatically answers 'yes' to any prompts.</li></ol><p>This is a critical first step that combines package management and user privilege skills.</p>",
                    "image": "https://images.unsplash.com/photo-1531297484001-80022131f5a1?w=800&h=400&fit=crop"
                },
                {
                    "title": "Step 2: Installing and Managing the Nginx Web Server",
                    "content": "<p>Next, we will install Nginx, a high-performance web server.</p><h3>Installation:</h3><code>sudo apt install nginx</code><p>Once installed, Nginx will be managed by <code>systemd</code>. You can control it with <code>systemctl</code>.</p><h3>Service Management:</h3><ul><li><code>sudo systemctl status nginx</code>: Check if the server is running.</li><li><code>sudo systemctl start nginx</code>: Start the service.</li><li><code>sudo systemctl stop nginx</code>: Stop the service.</li><li><code>sudo systemctl enable nginx</code>: Ensure the service starts automatically on boot.</li></ul><p>After installation, you should be able to navigate to your server's IP address in a web browser and see the default Nginx welcome page.</p>",
                    "image": "https://images.unsplash.com/photo-1607703750746-399c08c0953a?w=800&h=400&fit=crop"
                },
                {
                    "title": "Step 3: Creating a Custom Website",
                    "content": "<p>The default Nginx web root (where it serves files from) is located at <code>/var/www/html</code>. We will create our own simple HTML file there.</p><h3>File Creation and Editing:</h3><p>We need to use <code>sudo</code> because this directory is owned by the root user.</p><code>sudo nano /var/www/html/index.html</code><p>In the nano editor, delete the existing content and add your own simple HTML:</p><pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;title&gt;My Linux Project&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;h1&gt;Hello, World! I built this with the command line.&lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;</code></pre><p>Save the file (<code>Ctrl+O</code>) and exit (<code>Ctrl+X</code>). Now, if you refresh your web browser, you should see your new page!</p>",
                    "image": "https://images.unsplash.com/photo-1542831371-29b0f74f9713?w=800&h=400&fit=crop"
                },
                {
                    "title": "Step 4: Permissions and Final Review",
                    "content": "<p>Let's review what we've accomplished. We used a combination of skills learned throughout the course:</p><ul><li><strong>Package Management:</strong> <code>apt update</code>, <code>apt install</code>.</li><li><strong>User & Permissions:</strong> Used <code>sudo</code> for administrative tasks. The web files in <code>/var/www/html</code> need to be readable by the Nginx user. We can check this with <code>ls -l /var/www/html</code>.</li><li><strong>File System Navigation & Editing:</strong> Created and edited a file in a system directory using <code>nano</code>.</li><li><strong>Service Management:</strong> Checked the status of a background service with <code>systemctl</code>.</li><li><strong>Networking:</strong> Verified our work by accessing the server's IP address.</li></ul><p>Congratulations! You have successfully deployed a functional web server entirely from the Linux command line.</p>",
                    "image": "https://images.unsplash.com/photo-1522199755839-a2bacb67c546?w=800&h=400&fit=crop"
                }
            ],
            "codeExamples": [
                {
                    "title": "Full Project Command Sequence",
                    "language": "bash",
                    "code": "# Step 1: Update the system\nsudo apt update && sudo apt upgrade -y\n\n# Step 2: Install Nginx\nsudo apt install nginx -y\n\n# Step 3: Check Nginx status to ensure it's active and running\nsudo systemctl status nginx\n\n# Step 4: (Optional) If not running, start and enable it\n# sudo systemctl start nginx\n# sudo systemctl enable nginx\n\n# Step 5: Create a new index.html file\n# Create a simple HTML content string\nHTML_CONTENT='<!DOCTYPE html><html><body><h1>Welcome to my Linux Server!</h1></body></html>'\n# Use a pipe and tee with sudo to write the file\necho \"$HTML_CONTENT\" | sudo tee /var/www/html/index.html\n\n# Step 6: Verify the file content and permissions\ncat /var/www/html/index.html\nls -l /var/www/html/"
                }
            ]
        },
        "quiz": {
            "passingScore": 80,
            "questions": [
                {
                    "id": 1,
                    "question": "What is the first command you should run on a new server to update the package list?",
                    "options": ["sudo apt install", "sudo apt upgrade", "sudo apt update", "sudo systemctl update"],
                    "correct": 2,
                    "explanation": "`sudo apt update` is the first step. It downloads the latest package information from the repositories. `apt upgrade` then uses that information to upgrade the actual packages."
                },
                {
                    "id": 2,
                    "question": "After installing Nginx, which command checks if the service is running correctly?",
                    "options": ["sudo nginx -v", "sudo service nginx status", "sudo systemctl status nginx", "sudo check nginx"],
                    "correct": 2,
                    "explanation": "On modern systems using systemd, `systemctl status <service-name>` is the standard command to check the status of a service."
                },
                {
                    "id": 3,
                    "question": "By default, where does Nginx serve web files from?",
                    "options": ["/home/nginx", "/srv/www", "/var/www/html", "/etc/nginx/html"],
                    "correct": 2,
                    "explanation": "The default document root for Nginx on most Debian-based systems (like Ubuntu) is `/var/www/html`."
                },
                {
                    "id": 4,
                    "question": "Why is `sudo` required to edit files in `/var/www/html`?",
                    "options": ["It's a security best practice for all file edits", "The directory is owned by the `root` user", "The `nano` editor always requires `sudo`", "It prevents the web server from crashing"],
                    "correct": 1,
                    "explanation": "System directories like `/var/www/html` are owned by `root` to prevent regular users from modifying system-wide services. `sudo` is required to elevate your privileges to make changes."
                },
                {
                    "id": 5,
                    "question": "Which command ensures that the Nginx service will start automatically if the server reboots?",
                    "options": ["sudo systemctl enable nginx", "sudo systemctl reload nginx", "sudo crontab -e", "sudo systemctl startup nginx"],
                    "correct": 0,
                    "explanation": "`sudo systemctl enable nginx` creates the necessary symbolic links so that systemd will automatically start the Nginx service during the boot process."
                }
            ]
        }
    }

    ]
}
// =====================================================
// GLOBAL VARIABLES
// =====================================================
let currentUser = null;
let currentLessonIndex = 0;
let courseProgress = {};
let userStats = {};
let quizState = {
    currentQuestion: 0,
    answers: [],
    score: 0,
    isComplete: false
};

// Enhanced session tracking
let courseSession = {
    startTime: null,
    totalStudyTime: 0,
    lessonsStarted: 0,
    lessonsCompleted: 0,
    pageLoadTime: new Date(),
    interactionCount: 0,
    lastActivityTime: new Date()
};

// Music Player Variables
let audioPlayer = new Audio();

// Achievement notification system
let notificationQueue = [];
let isShowingNotification = false;

// =====================================================
// INITIALIZATION
// =====================================================
document.addEventListener('DOMContentLoaded', async () => {
    try {
        showLoadingScreen();
        await checkAuth();
        
        if (currentUser) {
            // Initialize session tracking
            startCourseSession();
            
            // Load course data and progress
            await loadCourseData();
            await loadUserProfile();
            await loadProgress();
            
            // Initialize UI
            initializeEventListeners();
            renderSidebar();
            loadLesson(currentLessonIndex);
            
            // Initialize additional features
            initMusicPlayer();
            addMusicIndicator();
            initializeActivityTracking();
            
            hideLoadingScreen();
        } else {
            openAuthModal();
        }
    } catch (error) {
        console.error('Error initializing course:', error);
        hideLoadingScreen();
        showToast('Failed to initialize course system', 'error');
    }
});

// =====================================================
// AUTHENTICATION SYSTEM
// =====================================================
async function checkAuth() {
    try {
        const { data: { session }, error } = await supabase.auth.getSession();
        
        if (error) {
            console.error('Auth error:', error);
            currentUser = null;
            openAuthModal();
            return;
        }

        if (!session) {
            currentUser = null;
            openAuthModal();
            return;
        }

        currentUser = session.user;
        updateUIWithUser();
    } catch (error) {
        console.error('Error checking auth:', error);
        currentUser = null;
        openAuthModal();
    }
}

function updateUIWithUser() {
    if (!currentUser) return;
    
    const name = currentUser.user_metadata?.full_name || currentUser.email.split('@')[0];
    const userElements = document.querySelectorAll('[data-user-name]');
    userElements.forEach(el => el.textContent = name);
}

// =====================================================
// USER PROFILE & STATS MANAGEMENT
// =====================================================
async function loadUserProfile() {
  try {
    // 🔍 Step 1: Try to fetch existing profile
    const { data: profile, error } = await supabase
      .from('profiles')
      .select('*')
      .eq('id', currentUser.id)
      .single();

    if (error && error.code !== 'PGRST116') {
      throw error;
    }

    if (!profile) {
      // 🆕 Step 2: Create new profile if missing
      await createUserProfile();
    } else {
      // ✅ Step 3: Use existing profile
      userStats = profile;
      await updateLastActivity();
    }

  } catch (error) {
    console.error('❌ Error loading user profile:', error);
    showToast('Failed to load user profile', 'error');
  }
}
async function createUserProfile() {
    try {
        const newProfile = {
            id: currentUser.id,
            full_name: currentUser.user_metadata?.full_name || '',
            email: currentUser.email,
            level: 'Script Kiddie',
            total_points: 0,
            completed_courses: 0,
            current_streak: 0,
            total_certificates: 0,
            total_achievements: 0,
            sections_visited: 0,
            bonus_points: 0,
            in_progress_courses: 0,
            settings_changed: 0,
            midnight_sessions: 0,
            early_sessions: 0,
            weekend_sessions: 0,
            last_activity: new Date().toISOString(),
            created_at: new Date().toISOString()
        };

        const { error } = await supabase
            .from('profiles')
            .insert([newProfile]);

        if (!error) {
            userStats = newProfile;
            // Award first login achievement
            setTimeout(() => checkAndUnlockAchievement('first_login'), 1000);
        }
    } catch (error) {
        console.error('Error creating user profile:', error);
    }
}

async function updateLastActivity() {
    try {
        const now = new Date();
        
        // Update activity tracking
        courseSession.lastActivityTime = now;
        
        // Update database
        await supabase
            .from('profiles')
            .update({ 
                last_activity: now.toISOString()
            })
            .eq('id', currentUser.id);

        // Check time-based achievements
        await checkTimeBasedAchievements(now);
        
    } catch (error) {
        console.error('Error updating last activity:', error);
    }
}

// =====================================================
// COURSE SESSION MANAGEMENT
// =====================================================
function startCourseSession() {
    courseSession.startTime = new Date();
    courseSession.pageLoadTime = new Date();
    
    logUserActivity('course_session_start', {
        course_id: COURSE_DATA.id,
        course_title: COURSE_DATA.title,
        user_agent: navigator.userAgent,
        screen_resolution: `${screen.width}x${screen.height}`
    });
    
    // Check daily streak
    checkDailyStreak();
}

function initializeActivityTracking() {
    // Track page focus/blur for accurate study time
    document.addEventListener('visibilitychange', handleVisibilityChange);
    
    // Track user interactions
    ['click', 'keydown', 'scroll', 'mousemove'].forEach(event => {
        document.addEventListener(event, trackUserInteraction, { passive: true });
    });
    
    // Periodic activity updates
    setInterval(updateStudyTime, 60000); // Every minute
    
    // Save session data before page unload
    window.addEventListener('beforeunload', saveSessionData);
}

function handleVisibilityChange() {
    if (document.hidden) {
        courseSession.lastActivityTime = new Date();
    } else {
        // Page became visible again - update activity
        updateLastActivity();
    }
}

function trackUserInteraction() {
    courseSession.interactionCount++;
    courseSession.lastActivityTime = new Date();
    
    // Throttle activity updates
    if (courseSession.interactionCount % 50 === 0) {
        updateLastActivity();
    }
}

function updateStudyTime() {
    if (!courseSession.startTime || document.hidden) return;
    
    const now = new Date();
    const sessionDuration = now - courseSession.startTime;
    courseSession.totalStudyTime = Math.floor(sessionDuration / 1000 / 60); // in minutes
    
    // Update progress with study time
    saveProgress();
}

function saveSessionData() {
    if (!currentUser || !courseSession.startTime) return;
    
    const sessionData = {
        user_id: currentUser.id,
        course_id: COURSE_DATA.id,
        session_duration: courseSession.totalStudyTime,
        lessons_viewed: courseSession.lessonsStarted,
        lessons_completed: courseSession.lessonsCompleted,
        interactions: courseSession.interactionCount,
        session_date: courseSession.startTime.toISOString().split('T')[0]
    };
    
    // Store in localStorage as backup
    localStorage.setItem('course_session_backup', JSON.stringify(sessionData));
    
    // Try to save to database
    logUserActivity('course_session_end', sessionData);
}

// =====================================================
// COURSE DATA & PROGRESS MANAGEMENT
// =====================================================
async function loadCourseData() {
    try {
        // Update course info in UI
        document.getElementById('courseTitle').textContent = COURSE_DATA.title;
        document.getElementById('totalLessons').textContent = COURSE_DATA.lessons.length;
        
        // Log course access
        logUserActivity('course_access', {
            course_id: COURSE_DATA.id,
            course_title: COURSE_DATA.title
        });
        
    } catch (error) {
        console.error('Error loading course data:', error);
    }
}

async function loadProgress() {
    try {
        // Get existing progress from database
        const { data, error } = await supabase
            .from('course_progress')
            .select('*')
            .eq('user_id', currentUser.id)
            .eq('course_id', COURSE_DATA.id)
            .single();

        if (error && error.code !== 'PGRST116') {
            throw error;
        }

        if (data) {
            courseProgress = JSON.parse(data.lesson_progress || '{}');
            currentLessonIndex = data.current_lesson || 0;
            
            // Update session tracking
            courseSession.lessonsStarted = Object.keys(courseProgress).length;
            courseSession.lessonsCompleted = Object.values(courseProgress).filter(p => p.completed).length;
        } else {
            // Initialize new progress
            courseProgress = {};
            currentLessonIndex = 0;
            await saveProgress();
            
            // Award first course start achievement
            await checkAndUnlockAchievement('first_course_start');
        }

        updateProgressDisplay();
        
    } catch (error) {
        console.error('Error loading progress:', error);
        showToast('Failed to load progress', 'error');
    }
}

async function saveProgress() {
    try {
        if (!currentUser) return;

        const now = new Date();
        const progressData = {
            user_id: currentUser.id,
            course_id: COURSE_DATA.id,
            course_title: COURSE_DATA.title,
            current_lesson: currentLessonIndex,
            lesson_progress: JSON.stringify(courseProgress),
            progress: calculateOverallProgress(),
            lessons_completed: getCompletedLessonsCount(),
            lessons_started: Object.keys(courseProgress).length,
            study_time_minutes: courseSession.totalStudyTime,
            last_accessed: now.toISOString(),
            updated_at: now.toISOString()
        };

        // Upsert progress
        const { error } = await supabase
            .from('course_progress')
            .upsert([progressData]);

        if (error) throw error;

        // Update user stats
        await updateUserStats();
        
        updateProgressDisplay();

    } catch (error) {
        console.error('Error saving progress:', error);
        showToast('Failed to save progress', 'error');
    }
}

async function updateUserStats() {
    try {
        // Get all course progress for this user
        const { data: allProgress, error } = await supabase
            .from('course_progress')
            .select('progress, course_id, study_time_minutes')
            .eq('user_id', currentUser.id);

        if (error) throw error;

        // Calculate stats
        const completedCourses = allProgress?.filter(p => p.progress >= 100).length || 0;
        const inProgressCourses = allProgress?.filter(p => p.progress > 0 && p.progress < 100).length || 0;
        const totalStudyTime = allProgress?.reduce((sum, p) => sum + (p.study_time_minutes || 0), 0) || 0;

        // Calculate points (500 per completed course + achievement points)
        const coursePoints = completedCourses * 500;
        const bonusPoints = userStats.bonus_points || 0;
        const totalPoints = coursePoints + bonusPoints;

        // Update profile
        const updateData = {
            completed_courses: completedCourses,
            in_progress_courses: inProgressCourses,
            total_points: totalPoints,
            total_study_time: totalStudyTime,
            last_activity: new Date().toISOString()
        };

        const { error: updateError } = await supabase
            .from('profiles')
            .update(updateData)
            .eq('id', currentUser.id);

        if (updateError) throw updateError;

        // Update local stats
        Object.assign(userStats, updateData);

    } catch (error) {
        console.error('Error updating user stats:', error);
    }
}

function calculateOverallProgress() {
    const completedLessons = getCompletedLessonsCount();
    return Math.round((completedLessons / COURSE_DATA.lessons.length) * 100);
}

function getCompletedLessonsCount() {
    return Object.values(courseProgress).filter(lesson => lesson.completed).length;
}

function updateProgressDisplay() {
    const completedCount = getCompletedLessonsCount();
    const progressPercent = calculateOverallProgress();
    
    // Update UI elements
    const elements = {
        'completedLessons': completedCount,
        'courseProgressPercent': `${progressPercent}%`
    };
    
    Object.entries(elements).forEach(([id, value]) => {
        const element = document.getElementById(id);
        if (element) element.textContent = value;
    });
    
    // Update progress bar
    const progressBar = document.getElementById('courseProgressFill');
    if (progressBar) progressBar.style.width = `${progressPercent}%`;
}

// =====================================================
// LESSON MANAGEMENT
// =====================================================
function loadLesson(index) {
    if (index < 0 || index >= COURSE_DATA.lessons.length) return;

    const lesson = COURSE_DATA.lessons[index];
    currentLessonIndex = index;

    // Mark lesson as started and track activity
    if (!courseProgress[lesson.id]) {
        courseProgress[lesson.id] = { 
            started: true, 
            completed: false,
            startedAt: new Date().toISOString(),
            timeSpent: 0
        };
        
        courseSession.lessonsStarted++;
        saveProgress();
        
        // Log lesson start
        logUserActivity('lesson_start', {
            lesson_id: lesson.id,
            lesson_title: lesson.title,
            lesson_index: index
        });
    }

    // Update lesson start time for time tracking
    courseProgress[lesson.id].currentSessionStart = new Date();

    // Update sidebar and navigation
    renderSidebar();
    updateNavigationButtons();

    // Update header info
    updateLessonHeader(lesson, index);

    // Render lesson content
    renderLessonContent(lesson);

    // Smooth scroll and animations
    window.scrollTo({ top: 0, behavior: 'smooth' });
    document.getElementById('contentBody').scrollTop = 0;

    const contentBody = document.getElementById('contentBody');
    contentBody.classList.add('fade-in');
    setTimeout(() => contentBody.classList.remove('fade-in'), 500);
    
    // Check lesson-based achievements
    checkLessonAchievements(index + 1);
}

function updateLessonHeader(lesson, index) {
    const elements = {
        'currentLessonNumber': index + 1,
        'currentLessonTitle': lesson.title,
        'navInfo': `Lesson ${index + 1} of ${COURSE_DATA.lessons.length}`
    };
    
    Object.entries(elements).forEach(([id, value]) => {
        const element = document.getElementById(id);
        if (element) element.textContent = value;
    });
}

function renderSidebar() {
    const lessonNav = document.getElementById('lessonNav');
    if (!lessonNav) return;
    
    lessonNav.innerHTML = '';

    COURSE_DATA.lessons.forEach((lesson, index) => {
        const lessonItem = document.createElement('div');
        lessonItem.className = 'lesson-item';
        
        // Determine lesson status
        const lessonProgress = courseProgress[lesson.id];
        const isCompleted = lessonProgress?.completed || false;
        const isInProgress = lessonProgress?.started || false;
        const isLocked = !isCompleted && !canAccessLesson(index);
        const isActive = index === currentLessonIndex;

        // Apply status classes
        if (isCompleted) lessonItem.classList.add('completed');
        if (isLocked) lessonItem.classList.add('locked');
        if (isActive) lessonItem.classList.add('active');

        // Determine status display
        let statusClass = 'not-started';
        let statusIcon = index + 1;
        
        if (isCompleted) {
            statusClass = 'completed';
            statusIcon = '✓';
        } else if (isInProgress) {
            statusClass = 'in-progress';
            statusIcon = '◐';
        }

        // Create lesson item HTML
        lessonItem.innerHTML = `
            <div class="lesson-status ${statusClass}">${statusIcon}</div>
            <div class="lesson-info">
                <div class="lesson-title">${lesson.title}</div>
                <div class="lesson-meta">
                    ${isCompleted ? 'Completed' : 
                      isInProgress ? 'In Progress' : 
                      isLocked ? 'Locked' : 'Not Started'}
                </div>
            </div>
            <div class="lesson-duration">${lesson.duration}</div>
        `;

        // Add click handler if not locked
        if (!isLocked) {
            lessonItem.addEventListener('click', () => {
                if (index !== currentLessonIndex) {
                    // Track lesson time before switching
                    trackLessonTime();
                    
                    currentLessonIndex = index;
                    loadLesson(index);
                    closeSidebar();
                }
            });
        }

        lessonNav.appendChild(lessonItem);
    });
}

function canAccessLesson(index) {
    if (index === 0) return true; // First lesson always accessible
    
    // Can access if previous lesson is completed
    const previousLessonId = COURSE_DATA.lessons[index - 1].id;
    return courseProgress[previousLessonId]?.completed || false;
}

function trackLessonTime() {
    const currentLesson = COURSE_DATA.lessons[currentLessonIndex];
    const lessonProgress = courseProgress[currentLesson.id];
    
    if (lessonProgress?.currentSessionStart) {
        const sessionTime = Math.floor((new Date() - new Date(lessonProgress.currentSessionStart)) / 1000 / 60);
        lessonProgress.timeSpent = (lessonProgress.timeSpent || 0) + sessionTime;
        delete lessonProgress.currentSessionStart;
    }
}

// =====================================================
// LESSON CONTENT RENDERING
// =====================================================
function renderLessonContent(lesson) {
    const contentContainer = document.getElementById('lessonContent');
    if (!contentContainer) return;
    
    let contentHTML = `
        <div class="content-section">
            <h2>Learning Objectives</h2>
            <ul>
                ${lesson.objectives.map(obj => `<li>${obj}</li>`).join('')}
            </ul>
        </div>
        
        <div class="content-section">
            <h2>Overview</h2>
            <p>${lesson.content.overview}</p>
        </div>
    `;

    // Render content sections
    lesson.content.sections.forEach(section => {
        contentHTML += `
            <div class="content-section">
                <h2>${section.title}</h2>
                ${section.content}
                ${section.image ? `<img src="${section.image}" alt="${section.title}" class="content-image" loading="lazy">` : ''}
            </div>
        `;
    });

    // Render code examples
    if (lesson.content.codeExamples && lesson.content.codeExamples.length > 0) {
        contentHTML += `<div class="content-section"><h2>Code Examples</h2></div>`;
        
        lesson.content.codeExamples.forEach((example, index) => {
            const codeId = `code-${lesson.id}-${index}`;
            contentHTML += `
                <div class="code-section">
                    <div class="code-header">
                        <span class="code-title">${example.title}</span>
                        <button class="copy-btn" onclick="copyCode('${codeId}')">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                    <pre class="code-block"><code id="${codeId}" class="language-${example.language}">${escapeHtml(example.code)}</code></pre>
                </div>
            `;
        });
    }

    // Render quiz
    contentHTML += renderQuiz(lesson.quiz);

    contentContainer.innerHTML = contentHTML;

    // Highlight code syntax if Prism is available
    setTimeout(() => {
        if (window.Prism) {
            Prism.highlightAll();
        }
    }, 100);
}

// =====================================================
// QUIZ SYSTEM
// =====================================================
function renderQuiz(quiz) {
    const currentLessonProgress = courseProgress[COURSE_DATA.lessons[currentLessonIndex].id];
    const isCompleted = currentLessonProgress?.completed || false;
    
    let quizHTML = `
        <div class="quiz-section" id="quizSection">
            <div class="quiz-header">
                <h2 class="quiz-title">
                    <i class="fas fa-clipboard-check"></i>
                    Knowledge Check
                </h2>
                <p class="quiz-info">
                    Complete this quiz with ${quiz.passingScore}% or higher to unlock the next lesson.
                </p>
            </div>
    `;

    if (isCompleted) {
        const savedScore = currentLessonProgress.quizScore || 0;
        quizHTML += `
            <div class="quiz-results show">
                <div class="quiz-score pass">${savedScore}%</div>
                <div class="quiz-message">
                    <strong>Lesson Completed!</strong><br>
                    You've successfully passed this lesson's quiz.
                </div>
            </div>
        `;
    } else {
        // Render quiz questions
        quiz.questions.forEach((question, qIndex) => {
            quizHTML += `
                <div class="quiz-question ${qIndex === 0 ? 'active' : ''}" data-question="${qIndex}">
                    <div class="question-header">
                        <span class="question-number">Question ${qIndex + 1}</span>
                        <span class="question-progress">${qIndex + 1}/${quiz.questions.length}</span>
                    </div>
                    <div class="question-text">${question.question}</div>
                    <div class="question-options">
                        ${question.options.map((option, oIndex) => `
                            <div class="option" data-option="${oIndex}" onclick="selectOption(${qIndex}, ${oIndex})">
                                <span class="option-letter">${String.fromCharCode(65 + oIndex)}</span>
                                <span class="option-text">${option}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        });

        quizHTML += `
            <div class="quiz-controls">
                <button class="btn btn-secondary" id="prevQuestionBtn" onclick="previousQuestion()" disabled>
                    <i class="fas fa-chevron-left"></i>
                    Previous
                </button>
                <div>
                    <button class="btn btn-secondary" id="nextQuestionBtn" onclick="nextQuestion()" disabled>
                        Next
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <button class="btn btn-primary" id="submitQuizBtn" onclick="submitQuiz()" style="display: none;">
                        <i class="fas fa-check"></i>
                        Submit Quiz
                    </button>
                </div>
            </div>

            <div class="quiz-results" id="quizResults">
                <div class="quiz-score" id="quizScore">0%</div>
                <div class="quiz-message" id="quizMessage"></div>
                <div class="quiz-actions">
                    <button class="btn btn-primary" id="continueBtn" onclick="completeLesson()" style="display: none;">
                        <i class="fas fa-arrow-right"></i>
                        Continue to Next Lesson
                    </button>
                    <button class="btn btn-secondary" onclick="retakeQuiz()">
                        <i class="fas fa-redo"></i>
                        Retake Quiz
                    </button>
                </div>
            </div>
        `;
    }

    quizHTML += '</div>';
    return quizHTML;
}

// Quiz interaction functions
function selectOption(questionIndex, optionIndex) {
    // Clear previous selections
    document.querySelectorAll(`[data-question="${questionIndex}"] .option`).forEach(opt => {
        opt.classList.remove('selected');
    });

    // Select current option
    const selectedOption = document.querySelector(`[data-question="${questionIndex}"] [data-option="${optionIndex}"]`);
    selectedOption.classList.add('selected');

    // Store answer
    quizState.answers[questionIndex] = optionIndex;

    // Update navigation
    const isLastQuestion = questionIndex === COURSE_DATA.lessons[currentLessonIndex].quiz.questions.length - 1;
    if (isLastQuestion) {
        document.getElementById('submitQuizBtn').style.display = 'inline-flex';
        document.getElementById('nextQuestionBtn').style.display = 'none';
    } else {
        document.getElementById('nextQuestionBtn').disabled = false;
    }
}

function nextQuestion() {
    const currentQuestionEl = document.querySelector('.quiz-question.active');
    const nextQuestionEl = currentQuestionEl.nextElementSibling;
    
    if (nextQuestionEl && nextQuestionEl.classList.contains('quiz-question')) {
        currentQuestionEl.classList.remove('active');
        nextQuestionEl.classList.add('active');
        quizState.currentQuestion++;
        updateQuizNavigation();
    }
}

function previousQuestion() {
    const currentQuestionEl = document.querySelector('.quiz-question.active');
    const prevQuestionEl = currentQuestionEl.previousElementSibling;
    
    if (prevQuestionEl && prevQuestionEl.classList.contains('quiz-question')) {
        currentQuestionEl.classList.remove('active');
        prevQuestionEl.classList.add('active');
        quizState.currentQuestion--;
        updateQuizNavigation();
    }
}

function updateQuizNavigation() {
    const totalQuestions = COURSE_DATA.lessons[currentLessonIndex].quiz.questions.length;
    const prevBtn = document.getElementById('prevQuestionBtn');
    const nextBtn = document.getElementById('nextQuestionBtn');
    const submitBtn = document.getElementById('submitQuizBtn');

    prevBtn.disabled = quizState.currentQuestion === 0;
    
    const hasAnswer = quizState.answers[quizState.currentQuestion] !== undefined;
    const isLastQuestion = quizState.currentQuestion === totalQuestions - 1;
    
    if (isLastQuestion) {
        nextBtn.style.display = 'none';
        submitBtn.style.display = hasAnswer ? 'inline-flex' : 'none';
    } else {
        nextBtn.style.display = 'inline-flex';
        nextBtn.disabled = !hasAnswer;
        submitBtn.style.display = 'none';
    }
}

async function submitQuiz() {
    const lesson = COURSE_DATA.lessons[currentLessonIndex];
    const quiz = lesson.quiz;
    let correctAnswers = 0;

    // Hide questions and controls
    document.querySelectorAll('.quiz-question').forEach(q => q.style.display = 'none');
    document.querySelector('.quiz-controls').style.display = 'none';

    // Calculate score and highlight answers
    quiz.questions.forEach((question, index) => {
        const userAnswer = quizState.answers[index];
        const correctAnswer = question.correct;
        const isCorrect = userAnswer === correctAnswer;
        
        if (isCorrect) correctAnswers++;

        // Highlight answers
        const questionEl = document.querySelector(`[data-question="${index}"]`);
        const options = questionEl.querySelectorAll('.option');
        
        options[correctAnswer].classList.add('correct');
        if (userAnswer !== correctAnswer && userAnswer !== undefined) {
            options[userAnswer].classList.add('incorrect');
        }
    });

    const score = Math.round((correctAnswers / quiz.questions.length) * 100);
    const passed = score >= quiz.passingScore;

    // Update quiz results UI
    const quizScore = document.getElementById('quizScore');
    const quizMessage = document.getElementById('quizMessage');
    const quizActions = document.querySelector('.quiz-actions');

    quizScore.textContent = `${score}%`;
    quizScore.className = `quiz-score ${passed ? 'pass' : 'fail'}`;

    if (passed) {
        quizMessage.innerHTML = `
            <strong>Congratulations!</strong><br>
            You passed with ${score}%. You can now proceed to the next lesson.
        `;
        
        quizActions.innerHTML = `
            <button class="btn btn-primary" onclick="completeLesson()">
                <i class="fas fa-arrow-right"></i>
                Continue to Next Lesson
            </button>
        `;
        
        // Mark lesson as completed
        await markLessonComplete(score);
        
    } else {
        quizMessage.innerHTML = `
            <strong>Not quite there yet.</strong><br>
            You scored ${score}%. You need ${quiz.passingScore}% to pass. Review the material and try again.
        `;
        
        quizActions.innerHTML = `
            <button class="btn btn-secondary" onclick="retakeQuiz()">
                <i class="fas fa-redo"></i>
                Retake Quiz
            </button>
        `;
    }

    document.getElementById('quizResults').classList.add('show');
    
    // Log quiz completion
    logUserActivity('quiz_completed', {
        lesson_id: lesson.id,
        lesson_title: lesson.title,
        score: score,
        passed: passed,
        attempts: (courseProgress[lesson.id]?.quizAttempts || 0) + 1
    });

    // Scroll to results
    document.getElementById('quizResults').scrollIntoView({ behavior: 'smooth' });
}

function retakeQuiz() {
    // Reset quiz state
    quizState = {
        currentQuestion: 0,
        answers: [],
        score: 0,
        isComplete: false
    };

    // Track quiz retry
    const lessonId = COURSE_DATA.lessons[currentLessonIndex].id;
    if (!courseProgress[lessonId]) courseProgress[lessonId] = {};
    courseProgress[lessonId].quizAttempts = (courseProgress[lessonId].quizAttempts || 0) + 1;

    // Reload lesson content
    loadLesson(currentLessonIndex);
    
    // Scroll to quiz
    setTimeout(() => {
        document.getElementById('quizSection').scrollIntoView({ behavior: 'smooth' });
    }, 500);
}

async function markLessonComplete(score) {
    const lesson = COURSE_DATA.lessons[currentLessonIndex];
    const lessonId = lesson.id;
    
    // Track lesson completion time
    trackLessonTime();
    
    // Update lesson progress
    courseProgress[lessonId] = {
        ...courseProgress[lessonId],
        completed: true,
        quizScore: score,
        completedAt: new Date().toISOString(),
        finalScore: score
    };

    // Update session tracking
    courseSession.lessonsCompleted++;

    // Save progress to database
    await saveProgress();
    
    // Update UI
    renderSidebar();
    updateNavigationButtons();

    // Check various achievements
    await checkLessonCompletionAchievements();
    await checkPerfectScoreAchievements(score);
    await checkStudyTimeAchievements();
    
    // Log lesson completion
    logUserActivity('lesson_completed', {
        lesson_id: lessonId,
        lesson_title: lesson.title,
        final_score: score,
        time_spent: courseProgress[lessonId].timeSpent || 0,
        lesson_number: currentLessonIndex + 1
    });
    
    showToast('Lesson completed successfully!', 'success');
}

async function completeLesson() {
    if (currentLessonIndex < COURSE_DATA.lessons.length - 1) {
        // Move to next lesson
        currentLessonIndex++;
        loadLesson(currentLessonIndex);
        
    } else {
        // Course completion
        await completeCourse();
    }
}

async function completeCourse() {
    try {
        const completionTime = courseSession.totalStudyTime;
        
        // Update course progress to 100% completed
        await supabase
            .from('course_progress')
            .update({
                progress: 100,
                completed_at: new Date().toISOString(),
                completion_time_minutes: completionTime
            })
            .eq('user_id', currentUser.id)
            .eq('course_id', COURSE_DATA.id);

        // Award course completion achievements
        await checkAndUnlockAchievement('course_completion_1');
        await checkSpeedCompletionAchievements(completionTime);
        await checkCourseStreakAchievements();
        
        // Update user stats
        await updateUserStats();
        
        // Show completion message
        showToast('Congratulations! Course completed successfully!', 'certificate');
        
        // Log course completion
        logUserActivity('course_completed', {
            course_id: COURSE_DATA.id,
            course_title: COURSE_DATA.title,
            completion_time_minutes: completionTime,
            total_lessons: COURSE_DATA.lessons.length,
            average_quiz_score: calculateAverageQuizScore()
        });
        
        // Redirect to dashboard after delay
        setTimeout(() => {
            window.location.href = '/dashboard.html';
        }, 3000);
        
    } catch (error) {
        console.error('Error completing course:', error);
        showToast('Error marking course as complete', 'error');
    }
}

// =====================================================
// ACHIEVEMENT INTEGRATION SYSTEM
// =====================================================
async function checkAndUnlockAchievement(achievementId, skipNotification = false) {
    try {
        // Prevent duplicate checks
        const cacheKey = `achievement_${achievementId}_${currentUser.id}`;
        if (sessionStorage.getItem(cacheKey)) return false;

        // Check if already unlocked
        const { data: existing, error } = await supabase
            .from('user_achievements')
            .select('id')
            .eq('user_id', currentUser.id)
            .eq('achievement_id', achievementId)
            .single();

        if (existing) {
            sessionStorage.setItem(cacheKey, 'true');
            return false;
        }

        // Award achievement
        const achievementData = {
            user_id: currentUser.id,
            achievement_id: achievementId,
            unlocked_at: new Date().toISOString(),
            points_awarded: getAchievementPoints(achievementId),
            context: 'course_system'
        };

        const { data, error: insertError } = await supabase
            .from('user_achievements')
            .insert([achievementData])
            .select()
            .single();

        if (insertError) {
            if (insertError.code === '23505') return false; // Already exists
            throw insertError;
        }

        // Update user points
        await supabase.rpc('increment_user_stats', {
  user_id_param: currentUser.id,
  points_to_add: achievementData.points_awarded,
  achievements_to_add: 1
});

        // Cache and queue notification
        sessionStorage.setItem(cacheKey, 'true');
        
        if (!skipNotification) {
            queueAchievementNotification({
                id: achievementId,
                name: getAchievementName(achievementId),
                description: getAchievementDescription(achievementId),
                points: achievementData.points_awarded,
                rarity: getAchievementRarity(achievementId),
                icon: getAchievementIcon(achievementId)
            });
        }

        return true;

    } catch (error) {
        console.error('Error unlocking achievement:', error);
        return false;
    }
}

// Helper functions for achievement data (replace with your actual achievement definitions)
function getAchievementPoints(id) {
    const pointsMap = {
        'first_course_start': 75,
        'first_lesson': 100,
        'course_completion_1': 500,
        'perfect_score': 250,
        'speed_demon': 750,
        'marathon_learner': 500,
        'night_owl': 200,
        'early_bird': 200,
        'weekend_warrior': 150,
        // Add more as needed
    };
    return pointsMap[id] || 100;
}

function getAchievementName(id) {
    const nameMap = {
        'first_course_start': 'Learning Initiated',
        'first_lesson': 'First Steps',
        'course_completion_1': 'Course Conqueror',
        'perfect_score': 'Perfectionist',
        'speed_demon': 'Speed Demon',
        // Add more as needed
    };
    return nameMap[id] || 'Achievement Unlocked';
}

function getAchievementDescription(id) {
    const descMap = {
        'first_course_start': 'Start your first cybersecurity course',
        'first_lesson': 'Complete your first lesson',
        'course_completion_1': 'Complete your first course',
        'perfect_score': 'Score 100% on any quiz',
        'speed_demon': 'Complete a course in under 2 hours',
        // Add more as needed
    };
    return descMap[id] || 'Achievement description';
}

function getAchievementRarity(id) {
    const rarityMap = {
        'first_course_start': 'common',
        'first_lesson': 'bronze',
        'course_completion_1': 'silver',
        'perfect_score': 'gold',
        'speed_demon': 'legendary',
        // Add more as needed
    };
    return rarityMap[id] || 'common';
}

function getAchievementIcon(id) {
    const iconMap = {
        'first_course_start': 'fas fa-play',
        'first_lesson': 'fas fa-baby',
        'course_completion_1': 'fas fa-trophy',
        'perfect_score': 'fas fa-star',
        'speed_demon': 'fas fa-rocket',
        // Add more as needed
    };
    return iconMap[id] || 'fas fa-award';
}

async function checkLessonAchievements(lessonNumber) {
    if (lessonNumber === 1) {
        await checkAndUnlockAchievement('first_lesson');
    }
    
    // Check if user has completed multiple lessons in one day
    const today = new Date().toISOString().split('T')[0];
    const todayCompletions = Object.values(courseProgress).filter(p => 
        p.completed && p.completedAt?.startsWith(today)
    ).length;
    
    if (todayCompletions >= 3) {
        await checkAndUnlockAchievement('lesson_marathon');
    }
}

async function checkLessonCompletionAchievements() {
    const completedCount = getCompletedLessonsCount();
    
    // Lesson-based achievements
    const lessonMilestones = [1, 5, 10, 25, 50, 100];
    for (const milestone of lessonMilestones) {
        if (completedCount >= milestone) {
            await checkAndUnlockAchievement(`lessons_${milestone}`);
        }
    }
    
    // Course completion achievements
    if (completedCount === COURSE_DATA.lessons.length) {
        await checkAndUnlockAchievement('course_completion_1');
        
        // Check for additional course completion achievements
        const { data: allCourses } = await supabase
            .from('course_progress')
            .select('course_id')
            .eq('user_id', currentUser.id)
            .eq('progress', 100);
        
        const totalCompleted = allCourses?.length || 0;
        
        const courseMilestones = [1, 5, 10, 25];
        for (const milestone of courseMilestones) {
            if (totalCompleted >= milestone) {
                await checkAndUnlockAchievement(`course_completion_${milestone}`);
            }
        }
    }
}

async function checkPerfectScoreAchievements(score) {
    if (score === 100) {
        await checkAndUnlockAchievement('perfect_score');
        
        // Check for consecutive perfect scores
        const recentScores = Object.values(courseProgress)
            .filter(p => p.completed && p.quizScore)
            .slice(-5) // Last 5 completed
            .map(p => p.quizScore);
        
        if (recentScores.length >= 3 && recentScores.every(s => s === 100)) {
            await checkAndUnlockAchievement('perfectionist_streak');
        }
    }
}

async function checkSpeedCompletionAchievements(completionTime) {
    // Speed demon: Complete course in under 2 hours (120 minutes)
    if (completionTime <= 120) {
        await checkAndUnlockAchievement('speed_demon');
    }
    
    // Quick learner: Complete course in under 4 hours (240 minutes)
    if (completionTime <= 240) {
        await checkAndUnlockAchievement('quick_learner');
    }
}

async function checkStudyTimeAchievements() {
    const totalTime = courseSession.totalStudyTime;
    
    // Marathon learner: Study for 8+ hours in a course session
    if (totalTime >= 480) { // 8 hours
        await checkAndUnlockAchievement('marathon_learner');
    }
    
    // Dedicated learner: Study for 4+ hours
    if (totalTime >= 240) { // 4 hours
        await checkAndUnlockAchievement('dedicated_learner');
    }
}

async function checkCourseStreakAchievements() {
    try {
        // Check for consecutive course completions
        const { data: recentCourses, error } = await supabase
            .from('course_progress')
            .select('completed_at, course_id')
            .eq('user_id', currentUser.id)
            .eq('progress', 100)
            .order('completed_at', { ascending: false })
            .limit(10);

        if (error || !recentCourses) return;

        // Check for courses completed on consecutive days
        let consecutiveDays = 1;
        for (let i = 1; i < recentCourses.length; i++) {
            const prevDate = new Date(recentCourses[i-1].completed_at).toDateString();
            const currentDate = new Date(recentCourses[i].completed_at).toDateString();
            const dayDiff = Math.abs(new Date(prevDate) - new Date(currentDate)) / (1000 * 60 * 60 * 24);
            
            if (dayDiff <= 1) {
                consecutiveDays++;
            } else {
                break;
            }
        }

        if (consecutiveDays >= 3) {
            await checkAndUnlockAchievement('learning_streak');
        }

    } catch (error) {
        console.error('Error checking course streak achievements:', error);
    }
}

// =====================================================
// TIME-BASED ACHIEVEMENTS
// =====================================================
async function checkTimeBasedAchievements(timestamp) {
    const hour = timestamp.getHours();
    const dayOfWeek = timestamp.getDay();

    // Night owl (after midnight, before 6 AM)
    if (hour >= 0 && hour < 6) {
        await incrementTimeBasedCounter('midnight_sessions', 'night_owl');
    }

    // Early bird (4 AM to 6 AM)
    if (hour >= 4 && hour < 6) {
        await incrementTimeBasedCounter('early_sessions', 'early_bird');
    }

    // Weekend warrior (Saturday = 6, Sunday = 0)
    if (dayOfWeek === 0 || dayOfWeek === 6) {
        await incrementTimeBasedCounter('weekend_sessions', 'weekend_warrior');
    }
}

async function incrementTimeBasedCounter(counterType, achievementId) {
    try {
        const dateStr = new Date().toISOString().split('T')[0];
        const cacheKey = `${counterType}_${currentUser.id}_${dateStr}`;

        // Prevent multiple increments per day
        if (sessionStorage.getItem(cacheKey)) return;

        // Update counter
        await supabase
            .from('profiles')
            .update({
                [counterType]: supabase.sql`${counterType} + 1`
            })
            .eq('id', currentUser.id);

        // Cache to prevent double counting
        sessionStorage.setItem(cacheKey, 'true');

        // Check related achievement
        if (achievementId) {
            await checkAndUnlockAchievement(achievementId, true);
        }

    } catch (error) {
        console.error(`Error incrementing ${counterType}:`, error);
    }
}

async function checkDailyStreak() {
    try {
        const { data: profile, error } = await supabase
            .from('profiles')
            .select('last_activity, current_streak, last_streak_date')
            .eq('id', currentUser.id)
            .single();

        if (error) throw error;

        const now = new Date();
        const today = now.toDateString();
        const lastActivity = profile.last_activity ? new Date(profile.last_activity) : null;
        const lastStreakDate = profile.last_streak_date ? new Date(profile.last_streak_date).toDateString() : null;

        let newStreak = profile.current_streak || 0;
        let shouldUpdateStreak = false;

        if (!lastActivity) {
            // First time user
            newStreak = 1;
            shouldUpdateStreak = true;
        } else {
            const daysSinceLastActivity = Math.floor((now - lastActivity) / (1000 * 60 * 60 * 24));
            
            if (lastStreakDate === today) {
                // Already counted today's streak
                return newStreak;
            } else if (daysSinceLastActivity === 1 || (daysSinceLastActivity === 0 && lastStreakDate !== today)) {
                // Consecutive day or same day but not counted yet
                newStreak += 1;
                shouldUpdateStreak = true;
            } else if (daysSinceLastActivity > 1) {
                // Streak broken
                newStreak = 1;
                shouldUpdateStreak = true;
            }
        }

        if (shouldUpdateStreak) {
            await supabase
                .from('profiles')
                .update({
                    current_streak: newStreak,
                    last_activity: now.toISOString(),
                    last_streak_date: now.toISOString()
                })
                .eq('id', currentUser.id);

            userStats.current_streak = newStreak;
            
            showToast(`Daily streak: ${newStreak} days!`, 'success');
            await checkStreakAchievements(newStreak);
        }

        return newStreak;
        
    } catch (error) {
        console.error('Error checking daily streak:', error);
        return 0;
    }
}

async function checkStreakAchievements(currentStreak) {
    const streakMilestones = [3, 7, 14, 30, 100, 365];
    
    for (const milestone of streakMilestones) {
        if (currentStreak >= milestone) {
            await checkAndUnlockAchievement(`streak_${milestone}`);
        }
    }
}

// =====================================================
// USER ACTIVITY LOGGING
// =====================================================
async function logUserActivity(activityType, metadata = {}) {
    try {
        const now = new Date();
        
        const activityData = {
            user_id: currentUser.id,
            activity_type: activityType,
            timestamp: now.toISOString(),
            course_id: COURSE_DATA.id,
            lesson_index: currentLessonIndex,
            session_duration: courseSession.totalStudyTime,
            metadata: JSON.stringify(metadata),
            created_at: now.toISOString()
        };

        // Try to log to activities table
        const { error } = await supabase
            .from('user_activities')
            .insert([activityData]);

        if (error && error.code !== '42P01') {
            console.warn('Activity logging failed:', error.message);
        }

        // Always update last activity in profile
        await supabase
            .from('profiles')
            .update({ last_activity: now.toISOString() })
            .eq('id', currentUser.id);

    } catch (error) {
        console.error('Error logging user activity:', error);
    }
}

// =====================================================
// NAVIGATION SYSTEM
// =====================================================
function updateNavigationButtons() {
    const prevBtn = document.getElementById('prevLessonBtn');
    const nextBtn = document.getElementById('nextLessonBtn');
    
    if (!prevBtn || !nextBtn) return;

    // Previous button
    prevBtn.disabled = currentLessonIndex === 0;
    
    // Next button logic
    const isLastLesson = currentLessonIndex === COURSE_DATA.lessons.length - 1;
    const canGoNext = currentLessonIndex < COURSE_DATA.lessons.length - 1 && 
                     canAccessLesson(currentLessonIndex + 1);
    
    if (isLastLesson) {
        const isCurrentCompleted = courseProgress[COURSE_DATA.lessons[currentLessonIndex].id]?.completed;
        nextBtn.disabled = !isCurrentCompleted;
        nextBtn.innerHTML = '<i class="fas fa-trophy"></i> Complete Course';
    } else {
        nextBtn.disabled = !canGoNext;
        nextBtn.innerHTML = 'Next <i class="fas fa-chevron-right"></i>';
    }
}

// Navigation button event handlers
function goToPreviousLesson() {
    if (currentLessonIndex > 0) {
        trackLessonTime(); // Track time spent on current lesson
        currentLessonIndex--;
        loadLesson(currentLessonIndex);
    }
}

function goToNextLesson() {
    if (currentLessonIndex < COURSE_DATA.lessons.length - 1) {
        const canGoNext = canAccessLesson(currentLessonIndex + 1);
        if (canGoNext) {
            trackLessonTime();
            currentLessonIndex++;
            loadLesson(currentLessonIndex);
        } else {
            showToast('Complete the current lesson quiz to proceed', 'warning');
        }
    } else {
        // Complete course
        completeCourse();
    }
}

// =====================================================
// SIDEBAR FUNCTIONS
// =====================================================
function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebarOverlay');
    
    if (sidebar) sidebar.classList.toggle('open');
    if (overlay) overlay.classList.toggle('active');
}

function closeSidebar() {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebarOverlay');
    
    if (sidebar) sidebar.classList.remove('open');
    if (overlay) overlay.classList.remove('active');
}

// =====================================================
// ACHIEVEMENT NOTIFICATION SYSTEM
// =====================================================
function queueAchievementNotification(achievement) {
    notificationQueue.push(achievement);
    processNotificationQueue();
}

function processNotificationQueue() {
    if (isShowingNotification || notificationQueue.length === 0) return;

    isShowingNotification = true;
    const achievement = notificationQueue.shift();
    showAchievementNotification(achievement);

    const duration = achievement.rarity === 'mythic' ? 8000 :
                     achievement.rarity === 'legendary' ? 7000 : 6000;

    setTimeout(() => {
        isShowingNotification = false;
        processNotificationQueue();
    }, duration + 500);
}

function showAchievementNotification(achievement) {
    const notification = document.getElementById('achievementNotification');
    if (!notification) return;

    const icon = document.getElementById('notificationIcon');
    const title = document.getElementById('notificationTitle');
    const description = document.getElementById('notificationDescription');
    const points = document.getElementById('notificationPoints');

    if (icon) {
        icon.innerHTML = `<i class="${achievement.icon}"></i>`;
        icon.className = `notification-icon ${achievement.rarity}`;
    }
    if (title) title.textContent = achievement.name;
    if (description) description.textContent = achievement.description;
    if (points) points.textContent = `+${achievement.points} Points`;

    notification.className = `achievement-notification ${achievement.rarity}`;
    notification.classList.add('show');

    const duration = achievement.rarity === 'mythic' ? 8000 :
                     achievement.rarity === 'legendary' ? 7000 : 6000;

    setTimeout(() => {
        notification.classList.remove('show');
    }, duration);
}

// =====================================================
// UTILITY FUNCTIONS
// =====================================================
function calculateAverageQuizScore() {
    const scores = Object.values(courseProgress)
        .filter(p => p.completed && p.quizScore)
        .map(p => p.quizScore);
    
    if (scores.length === 0) return 0;
    return Math.round(scores.reduce((sum, score) => sum + score, 0) / scores.length);
}

async function resetProgress() {
    if (!confirm('Are you sure you want to reset your progress? This action cannot be undone.')) {
        return;
    }

    try {
        // Track lesson time before reset
        trackLessonTime();
        
        // Reset local state
        courseProgress = {};
        currentLessonIndex = 0;
        courseSession = {
            startTime: new Date(),
            totalStudyTime: 0,
            lessonsStarted: 0,
            lessonsCompleted: 0,
            pageLoadTime: new Date(),
            interactionCount: 0,
            lastActivityTime: new Date()
        };
        
        // Delete from database
        await supabase
            .from('course_progress')
            .delete()
            .eq('user_id', currentUser.id)
            .eq('course_id', COURSE_DATA.id);

        // Log reset activity
        logUserActivity('progress_reset', {
            course_id: COURSE_DATA.id,
            reset_reason: 'manual'
        });

        // Reinitialize
        await saveProgress();
        renderSidebar();
        loadLesson(0);
        
        showToast('Progress reset successfully', 'success');
        
    } catch (error) {
        console.error('Error resetting progress:', error);
        showToast('Failed to reset progress', 'error');
    }
}

function copyCode(codeId) {
    const codeElement = document.getElementById(codeId);
    if (!codeElement) return;
    
    const text = codeElement.textContent;
    
    navigator.clipboard.writeText(text).then(() => {
        showToast('Code copied to clipboard!', 'success');
        
        // Track code copy for achievements
        logUserActivity('code_copied', {
            code_section: codeId,
            lesson_id: COURSE_DATA.lessons[currentLessonIndex].id
        });
        
    }).catch(err => {
        console.error('Failed to copy code:', err);
        showToast('Failed to copy code', 'error');
        
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.select();
        try {
            document.execCommand('copy');
            showToast('Code copied to clipboard!', 'success');
        } catch (fallbackError) {
            showToast('Copy failed - please select and copy manually', 'error');
        }
        document.body.removeChild(textArea);
    });
}

function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

// =====================================================
// UI FEEDBACK SYSTEMS
// =====================================================
function showToast(message, type = 'success') {
    const toast = document.getElementById('toast');
    const messageEl = document.getElementById('toastMessage');
    
    if (!toast || !messageEl) {
        console.log(`Toast: ${message} (${type})`);
        return;
    }
    
    messageEl.textContent = message;
    toast.className = `toast ${type} show`;

    setTimeout(() => {
        toast.classList.remove('show');
    }, 4000);
}

function showLoadingScreen() {
    const loadingScreen = document.getElementById('loadingScreen');
    if (loadingScreen) loadingScreen.classList.remove('hidden');
}

function hideLoadingScreen() {
    const loadingScreen = document.getElementById('loadingScreen');
    if (loadingScreen) {
        setTimeout(() => {
            loadingScreen.classList.add('hidden');
        }, 1000);
    }
}

// =====================================================
// MUSIC PLAYER INTEGRATION
// =====================================================
function initMusicPlayer() {
    const btnText = document.getElementById('music-button-text');
    const icon = document.getElementById('music-icon');
    const dropdown = document.getElementById('music-dropdown-content');
    
    if (!btnText || !icon || !dropdown) return;
    
    function setUI(state) {
        btnText.textContent = state === "Playing" ? "PAUSE MUSIC" : "STUDY MUSIC";
        icon.className = state === "Playing" ? "fa-solid fa-circle-pause" : "fa-solid fa-music";
    }

    // Load saved music state
    const savedSrc = localStorage.getItem("cybersec_music_src");
    const savedTime = parseFloat(localStorage.getItem("cybersec_music_time") || 0);
    
    if (savedSrc) {
        audioPlayer.src = savedSrc;
        audioPlayer.currentTime = savedTime;
        audioPlayer.play()
            .then(() => setUI("Playing"))
            .catch(() => setUI("Stopped"));
    }

    // Music button click handler
    document.getElementById('music-dropdown').querySelector('button').addEventListener('click', (e) => {
        e.stopPropagation();
        dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
        
        if (audioPlayer.src && !audioPlayer.paused) {
            audioPlayer.pause();
            setUI("Stopped");
        } else if (audioPlayer.src) {
            audioPlayer.play().then(() => setUI("Playing"));
        }
    });

    // Music selection handlers
    dropdown.querySelectorAll("a[data-src]").forEach((link) => {
        link.addEventListener("click", (e) => {
            e.preventDefault();
            audioPlayer.src = link.dataset.src;
            audioPlayer.play().then(() => setUI("Playing"));
            localStorage.setItem("cybersec_music_src", link.dataset.src);
            dropdown.style.display = "none";
        });
    });

    // Stop music handler
    const stopLink = document.getElementById("stop-music-link");
    if (stopLink) {
        stopLink.addEventListener("click", (e) => {
            e.preventDefault();
            audioPlayer.pause();
            audioPlayer.currentTime = 0;
            audioPlayer.removeAttribute("src");
            setUI("Stopped");
            localStorage.removeItem("cybersec_music_src");
            localStorage.removeItem("cybersec_music_time");
            dropdown.style.display = "none";
        });
    }

    // Save music state before page unload
    window.addEventListener("beforeunload", () => {
        if (!audioPlayer.paused && audioPlayer.src) {
            localStorage.setItem("cybersec_music_src", audioPlayer.src);
            localStorage.setItem(
                "cybersec_music_time",
                audioPlayer.currentTime
            );
        }
    });

    // Close dropdown when clicking outside
    window.addEventListener("click", (e) => {
        if (!e.target.closest("#music-dropdown")) {
            dropdown.style.display = "none";
        }
    });
}

// Show initial music indicator
function addMusicIndicator() {
    const musicBtn = document.querySelector("#music-dropdown");
    if (musicBtn) {
        const indicator = document.createElement("div");
        indicator.className = "music-indicator";
        indicator.innerHTML = `<i class="fa-solid fa-music"></i> Try Study Music!`;

        musicBtn.style.position = "relative";
        musicBtn.appendChild(indicator);

        setTimeout(() => indicator.remove(), 3000);
    }
}

// Initialize Event Listeners
function initializeEventListeners() {
    // Navigation buttons
    document.getElementById('prevLessonBtn')?.addEventListener('click', goToPreviousLesson);
    document.getElementById('nextLessonBtn')?.addEventListener('click', goToNextLesson);

    // Reset progress button
    document.getElementById('resetProgressBtn')?.addEventListener('click', resetProgress);

    // Mobile menu toggle
    document.getElementById('menuToggle')?.addEventListener('click', toggleSidebar);
    document.getElementById('sidebarOverlay')?.addEventListener('click', closeSidebar);

    // Keyboard shortcuts
    document.addEventListener('keydown', handleKeyboardShortcuts);

    // Window resize handler
    window.addEventListener('resize', handleWindowResize);

    // Content interaction tracking
    document.getElementById('contentBody')?.addEventListener('scroll', debounce(() => {
        trackUserInteraction();
    }, 1000));
}

// Keyboard Shortcuts
function handleKeyboardShortcuts(e) {
    if (document.querySelector('.quiz-question.active')) return;

    if (e.key === 'ArrowLeft' && e.ctrlKey) {
        e.preventDefault();
        goToPreviousLesson();
    } else if (e.key === 'ArrowRight' && e.ctrlKey) {
        e.preventDefault();
        goToNextLesson();
    }
}

// Window Resize Handler
function handleWindowResize() {
    if (window.innerWidth > 768) {
        closeSidebar();
    }
}

// Debounce Helper
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// Initialize responsive behavior
if (window.innerWidth <= 768) {
    document.getElementById('menuToggle').style.display = 'inline-flex';
}

// Auto-save progress periodically
setInterval(async () => {
    if (currentUser && Object.keys(courseProgress).length > 0) {
        await saveProgress();
    }
}, 60000); // Save every minute

// System initialization logging
console.log('CyberSec Academy Course System Initialized');
console.log('Current Course:', COURSE_DATA.title);
console.log('Total Lessons:', COURSE_DATA.lessons.length);

// Google OAuth Integration
const googleBtn = document.querySelector(".btn-google");
if (googleBtn) {
    googleBtn.addEventListener("click", async () => {
        const { data, error } = await supabase.auth.signInWithOAuth({
            provider: "google",
            options: {
                redirectTo: window.location.origin + "/courses/linux-command-line-basics.html",
            },
        });

        if (error) {
            console.error("Google login error:", error.message);
            showToast("Google login failed: " + error.message, "error");
        }
    });
}

// Check for existing session
supabase.auth.getSession().then(({ data }) => {
    if (data.session) {
        console.log("User already logged in:", data.session.user);
        currentUser = data.session.user;
        startCourseSession();
    }
});


// Add missing auth modal functions
function openAuthModal() {
    const modal = document.getElementById('authModal');
    if (modal) {
        modal.style.display = 'flex';
    }
}

function closeAuthModal() {
    const modal = document.getElementById('authModal');
    if (modal) {
        modal.style.display = 'none';
    }
}

// Add auth tab switching functionality
document.getElementById('tabSignIn')?.addEventListener('click', () => {
    document.getElementById('tabSignIn').classList.add('active');
    document.getElementById('tabSignUp').classList.remove('active');
    document.getElementById('signInForm').style.display = 'block';
    document.getElementById('signUpForm').style.display = 'none';
});

document.getElementById('tabSignUp')?.addEventListener('click', () => {
    document.getElementById('tabSignUp').classList.add('active');
    document.getElementById('tabSignIn').classList.remove('active');
    document.getElementById('signUpForm').style.display = 'block';
    document.getElementById('signInForm').style.display = 'none';
});

document.getElementById('closeAuthModal')?.addEventListener('click', closeAuthModal);

// Improved error handling for auth session
supabase.auth.onAuthStateChange((event, session) => {
    if (event === 'SIGNED_IN') {
        currentUser = session.user;
        closeAuthModal();
        startCourseSession();
    } else if (event === 'SIGNED_OUT') {
        currentUser = null;
        openAuthModal();
    }
});

// Add form submission handlers
document.getElementById('emailSignInForm')?.addEventListener('submit', async (e) => {
    e.preventDefault();
    const email = document.getElementById('signInEmail').value;
    const password = document.getElementById('signInPassword').value;
    
    try {
        const { data, error } = await supabase.auth.signInWithPassword({
            email,
            password
        });
        
        if (error) throw error;
        
        closeAuthModal();
    } catch (error) {
        showToast(error.message, 'error');
    }
});

document.getElementById('emailSignUpForm')?.addEventListener('submit', async (e) => {
    e.preventDefault();
    const email = document.getElementById('signUpEmail').value;
    const password = document.getElementById('signUpPassword').value;
    const name = document.getElementById('signUpName').value;
    
    try {
        const { data, error } = await supabase.auth.signUp({
            email,
            password,
            options: {
                data: {
                    full_name: name
                }
            }
        });
        
        if (error) throw error;
        
        showToast('Account created successfully! Please check your email.', 'success');
    } catch (error) {
        showToast(error.message, 'error');
    }
});
    </script>
</body>

</html>
