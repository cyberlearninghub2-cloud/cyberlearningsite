




<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Windows & Linux Administration Course Curriculum | CipherHall</title>
    <meta name="description" content="Begin your free course in system administration. This curriculum covers Windows Server and Linux, including user management, file systems, networking, and virtualization." />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon.png" />
    <link rel="shortcut icon" href="/favicon.png" type="image/x-icon" />
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon.png" />
    <link rel="canonical" href="https://www.cipherhall.com/courses/windows-linux-administration.html" />

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Course",
      "name": "Windows & Linux Administration",
      "description": "A comprehensive, dual-track guide to mastering system administration on both Windows Server and Linux.",
      "provider": {
        "@type": "Organization",
        "name": "CipherHall",
        "sameAs": "https://www.cipherhall.com"
      },
      "hasCourseInstance": {
        "@type": "CourseInstance",
        "courseMode": "Online",
        "instructor": {
          "@type": "Person",
          "name": "Dr. Anya Sharma"
        }
      }
    }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Exo+2:wght@700;800;900&display=swap" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.7/dist/umd/supabase.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" />
    <link rel="stylesheet" href="assets/css/coursepages.css">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loader-icon">
            <i class="fas fa-graduation-cap"></i>
        </div>
        <div class="loader-text">Loading Course Content...</div>
    </div>
    
    <!-- Sidebar Overlay for Mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    
    <!-- Music Player (fixed at top right) -->
    <div class="header-controls">
        <div class="music-dropdown" id="music-dropdown">
            <button class="btn btn-secondary">
                <span id="music-button-text">STUDY MUSIC</span>
                <i id="music-icon" class="fa-solid fa-music"></i>
            </button>
            <div class="music-dropdown-content" id="music-dropdown-content">
                <a href="#" data-src="https://www.learningcontainer.com/wp-content/uploads/2020/02/Kalimba.mp3">1. Coffee Shop Vibes</a>
                <a href="#" data-src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-16.mp3">2. City Lights Lofi</a>
                <a href="#" data-src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-15.mp3">3. Mellow Thoughts</a>
                <a href="#" data-src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-13.mp3">4. Rainy Mood</a>
                <a href="#" data-src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-10.mp3">5. Time Alone</a>
                <a href="#" id="stop-music-link"><i class="fa-solid fa-stop-circle"></i> Stop Music</a>
            </div>
        </div>
        
        <button class="btn btn-secondary" id="resetProgressBtn">
            <i class="fas fa-redo"></i>
            Reset Progress
        </button>
    </div>

    <!-- Auth Modal -->
    <div id="authModal" class="modal" style="display: none">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <span class="close" id="closeAuthModal">&times;</span>
            <div class="auth-tabs">
                <button id="tabSignIn" class="auth-tab active">Sign In</button>
                <button id="tabSignUp" class="auth-tab">Sign Up</button>
            </div>
            <div id="authLoader" style="display: none; text-align: center; padding: 2rem">
                <i class="fas fa-spinner fa-spin fa-2x" style="color: var(--color-green)"></i>
                <p style="margin-top: 0.5rem">Authenticating...</p>
            </div>
            <div id="signInForm" class="auth-form">
                <h2>Sign In to CipherHall</h2>
                <button id="googleSignIn" class="btn btn-google">
                    <i class="fab fa-google"></i> Continue with Google
                </button>
                <div class="divider"><span>or</span></div>
                <form id="emailSignInForm">
                    <input type="email" id="signInEmail" placeholder="Email Address" required>
                    <input type="password" id="signInPassword" placeholder="Password" required>
                    <button type="submit" class="btn btn-primary">Sign In</button>
                </form>
            </div>
            <div id="signUpForm" class="auth-form" style="display: none">
                <h2>Join CipherHall</h2>
                <button id="googleSignUp" class="btn btn-google">
                    <i class="fab fa-google"></i> Continue with Google
                </button>
                <div class="divider"><span>or</span></div>
                <form id="emailSignUpForm">
                    <input type="text" id="signUpName" placeholder="Full Name" required>
                    <input type="email" id="signUpEmail" placeholder="Email Address" required>
                    <input type="password" id="signUpPassword" placeholder="Password (min. 8 characters)" required>
                    <button type="submit" class="btn btn-secondary">Create Account</button>
                </form>
            </div>
            <div id="authMessage"></div>
        </div>
    </div>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="course-info">
                <h1 class="course-title" id="courseTitle">Loading...</h1>
                <div class="course-progress">
                    <div class="progress-header">
                        <span class="progress-label">Course Progress</span>
                        <span class="progress-percentage" id="courseProgressPercent">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="courseProgressFill" style="width: 0%"></div>
                    </div>
                    <div class="progress-stats">
                        <span id="completedLessons">0</span>
                        <span id="totalLessons">0</span>
                    </div>
                </div>
                <a href="/dashboard.html" class="back-to-dashboard">
                    <i class="fas fa-arrow-left"></i>
                    Back to Dashboard
                </a>
            </div>
        </div>

        <nav class="lesson-nav" id="lessonNav">
            <!-- Lessons will be loaded dynamically -->
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <header class="content-header">
            <div class="lesson-header">
                <div class="lesson-header-left">
                    <span class="lesson-number" id="currentLessonNumber">1</span>
                    <h1 class="lesson-header-title" id="currentLessonTitle">Loading...</h1>
                </div>
                <div class="lesson-actions">
                    <button class="mbtn btn-primary" id="menuToggle">
                        <i class="fas fa-bars"></i>
                       
                    </button>
                </div>
            </div>
        </header>

        <div class="content-body" id="contentBody">
            <div class="lesson-content" id="lessonContent">
                <!-- Lesson content will be loaded dynamically -->
            </div>
        </div>

        <footer class="lesson-navigation">
            <div class="nav-info" id="navInfo">
                Lesson 1 of 10
            </div>
            <div class="nav-controls">
                <button class="btn btn-secondary" id="prevLessonBtn" disabled>
                    <i class="fas fa-chevron-left"></i>
                    Previous
                </button>
                <button class="btn btn-primary" id="nextLessonBtn" disabled>
                    Next
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </footer>
    </main>

    <!-- Achievement Notification -->
    <div id="achievementNotification" class="achievement-notification">
        <div class="notification-header">
            <div class="notification-icon" id="notificationIcon">
                <i class="fas fa-trophy"></i>
            </div>
            <div class="notification-content">
                <h3 id="notificationTitle">Achievement Unlocked!</h3>
                <p id="notificationDescription">Description here...</p>
            </div>
        </div>
        <div class="notification-reward" id="notificationReward">
            <i class="fas fa-coins"></i>
            <span id="notificationPoints">+100 Points</span>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <span id="toastMessage"></span>
    </div>

    <script>
       // =====================================================
// SYNCHRONIZED COURSE SYSTEM WITH DASHBOARD INTEGRATION
// =====================================================

// Supabase Configuration - Replace with your config
const supabaseUrl = 'https://lzcmzulemfubjaksoqor.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx6Y216dWxlbWZ1Ympha3NvcW9yIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUzMzM5MDgsImV4cCI6MjA3MDkwOTkwOH0.crhPH4YWtRsr1BJTpAQcmPbWSpwIWRbzoI4sRb2_fPI';
const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

// =====================================================
// COURSE DATA STRUCTURE - REPLACE WITH YOUR COURSE JSON
// =====================================================
  const COURSE_DATA = {
    "id": "windows-linux-administration",
    "title": "Windows & Linux Administration",
    "description": "A comprehensive, dual-track guide to mastering system administration on both Windows Server and Linux.",
    "category": "system-administration",
    "difficulty": "Intermediate",
    "duration": "50 hours",
    "instructor": "Dr. Anya Sharma",
    "lessons": [
        {
            "id": "lesson-1",
            "title": "OS Administration Overview",
            "duration": "60 min",
            "objectives": [
                "Understand the core roles and responsibilities of a system administrator.",
                "Differentiate between Command-Line Interface (CLI) and Graphical User Interface (GUI) management.",
                "Recognize the different philosophies behind Windows and Linux administration.",
                "Set up a virtual lab environment with both Windows Server and Ubuntu Server."
            ],
            "content": {
                "overview": "Welcome to the world of system administration. This foundational lesson introduces the critical role administrators play in maintaining and managing operating systems. We'll explore the two primary interaction models—CLI and GUI—and set the stage for the course by installing both a Windows Server and an Ubuntu Linux server in a virtual environment, your personal digital sandbox.",
                "sections": [
                    {
                        "title": "The Role of a System Administrator",
                        "content": "<p>A system administrator, or sysadmin, is a person responsible for the upkeep, configuration, and reliable operation of computer systems, especially multi-user computers like servers. Their key responsibilities include:</p><ul><li><strong>Installation & Configuration:</strong> Setting up new operating systems and software.</li><li><strong>Maintenance:</strong> Applying patches and updates to keep systems secure and stable.</li><li><strong>User Management:</strong> Creating and managing user accounts and permissions.</li><li><strong>Backup & Recovery:</strong> Ensuring data can be restored in case of a disaster.</li><li><strong>Monitoring:</strong> Watching system performance and security logs to proactively identify issues.</li><li><strong>Troubleshooting:</strong> Diagnosing and fixing problems when they occur.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1522071820081-009f0129c7da?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "CLI vs. GUI Management",
                        "content": "<p>System administration can be performed through two main interfaces:</p><h3>Graphical User Interface (GUI):</h3><p>Favored by Windows, a GUI uses windows, icons, menus, and pointers (WIMP) for interaction. It is intuitive, easy to learn, and excellent for visualization.</p><ul><li><strong>Pros:</strong> User-friendly, visual feedback, low learning curve for basic tasks.</li><li><strong>Cons:</strong> Can be slower for complex tasks, difficult to automate, consumes more system resources.</li></ul><h3>Command-Line Interface (CLI):</h3><p>The primary interface for Linux, a CLI uses text commands. It is powerful, efficient, and highly scriptable.</p><ul><li><strong>Pros:</strong> Fast, resource-light, highly automatable and repeatable, powerful for advanced tasks.</li><li><strong>Cons:</strong> Steeper learning curve, less intuitive for beginners.</li></ul><div class=\"info-box tip\"><div class=\"info-box-header\"><i class=\"fas fa-lightbulb\"></i><strong>Modern Approach</strong></div><p>Modern administration uses both. Windows has PowerShell (a powerful CLI), and Linux has optional desktop environments.</p></div>",
                        "image": "https://images.unsplash.com/photo-1515879218367-8466d910aaa4?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Lab Setup: Virtualization Software",
                        "language": "text",
                        "code": "For this course, you will need virtualization software. Popular choices include:\n\n- VirtualBox (Free, multi-platform)\n- VMware Workstation Player/Fusion (Free for personal use)\n- Hyper-V (Built into Windows 10/11 Pro)\n\nDownload and install one of these, along with the ISO files for:\n1. Windows Server (Evaluation version from Microsoft's website)\n2. Ubuntu Server (Latest LTS version from the Ubuntu website)"
                    }
                ]
            },
            "quiz": {
                "passingScore": 80,
                "questions": [
                    {
                        "id": 1,
                        "question": "What is a primary advantage of using a Command-Line Interface (CLI) for administration?",
                        "options": ["It is more visual and intuitive for new users", "It is easily automatable through scripting", "It uses more system resources to provide better graphics", "It does not require learning any commands"],
                        "correct": 1,
                        "explanation": "The key strength of the CLI is that sequences of commands can be saved into scripts, allowing for powerful automation of repetitive tasks."
                    },
                    {
                        "id": 2,
                        "question": "Which of the following is a core responsibility of a system administrator?",
                        "options": ["Writing the source code for the operating system", "Designing the company logo", "Managing user accounts and permissions", "Selling computer hardware"],
                        "correct": 2,
                        "explanation": "Managing who has access to the system and what they are allowed to do is a fundamental security and operational task for any sysadmin."
                    },
                    {
                        "id": 3,
                        "question": "Which operating system traditionally favors a GUI-first approach to administration?",
                        "options": ["Linux", "Windows", "UNIX", "FreeBSD"],
                        "correct": 1,
                        "explanation": "Windows Server has historically been managed primarily through its graphical tools like Server Manager, although its command-line capabilities with PowerShell are now extremely powerful."
                    }
                ]
            }
        },
        {
            "id": "lesson-2",
            "title": "Windows vs Linux Architecture",
            "duration": "90 min",
            "objectives": [
                "Understand the difference between the Windows NT (hybrid) and Linux (monolithic) kernels.",
                "Compare the Windows Registry to Linux's `/etc` configuration file system.",
                "Recognize the differences in file system structure and case sensitivity.",
                "Explore the core system directories in both operating systems."
            ],
            "content": {
                "overview": "Beneath the surface, Windows and Linux are fundamentally different in their design and philosophy. This lesson explores the architectural heart of both operating systems, from their kernel design to how they store system configuration, providing the context you need to understand why they behave so differently.",
                "sections": [
                    {
                        "title": "Kernel Architecture",
                        "content": "<h3>Windows NT Kernel:</h3><p>Windows uses a <strong>hybrid kernel</strong>. This means it combines aspects of a microkernel and a monolithic kernel. Core functions like the Hardware Abstraction Layer (HAL) and a small microkernel run in protected kernel mode, but other services like the file system and device drivers also run in kernel mode for performance. This provides a balance of stability and speed.</p><h3>Linux Kernel:</h3><p>Linux uses a <strong>monolithic kernel</strong>. This means the entire operating system—process scheduling, memory management, file systems, and device drivers—runs as a single, large program in kernel mode. While this is extremely fast, a bug in a device driver can potentially crash the entire system. However, its modular design allows drivers to be loaded and unloaded at runtime, mitigating this risk.</p>",
                        "image": "https://images.unsplash.com/photo-1591799264318-7e6cb8dd785b?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "System Configuration: Registry vs. `/etc`",
                        "content": "<h3>Windows Registry:</h3><p>Windows centralizes almost all system and application configuration settings in a hierarchical database called the <strong>Registry</strong>. It contains information about hardware, installed software, user profiles, and system settings. It is a powerful but complex and single point of failure. It is edited with tools like `regedit`.</p><h3>Linux `/etc` Directory:</h3><p>Linux takes a different approach, using simple, human-readable plain text files to store configuration. Nearly all system-wide configuration files are stored in the `/etc` directory and its subdirectories. Each application typically has its own configuration file (e.g., `/etc/ssh/sshd_config` for the SSH server). This makes configuration transparent, easy to version control, and simple to backup or edit with any text editor.</p>",
                        "image": "https://images.unsplash.com/photo-1555949963-aa79dcee981c?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "File System Structure",
                        "content": "<p>The two operating systems have very different views on file organization.</p><h3>Windows:</h3><ul><li>Uses drive letters (<code>C:</code>, <code>D:</code>) for different partitions.</li><li>File paths use backslashes (<code>\\</code>), e.g., <code>C:\\Users\\Admin</code>.</li><li>The file system (NTFS) is <strong>case-insensitive</strong> by default (`File.txt` is the same as `file.txt`).</li><li>Key directories: `C:\\Windows` for the OS, `C:\\Program Files` for applications, `C:\\Users` for user profiles.</li></ul><h3>Linux:</h3><ul><li>Uses a single unified filesystem tree starting from the root directory (<code>/</code>). Partitions and drives are 'mounted' into this tree.</li><li>File paths use forward slashes (<code>/</code>), e.g., <code>/home/admin</code>.</li><li>The file system (ext4, XFS) is <strong>case-sensitive</strong> (`File.txt` and `file.txt` are two different files).</li><li>Key directories: `/etc` for configs, `/var` for variable data like logs, `/home` for user profiles, `/bin` for essential programs.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1558494949-ef010cbdcc31?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Exploring Configuration Locations (Windows)",
                        "language": "powershell",
                        "code": "# The Registry is not easily browsed via CLI, but you can query it.\n# Get a value from the Registry\nGet-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\" -Name \"ProductName\"\n\n# Navigate to key system directories\ncd C:\\Windows\\System32\nls"
                    },
                    {
                        "title": "Exploring Configuration Locations (Linux)",
                        "language": "bash",
                        "code": "# Navigate to the configuration directory\ncd /etc\nls\n\n# View the contents of a configuration file\ncat sshd_config\n\n# Navigate to the user's home directory\ncd /home\nls"
                    }
                ]
            },
            "quiz": {
                "passingScore": 80,
                "questions": [
                    {
                        "id": 1,
                        "question": "How does Windows primarily store its system and application settings?",
                        "options": ["In a series of plain text files in C:\\config", "In a centralized hierarchical database called the Registry", "In XML files stored in each application's folder", "In the kernel's memory"],
                        "correct": 1,
                        "explanation": "Windows uses the Registry as its central repository for configuration data, which is a major architectural difference from Linux."
                    },
                    {
                        "id": 2,
                        "question": "Which statement about Linux and Windows file systems is true?",
                        "options": ["Both are case-sensitive", "Both are case-insensitive", "Linux is case-sensitive, while Windows is case-insensitive by default", "Windows is case-sensitive, while Linux is case-insensitive by default"],
                        "correct": 2,
                        "explanation": "This is a critical distinction. On Linux, `MyFile` and `myfile` are different files. On Windows, they are treated as the same file."
                    },
                    {
                        "id": 3,
                        "question": "What type of kernel does Linux use?",
                        "options": ["Microkernel", "Hybrid Kernel", "Monolithic Kernel", "Exokernel"],
                        "correct": 2,
                        "explanation": "Linux employs a monolithic kernel, where the entire OS runs in kernel mode. This design is known for its performance."
                    },
                    {
                        "id": 4,
                        "question": "Where are user-specific configuration files and data stored by default on a Linux system?",
                        "options": ["/etc", "/usr/config", "/var/users", "/home/username"],
                        "correct": 3,
                        "explanation": "Each user on a Linux system has a home directory (e.g., `/home/john`) which contains their personal files and application settings (in hidden dotfiles like `.bashrc`)."
                    }
                ]
            }
        },
        {
            "id": "lesson-3",
            "title": "Installing Systems",
            "duration": "120 min",
            "objectives": [
                "Understand disk partitioning schemes (MBR vs. GPT).",
                "Learn the concepts of dual-booting and virtualization.",
                "Perform a basic installation of Windows Server.",
                "Perform a basic installation of Ubuntu Server."
            ],
            "content": {
                "overview": "This hands-on lesson covers the process of installing an operating system from scratch. We'll explore the foundational step of disk partitioning and compare methods for running multiple OSes on a single machine. The core of the lesson will be a guided lab where you install both Windows Server and Ubuntu Server in your virtual environment.",
                "sections": [
                    {
                        "title": "Disk Partitioning: MBR vs. GPT",
                        "content": "<p>Before an OS can be installed, a hard disk must be partitioned. A partition is a logical section of a disk. The partitioning scheme defines how the partitions are organized.</p><h3>MBR (Master Boot Record):</h3><p>The older standard. It uses a small section at the beginning of the disk to store the partition table and boot loader.</p><ul><li><strong>Limitations:</strong> Can only have up to 4 primary partitions (or 3 primary and 1 extended). Cannot handle disks larger than 2 TB.</li></ul><h3>GPT (GUID Partition Table):</h3><p>The modern standard, associated with UEFI firmware. It uses Globally Unique Identifiers (GUIDs) to define partitions.</p><ul><li><strong>Advantages:</strong> Supports up to 128 partitions by default, and disks of virtually unlimited size. It also includes data redundancy and error checking, making it more robust.</li></ul><p>All modern systems should use GPT with UEFI.</p>",
                        "image": "https://images.unsplash.com/photo-1581291518857-4e27b48ff24e?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Multi-OS Methods: Dual-Boot vs. Virtualization",
                        "content": "<h3>Dual-Booting:</h3><p>This involves installing two or more operating systems on separate partitions of the same hard drive. A boot manager (like GRUB or Windows Boot Manager) allows you to choose which OS to load when you turn on the computer. Only one OS can run at a time.</p><h3>Virtualization:</h3><p>This involves using software called a hypervisor (like VirtualBox, VMware, Hyper-V) to create and run virtual machines (VMs) on a host operating system. Each VM is a complete, isolated guest operating system. You can run multiple OSes simultaneously.</p><div class=\"info-box tip\"><div class=\"info-box-header\"><i class=\"fas fa-lightbulb\"></i><strong>Why Virtualization for Admins?</strong></div><p>Virtualization is the standard for servers and labs. It allows for snapshots (saving a VM's state), easy cloning, and hardware independence, making it perfect for testing and development.</p></div>",
                        "image": "https://images.unsplash.com/photo-1518709268805-4e9042af2176?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Lab: Installing the Operating Systems",
                        "content": "<p>This is the practical part of the lesson. You will create two new virtual machines in your chosen hypervisor software.</p><h3>Windows Server Installation:</h3><p>You will boot the VM from the Windows Server ISO. The graphical installer will guide you through selecting the language, choosing an edition (typically 'Standard with Desktop Experience'), accepting the license, and selecting the disk for installation. The process is largely automated.</p><h3>Ubuntu Server Installation:</h3><p>You will boot the other VM from the Ubuntu Server ISO. The text-based installer (Subiquity) will guide you through selecting the language, keyboard layout, network configuration (usually DHCP is fine), partitioning (using the entire disk is fine for a lab), setting up a user account, and choosing to install popular server snaps like Docker.</p>",
                        "image": "https://images.unsplash.com/photo-1629654297299-c8506221ca97?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": []
            },
            "quiz": {
                "passingScore": 80,
                "questions": [
                    {
                        "id": 1,
                        "question": "What is a major limitation of the older MBR partitioning scheme?",
                        "options": ["It can only be used with Linux", "It does not support disks larger than 2 TB", "It is slower than GPT", "It requires a special type of hard drive"],
                        "correct": 1,
                        "explanation": "The MBR scheme uses 32-bit addresses for disk sectors, which limits the maximum addressable disk size to 2 TB."
                    },
                    {
                        "id": 2,
                        "question": "What is the primary advantage of virtualization over dual-booting for a system administrator's lab?",
                        "options": ["It runs faster than a native OS", "It allows you to run multiple operating systems simultaneously", "It doesn't require an operating system", "It uses less disk space"],
                        "correct": 1,
                        "explanation": "Virtualization allows you to have Windows and Linux running in separate windows on your host OS at the same time, which is essential for testing client-server interactions."
                    },
                    {
                        "id": 3,
                        "question": "Which technology is the modern standard for firmware on motherboards and has replaced BIOS?",
                        "options": ["GRUB", "UEFI", "MBR", "CMOS"],
                        "correct": 1,
                        "explanation": "UEFI (Unified Extensible Firmware Interface) is the modern replacement for the traditional BIOS, offering features like faster boot times and support for GPT partitioning."
                    }
                ]
            }
        },
        {
            "id": "lesson-4",
            "title": "File Systems",
            "duration": "75 min",
            "objectives": [
                "Understand the role of a file system.",
                "Compare the features of major Windows (NTFS, FAT32) and Linux (ext4, XFS) file systems.",
                "Learn the concept of journaling for data integrity.",
                "Practice formatting, mounting, and unmounting drives in both OSes."
            ],
            "content": {
                "overview": "A file system is the structure an operating system uses to control how data is stored and retrieved. It's the librarian of your hard drive. This lesson explores the most common file systems in the Windows and Linux worlds, highlighting their features, differences, and the crucial concept of journaling that protects your data.",
                "sections": [
                    {
                        "title": "Windows File Systems",
                        "content": "<h3>NTFS (New Technology File System):</h3><p>The standard, modern file system for all versions of Windows. It is robust, secure, and feature-rich.</p><ul><li><strong>Features:</strong> Supports large files and volumes, file-level permissions (ACLs), encryption (EFS), compression, and journaling.</li></ul><h3>FAT32 (File Allocation Table 32):</h3><p>An older, simpler file system. Its main advantage is compatibility.</p><ul><li><strong>Features:</strong> Widely compatible with almost every OS (Windows, macOS, Linux) and device (cameras, game consoles).</li><li><strong>Limitations:</strong> No journaling, no file-level security, and a maximum file size of only 4 GB. It is primarily used for external drives and USB sticks for maximum compatibility.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1593349319931-06c15c89a940?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Linux File Systems",
                        "content": "<h3>ext4 (Fourth Extended Filesystem):</h3><p>The most common default file system for many Linux distributions, including Debian and Ubuntu. It is the successor to ext3 and is known for its stability and solid performance.</p><ul><li><strong>Features:</strong> Journaling, support for very large files and volumes, backward compatibility with older ext filesystems.</li></ul><h3>XFS (XFS File System):</h3><p>A high-performance 64-bit journaling file system originally created by SGI. It excels at handling very large files and parallel I/O operations.</p><ul><li><strong>Features:</strong> Excellent performance with large files, efficient space allocation. It is the default file system for Red Hat Enterprise Linux and its derivatives.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1629654297299-c8506221ca97?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Journaling",
                        "content": "<p>Journaling is a critical feature of modern file systems like NTFS, ext4, and XFS. It drastically reduces the risk of data corruption after a sudden power loss or system crash.</p><p>A journaling file system maintains a special log, called a 'journal', where it writes down the changes it is about to make *before* it actually makes them to the main file system. If the system crashes mid-operation, when it reboots, the OS can look at the journal, see the incomplete entry, and revert the changes, ensuring the file system remains in a consistent, uncorrupted state. This avoids the need for lengthy disk scans (like the old `chkdsk` or `fsck`) on startup.</p>",
                        "image": "https://images.unsplash.com/photo-1558494949-ef010cbdcc31?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Formatting and Mounting a Drive (Linux)",
                        "language": "bash",
                        "code": "# List available block devices to identify your drive (e.g., /dev/sdb)\nlsblk\n\n# Format the first partition on the drive as ext4\nsudo mkfs.ext4 /dev/sdb1\n\n# Create a mount point (a directory)\nsudo mkdir /mnt/data\n\n# Mount the partition to the directory\nsudo mount /dev/sdb1 /mnt/data\n\n# Verify it is mounted\ndf -h\n\n# Unmount the drive when finished\nsudo umount /mnt/data"
                    },
                    {
                        "title": "Formatting and Mounting a Drive (Windows)",
                        "language": "powershell",
                        "code": "# Open Disk Management (diskmgmt.msc) or use PowerShell\n\n# List disks\nGet-Disk\n\n# Select a disk (e.g., Disk 1), clear it, and create a new partition with a drive letter\n# (Caution: This is destructive!)\nGet-Disk 1 | Clear-Disk -RemoveData\nNew-Partition -DiskNumber 1 -UseMaximumSize -AssignDriveLetter E\n\n# Format the new volume\nFormat-Volume -DriveLetter E -FileSystem NTFS -NewFileSystemLabel \"Data\""
                    }
                ]
            },
            "quiz": {
                "passingScore": 80,
                "questions": [
                    {
                        "id": 1,
                        "question": "What is the primary, modern file system used by Windows?",
                        "options": ["ext4", "FAT32", "NTFS", "XFS"],
                        "correct": 2,
                        "explanation": "NTFS is the standard file system for Windows, providing essential features like journaling, security permissions (ACLs), and support for large files."
                    },
                    {
                        "id": 2,
                        "question": "You need to format a USB drive to be compatible with the widest range of devices (Windows, Mac, cameras). Which file system is the best choice?",
                        "options": ["NTFS", "ext4", "XFS", "FAT32"],
                        "correct": 3,
                        "explanation": "Despite its limitations (like a 4GB max file size), FAT32's near-universal compatibility makes it the de facto standard for portable media."
                    },
                    {
                        "id": 3,
                        "question": "What is the main benefit of a journaling file system?",
                        "options": ["It makes the disk physically faster", "It encrypts all files automatically", "It improves data integrity by logging changes before they are made, preventing corruption from crashes", "It is compatible with more operating systems"],
                        "correct": 2,
                        "explanation": "Journaling provides robustness by ensuring that in the event of a crash, the file system can be quickly brought back to a consistent state without data corruption."
                    },
                    {
                        "id": 4,
                        "question": "Which file system is the default for Red Hat Enterprise Linux and is known for high performance with very large files?",
                        "options": ["NTFS", "ext4", "XFS", "FAT32"],
                        "correct": 2,
                        "explanation": "XFS is a high-performance filesystem that excels in enterprise environments with large datasets, which is why it's the default for RHEL and its derivatives."
                    }
                ]
            }
        },
        {
            "id": "lesson-5",
            "title": "User & Group Management",
            "duration": "90 min",
            "objectives": [
                "Understand the concept of user and group accounts.",
                "Learn to create, modify, and delete users on Windows and Linux.",
                "Grasp the basics of Active Directory (AD) and Group Policy Objects (GPO) in Windows.",
                "Understand the purpose and syntax of the `sudoers` file in Linux for privilege escalation."
            ],
            "content": {
                "overview": "Controlling who can access a system and what they are allowed to do is a fundamental task of system administration. This lesson covers the creation and management of user and group accounts on both Windows and Linux, and introduces the powerful centralized management frameworks unique to each: Active Directory for Windows and `sudo` for Linux.",
                "sections": [
                    {
                        "title": "Users and Groups",
                        "content": "<p>Both operating systems use user and group accounts to manage permissions.</p><ul><li><strong>User Account:</strong> Represents an individual entity (a person or a service) that can log in and access resources. Each user has a unique username and a security identifier (SID in Windows, UID in Linux).</li><li><strong>Group Account:</strong> A collection of user accounts. Instead of assigning permissions to hundreds of individual users, you can assign permissions to a single group. This simplifies administration immensely.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1573497161211-a55e3742b4b4?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Windows: Active Directory and Group Policy",
                        "content": "<p>In a Windows enterprise environment, user management is centralized through <strong>Active Directory (AD)</strong>. AD is a directory service that stores information about all network resources, including users, groups, computers, and printers.</p><h3>Group Policy Objects (GPO):</h3><p>Group Policy is a feature that allows administrators to implement specific configurations for users and computers. GPOs are settings that can be applied to sites, domains, or organizational units (OUs) in Active Directory. You can use GPOs to enforce password complexity, restrict access to control panel settings, deploy software, or map network drives, all from a central location.</p>",
                        "image": "https://images.unsplash.com/photo-1544198365-f5d60b6d8190?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Linux: Local Users and `sudo`",
                        "content": "<p>On a standalone Linux server, user accounts are managed locally in files like `/etc/passwd` (user account info), `/etc/shadow` (hashed passwords), and `/etc/group` (group info).</p><h3>`sudo` and the `sudoers` File:</h3><p>Linux has a powerful concept of a non-privileged user temporarily elevating their privileges to perform a specific administrative task. This is handled by the <code>sudo</code> (superuser do) command. By default, the root user can do anything. Instead of logging in as root (which is a security risk), administrators log in as their own user and prefix administrative commands with `sudo`.</p><p>Who is allowed to use `sudo` and what they can do is defined in the <strong>`/etc/sudoers`</strong> file. This file is carefully edited with the `visudo` command to prevent syntax errors.</p>",
                        "image": "https://images.unsplash.com/photo-1515879218367-8466d910aaa4?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "User Management (Windows)",
                        "language": "powershell",
                        "code": "# Create a new local user\nnet user jdoe Pa$$w0rd /add\n\n# Add the user to the Administrators group\nnet localgroup Administrators jdoe /add\n\n# Using PowerShell (more powerful)\nNew-LocalUser -Name \"asmith\" -Password (Read-Host -AsSecureString \"Enter password:\")\nAdd-LocalGroupMember -Group \"Remote Desktop Users\" -Member \"asmith\""
                    },
                    {
                        "title": "User Management (Linux)",
                        "language": "bash",
                        "code": "# Create a new user with an interactive prompt for password and details\nsudo adduser jdoe\n\n# Add the user to the 'sudo' group to grant admin privileges\nsudo usermod -aG sudo jdoe\n\n# Create a new group\nsudo addgroup developers\n\n# Add the user to the new group\nsudo usermod -aG developers jdoe"
                    },
                    {
                        "title": "Example `/etc/sudoers` Entry",
                        "language": "text",
                        "code": "# This file should only be edited with the 'visudo' command.\n\n# Allow members of group sudo to execute any command\n%sudo   ALL=(ALL:ALL) ALL"
                    }
                ]
            },
            "quiz": {
                "passingScore": 80,
                "questions": [
                    {
                        "id": 1,
                        "question": "In a Windows enterprise network, what is the primary service for centrally managing users, groups, and computers?",
                        "options": ["Windows Registry", "Active Directory", "Group Policy", "NTFS"],
                        "correct": 1,
                        "explanation": "Active Directory is the core directory service used in Windows domains to provide centralized authentication and authorization."
                    },
                    {
                        "id": 2,
                        "question": "What is the purpose of the `sudo` command in Linux?",
                        "options": ["To switch to a different user's desktop", "To shut down the system", "To allow a permitted user to execute a command as the superuser or another user", "To create a new user"],
                        "correct": 2,
                        "explanation": "`sudo` provides a controlled way to grant administrative privileges to normal users for specific commands, which is much more secure than sharing the root user's password."
                    },
                    {
                        "id": 3,
                        "question": "What is the primary benefit of using groups for permissions?",
                        "options": ["Groups are more secure than user accounts", "It simplifies administration by allowing you to assign permissions to a group rather than many individual users", "Users in a group can see each other's files", "Groups use less disk space"],
                        "correct": 1,
                        "explanation": "Assigning permissions to a group is far more efficient. To grant or revoke access for a user, you simply add or remove them from the group."
                    },
                    {
                        "id": 4,
                        "question": "Which file on a Linux system contains the hashed passwords for user accounts?",
                        "options": ["/etc/passwd", "/etc/sudoers", "/etc/group", "/etc/shadow"],
                        "correct": 3,
                        "explanation": "For security, the `/etc/passwd` file (which is world-readable) contains user information, but the encrypted passwords are kept in the `/etc/shadow` file, which can only be read by the root user."
                    }
                ]
            }
        },
        {
            "id": "lesson-6",
            "title": "File Permissions & ACLs",
            "duration": "90 min",
            "objectives": [
                "Understand the standard Linux `rwx` permission model for user, group, and other.",
                "Use `chmod` and `chown` to manage Linux file permissions.",
                "Understand the concept of Access Control Lists (ACLs) for granular permissions.",
                "Use `icacls` to manage NTFS permissions in Windows."
            ],
            "content": {
                "overview": "Beyond knowing who a user is, the OS must control what they can do with files and directories. This lesson covers the two main permission models: the classic `rwx` model used by Linux and the more granular Access Control List (ACL) model used by Windows NTFS, and how to manage them from the command line.",
                "sections": [
                    {
                        "title": "Linux `rwx` Permissions",
                        "content": "<p>Linux uses a simple but powerful permission model. Every file and directory has permissions set for three classes of users:</p><ul><li><strong>User (u):</strong> The owner of the file.</li><li><strong>Group (g):</strong> The group that is associated with the file.</li><li><strong>Other (o):</strong> Everyone else.</li></ul><p>For each class, three permissions can be granted or denied:</p><ul><li><strong>Read (r):</strong> The ability to read the contents of a file or list the contents of a directory.</li><li><strong>Write (w):</strong> The ability to modify a file or create/delete files within a directory.</li><li><strong>Execute (x):</strong> The ability to run a file (if it's a program or script) or enter a directory (with `cd`).</li></ul><p>These are represented by a 10-character string like <code>-rwxr-xr--</code>.</p>",
                        "image": "https://images.unsplash.com/photo-1563206767-5b18f218e8de?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Managing Permissions in Linux (`chmod`, `chown`)",
                        "content": "<h3>`chmod` (Change Mode):</h3><p>This command changes permissions. It can be used in two modes:</p><ul><li><strong>Symbolic Mode:</strong> Uses letters (u, g, o, a for all) and operators (+ to add, - to remove, = to set). Example: <code>chmod g+w file.txt</code> gives write permission to the group.</li><li><strong>Octal (Numeric) Mode:</strong> Uses a 3-digit number where each digit represents user, group, and other. The numbers are the sum of the values: 4 (read), 2 (write), 1 (execute). Example: <code>chmod 754 file.txt</code> sets permissions to `rwxr-xr--`.</li></ul><h3>`chown` (Change Owner):</h3><p>This command changes the user and/or group ownership of a file. Example: <code>sudo chown john:developers file.txt</code>.</p>",
                        "image": "https://images.unsplash.com/photo-1515879218367-8466d910aaa4?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Windows NTFS Permissions and ACLs",
                        "content": "<p>Windows NTFS uses a more granular model based on Access Control Lists (ACLs). An ACL is a list of Access Control Entries (ACEs) attached to a file or folder. Each ACE specifies:</p><ul><li>A <strong>security principal</strong> (a user or group).</li><li>An <strong>access type</strong> (Allow or Deny).</li><li>A set of <strong>specific permissions</strong> (e.g., Read, Write, Modify, Full Control).</li></ul><p>This model is more flexible than the Linux `rwx` model because you can grant different permissions to many different users and groups on the same file. It also supports <strong>permission inheritance</strong>, where files and folders automatically get permissions from their parent folder.</p><div class=\"info-box warning\"><div class=\"info-box-header\"><i class=\"fas fa-exclamation-triangle\"></i><strong>Deny overrides Allow</strong></div><p>A critical rule in NTFS is that a 'Deny' permission will always override an 'Allow' permission.</p></div>",
                        "image": "https://images.unsplash.com/photo-1526374965328-5f61d4dc18c5?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "`chmod` and `chown` Examples (Linux)",
                        "language": "bash",
                        "code": "# Using symbolic mode\n# Add write permission for the group\nchmod g+w script.sh\n# Remove read/write for others\nchmod o-rw script.sh\n\n# Using octal mode\n# Set rwxr-x--- (750)\nchmod 750 script.sh\n\n# Change the owner to 'sara' and the group to 'admins'\nsudo chown sara:admins script.sh"
                    },
                    {
                        "title": "`icacls` Examples (Windows)",
                        "language": "powershell",
                        "code": "# View the ACLs for a folder\nicacls C:\\data\n\n# Grant the user 'jdoe' Modify permissions on a folder\n# /grant is the option, (OI)(CI) means it will be inherited by subfolders and files\nicacls C:\\data /grant jdoe:(OI)(CI)M\n\n# Deny the 'Marketing' group write access to a file\nicacls C:\\data\\report.docx /deny Marketing:(W)\n\n# Remove all granted permissions for 'jdoe'\nicacls C:\\data /remove jdoe"
                    }
                ]
            },
            "quiz": {
                "passingScore": 80,
                "questions": [
                    {
                        "id": 1,
                        "question": "In the Linux permission string `-rwxrw-r--`, what permissions does the 'group' have?",
                        "options": ["Read, write, execute (rwx)", "Read and write (rw-)", "Read and execute (r-x)", "Read only (r--)"],
                        "correct": 1,
                        "explanation": "The permission string is divided into three sets of three characters for user, group, and other. The middle set, `rw-`, applies to the group."
                    },
                    {
                        "id": 2,
                        "question": "Which `chmod` command would set the permissions to `rwxr-x--x` (owner can read/write/execute, group can read/execute, others can execute)?",
                        "options": ["chmod 751 file.sh", "chmod 777 file.sh", "chmod 644 file.sh", "chmod 755 file.sh"],
                        "correct": 0,
                        "explanation": "Permissions are calculated by summing the values: r=4, w=2, x=1. Owner: 4+2+1=7. Group: 4+0+1=5. Other: 0+0+1=1. This gives the octal code 751."
                    },
                    {
                        "id": 3,
                        "question": "What is the command-line tool in Windows for managing NTFS permissions (ACLs)?",
                        "options": ["chmod", "chown", "icacls", "setperm"],
                        "correct": 2,
                        "explanation": "`icacls` is the modern command-line utility for displaying and modifying discretionary access control lists (DACLs) on files and folders."
                    },
                    {
                        "id": 4,
                        "question": "What is a key advantage of the NTFS ACL model over the standard Linux `rwx` model?",
                        "options": ["It is simpler to use", "It allows you to set granular permissions for many different users and groups on a single file", "It uses numbers instead of letters", "It is case-insensitive"],
                        "correct": 1,
                        "explanation": "The ACL model is more flexible because you can create many different rules (ACEs) for various users and groups, whereas the standard Linux model is limited to just one owner and one group."
                    }
                ]
            }
        },
        {
            "id": "lesson-7",
            "title": "Boot Process",
            "duration": "75 min",
            "objectives": [
                "Differentiate between the legacy BIOS and modern UEFI firmware.",
                "Understand the Linux boot process from UEFI to the GRUB2 bootloader and systemd.",
                "Understand the Windows boot process from UEFI to the Windows Boot Manager.",
                "Learn basic troubleshooting steps for bootloaders."
            ],
            "content": {
                "overview": "What happens in the few seconds between pressing the power button and seeing a login screen? This lesson demystifies the boot process, tracing the sequence of events from the initial hardware startup by the firmware to the loading of the operating system kernel. We'll compare the modern UEFI standard to the legacy BIOS and look at the specific bootloaders for Windows and Linux.",
                "sections": [
                    {
                        "title": "Firmware: BIOS vs. UEFI",
                        "content": "<p>The firmware is the first software that runs when you power on a computer. It initializes the hardware before loading the operating system.</p><h3>BIOS (Basic Input/Output System):</h3><p>The legacy firmware used for decades. It reads the Master Boot Record (MBR) from the start of a disk to find the bootloader.</p><h3>UEFI (Unified Extensible Firmware Interface):</h3><p>The modern replacement for BIOS. It is more flexible and secure.</p><ul><li><strong>Key Advantages:</strong> Supports GPT partitioning for large disks, has its own boot manager, and includes a 'Secure Boot' feature that helps prevent malware from hijacking the boot process by ensuring only signed bootloaders are loaded. All modern systems use UEFI.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1518770660439-4636190af475?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "The Linux Boot Process (UEFI)",
                        "content": "<ol><li><strong>Power On & UEFI:</strong> The system firmware runs a Power-On Self-Test (POST) and initializes hardware. UEFI then looks for a bootloader in a special partition called the EFI System Partition (ESP).</li><li><strong>GRUB2 Bootloader:</strong> UEFI loads and executes the GRUB2 (Grand Unified Bootloader). GRUB2 displays a menu (if multiple OSes are present) and its main job is to load the Linux kernel and the `initramfs` (initial RAM file system) into memory.</li><li><strong>Kernel & initramfs:</strong> The kernel is loaded but needs drivers to access the real root file system. The `initramfs` is a temporary root filesystem in memory that contains these necessary drivers.</li><li><strong>systemd:</strong> The kernel uses the `initramfs` to mount the real root filesystem. It then executes the first user-space process, which on modern systems is `systemd` (with process ID 1).</li><li><strong>System Initialization:</strong> `systemd` reads its configuration files and starts all the necessary services (daemons) to bring the system to a usable state with a login prompt.</li></ol>",
                        "image": "https://images.unsplash.com/photo-1629654297299-c8506221ca97?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "The Windows Boot Process (UEFI)",
                        "content": "<ol><li><strong>Power On & UEFI:</strong> This step is identical to Linux. The firmware initializes hardware and finds the boot application in the EFI System Partition.</li><li><strong>Windows Boot Manager:</strong> UEFI loads the Windows Boot Manager (`bootmgfw.efi`). The Boot Manager reads the Boot Configuration Data (BCD) store, which contains the boot menu and options.</li><li><strong>Windows OS Loader (`winload.efi`):</strong> The Boot Manager then loads the Windows OS Loader. `winload.efi` is responsible for loading the core Windows NT kernel (`ntoskrnl.exe`) and the Hardware Abstraction Layer (HAL) into memory.</li><li><strong>Kernel Initialization:</strong> The kernel takes over, initializes drivers, and starts the Session Manager Subsystem (`smss.exe`).</li><li><strong>User Logon:</strong> SMSS starts the logon process (`winlogon.exe`), which presents the user with the login screen.</li></ol>",
                        "image": "https://images.unsplash.com/photo-1618423377884-a81a2b72c312?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Updating the GRUB Config (Linux)",
                        "language": "bash",
                        "code": "# After making a change to the /etc/default/grub file, you must run this\n# command to apply the changes to the actual GRUB configuration.\nsudo update-grub"
                    },
                    {
                        "title": "Viewing the Boot Configuration Data (Windows)",
                        "language": "powershell",
                        "code": "# This command displays the contents of the BCD store, including the\n# default OS to boot and the timeout for the boot menu.\nbcdedit"
                    }
                ]
            },
            "quiz": {
                "passingScore": 80,
                "questions": [
                    {
                        "id": 1,
                        "question": "What is the name of the modern firmware that has largely replaced BIOS?",
                        "options": ["MBR", "POST", "UEFI", "CMOS"],
                        "correct": 2,
                        "explanation": "UEFI is the modern standard, offering key advantages like Secure Boot and support for GPT partitioning schemes."
                    },
                    {
                        "id": 2,
                        "question": "In a typical modern Linux system, what is the name of the primary bootloader?",
                        "options": ["LILO", "bootmgr", "GRUB2", "systemd"],
                        "correct": 2,
                        "explanation": "GRUB2 (Grand Unified Bootloader) is the standard bootloader for the vast majority of Linux distributions. Its job is to load the Linux kernel into memory."
                    },
                    {
                        "id": 3,
                        "question": "What is the first user-space process with PID 1 that is started by the Linux kernel?",
                        "options": ["bash", "initramfs", "systemd", "getty"],
                        "correct": 2,
                        "explanation": "On modern Linux systems, `systemd` is the init system. It is the first process the kernel executes, and it is responsible for starting and managing all other system services."
                    },
                    {
                        "id": 4,
                        "question": "In the Windows boot process, what is the role of the Windows Boot Manager (`bootmgfw.efi`)?",
                        "options": ["To initialize the hardware", "To load the Windows NT kernel directly", "To read the Boot Configuration Data (BCD) and then load the OS loader (`winload.efi`)", "To display the user login screen"],
                        "correct": 2,
                        "explanation": "The Windows Boot Manager is the first component loaded by UEFI. It acts as a menu and controller, reading the BCD to determine which OS to load and then passing control to the appropriate OS loader."
                    }
                ]
            }
        },
        {
            "id": "lesson-8",
            "title": "Services & Daemons",
            "duration": "75 min",
            "objectives": [
                "Understand the concept of background processes (services/daemons).",
                "Learn to manage services in Windows using the Services GUI and PowerShell.",
                "Learn to manage daemons in Linux using `systemctl`.",
                "Configure a service to start automatically on boot in both OSes."
            ],
            "content": {
                "overview": "Operating systems are always busy, even when you are not actively using them. This is because of background processes that run without any user interface, providing core OS functionality or network services. In Windows, these are called 'services', and in Linux, they are traditionally called 'daemons'. This lesson teaches you how to manage these critical components.",
                "sections": [
                    {
                        "title": "Windows Services",
                        "content": "<p>A Windows service is an application that runs in the background and can be started automatically when the computer boots. Services can be managed through a GUI or the command line.</p><h3>Managing with the GUI:</h3><p>The `services.msc` console provides a user-friendly way to view all services. From here you can:</p><ul><li><strong>Start, Stop, Restart</strong> a service.</li><li>View a service's <strong>Status</strong> (Running, Stopped).</li><li>Change the <strong>Startup Type</strong> (Automatic, Automatic (Delayed Start), Manual, Disabled).</li></ul><h3>Managing with PowerShell:</h3><p>PowerShell provides a powerful command-line interface for managing services, which is ideal for scripting and automation.</p>",
                        "image": "https://images.unsplash.com/photo-1618423377884-a81a2b72c312?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Linux Daemons and `systemd`",
                        "content": "<p>In Linux and other UNIX-like systems, a background process is called a daemon. Traditionally, these were managed by scripts in `/etc/init.d`. However, modern Linux distributions have almost universally adopted <strong>`systemd`</strong> as their init system and service manager.</p><p>`systemd` uses configuration files called 'unit files' (ending in `.service`) to define how a daemon should be managed. The primary tool for interacting with `systemd` is the `systemctl` command.</p>",
                        "image": "https://images.unsplash.com/photo-1629654297299-c8506221ca97?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Using `systemctl`",
                        "content": "<p>The `systemctl` command is the unified tool for managing services on modern Linux systems.</p><h3>Key `systemctl` Commands:</h3><ul><li><code>systemctl status &lt;service&gt;</code>: Shows the detailed status of a service, including whether it's active, how long it's been running, and the most recent log entries.</li><li><code>systemctl start &lt;service&gt;</code>: Starts a service.</li><li><code>systemctl stop &lt;service&gt;</code>: Stops a service.</li><li><code>systemctl restart &lt;service&gt;</code>: Stops and then starts a service.</li><li><code>systemctl enable &lt;service&gt;</code>: Configures the service to start automatically at boot.</li><li><code>systemctl disable &lt;service&gt;</code>: Prevents the service from starting at boot.</li></ul><div class=\"info-box tip\"><div class=\"info-box-header\"><i class=\"fas fa-lightbulb\"></i><strong>No `.service` Needed</strong></div><p>You can usually omit the `.service` extension when using `systemctl`. For example, `systemctl status sshd` works the same as `systemctl status sshd.service`.</p></div>",
                        "image": "https://images.unsplash.com/photo-1515879218367-8466d910aaa4?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Managing a Service with PowerShell (Windows)",
                        "language": "powershell",
                        "code": "# Get the status of the Windows Update service\nGet-Service -Name wuauserv\n\n# Stop the Print Spooler service\nStop-Service -Name Spooler\n\n# Start the Print Spooler service\nStart-Service -Name Spooler\n\n# Set the Windows Firewall service to start automatically\nSet-Service -Name mpssvc -StartupType Automatic"
                    },
                    {
                        "title": "Managing a Daemon with `systemctl` (Linux)",
                        "language": "bash",
                        "code": "# Get the status of the SSH daemon\nsudo systemctl status sshd\n\n# Stop the Apache web server\nsudo systemctl stop apache2\n\n# Start the Apache web server\nsudo systemctl start apache2\n\n# Enable the Nginx web server to start on boot\nsudo systemctl enable nginx"
                    }
                ]
            },
            "quiz": {
                "passingScore": 80,
                "questions": [
                    {
                        "id": 1,
                        "question": "What is a background process that runs without a user interface called in Linux?",
                        "options": ["A service", "A program", "A daemon", "A kernel module"],
                        "correct": 2,
                        "explanation": "In Linux and UNIX terminology, a background process is traditionally known as a daemon."
                    },
                    {
                        "id": 2,
                        "question": "On a modern Linux system like Ubuntu 22.04, which command is used to check the status of the SSH service?",
                        "options": ["service sshd status", "systemctl status sshd", "/etc/init.d/sshd status", "chkconfig sshd"],
                        "correct": 1,
                        "explanation": "`systemctl` is the standard tool for controlling the `systemd` init system, which is used by all modern major Linux distributions."
                    },
                    {
                        "id": 3,
                        "question": "In the Windows Services console, what does setting the 'Startup Type' to 'Automatic' do?",
                        "options": ["The service must be started manually", "The service will start when a user logs in", "The service is permanently disabled", "The service will start automatically when the operating system boots"],
                        "correct": 3,
                        "explanation": "Setting the startup type to 'Automatic' configures the Service Control Manager to start the service during the system boot sequence."
                    },
                    {
                        "id": 4,
                        "question": "What does the command `sudo systemctl enable nginx` accomplish?",
                        "options": ["It starts the Nginx service immediately", "It stops the Nginx service", "It checks the syntax of the Nginx configuration file", "It configures the Nginx service to start automatically on the next boot"],
                        "correct": 3,
                        "explanation": "`enable` creates the necessary symbolic links for `systemd` to start the service during the boot process. `start` is used to activate it in the current session."
                    }
                ]
            }
        },
        {
            "id": "lesson-9",
            "title": "Process Management",
            "duration": "75 min",
            "objectives": [
                "Understand what a process is and how the OS manages it.",
                "View running processes in Windows (Task Manager) and Linux (`ps`, `top`).",
                "Terminate unresponsive processes in both OSes (`kill`, Task Manager).",
                "Learn about process states and scheduling."
            ],
            "content": {
                "overview": "A process is an instance of a running program. The operating system's kernel is responsible for managing all processes: starting them, scheduling their time on the CPU, and cleaning them up when they are finished. This lesson covers the essential tools and concepts for viewing, managing, and terminating processes in both Windows and Linux.",
                "sections": [
                    {
                        "title": "What is a Process?",
                        "content": "<p>When you launch an application, the operating system creates a process. The OS allocates memory for the process and tracks all the resources it needs to run, such as CPU time, open files, and network connections. Each process is given a unique Process ID (PID).</p><h3>Process States:</h3><p>A process can be in several states:</p><ul><li><strong>Running:</strong> The process is currently being executed by the CPU.</li><li><strong>Runnable (Ready):</strong> The process is ready to run but is waiting for its turn on the CPU.</li><li><strong>Sleeping (Waiting):</strong> The process is waiting for some event to occur (e.g., user input or data from a disk).</li><li><strong>Zombie:</strong> The process has finished executing, but its entry still remains in the process table, waiting for its parent process to collect its exit status.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Process Management in Windows",
                        "content": "<h3>Task Manager:</h3><p>The Task Manager (Ctrl+Shift+Esc) is the primary GUI tool for managing processes. It provides a real-time view of running applications and background processes, along with their CPU, memory, disk, and network usage. You can right-click a process to terminate it ('End task').</p><h3>Command Line (PowerShell):</h3><ul><li><code>Get-Process</code>: Lists all running processes (similar to `ps` in Linux).</li><li><code>Stop-Process</code>: Terminates a process, which can be specified by its name or ID.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1618423377884-a81a2b72c312?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Process Management in Linux",
                        "content": "<h3>`ps` (Process Status):</h3><p>The `ps` command provides a static snapshot of the currently running processes.</p><ul><li><code>ps aux</code>: A very common command that shows all processes (`a`), including those without a terminal (`x`), in a user-oriented format (`u`).</li></ul><h3>`top` and `htop`:</h3><p>The `top` command provides a dynamic, real-time view of the processes running on the system, similar to the Windows Task Manager. It shows the PID, user, CPU usage, memory usage, and more, refreshing every few seconds. `htop` is a popular, more user-friendly and colorful alternative to `top`.</p><h3>`kill` (Terminate Process):</h3><p>The `kill` command is used to send a signal to a process, usually to terminate it. It requires the PID of the process.</p><ul><li><code>kill &lt;PID&gt;</code>: Sends the default TERM (terminate) signal, asking the process to shut down gracefully.</li><li><code>kill -9 &lt;PID&gt;</code>: Sends the KILL signal, which is a non-graceful, forceful termination. This should be used as a last resort for stuck processes.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1515879218367-8466d910aaa4?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Process Commands (Linux)",
                        "language": "bash",
                        "code": "# Show a snapshot of all running processes\nps aux\n\n# Filter the process list to find a specific program (e.g., firefox)\nps aux | grep firefox\n\n# Find the PID of a process by name\npidof firefox\n\n# Terminate the process with PID 1234 gracefully\nkill 1234\n\n# Forcefully terminate the process with PID 5678\nkill -9 5678"
                    },
                    {
                        "title": "Process Commands (Windows PowerShell)",
                        "language": "powershell",
                        "code": "# Get a list of all processes\nGet-Process\n\n# Find a specific process by name\nGet-Process -Name \"notepad\"\n\n# Terminate all notepad processes by name\nStop-Process -Name \"notepad\"\n\n# Terminate a process by its ID\nStop-Process -Id 1234"
                    }
                ]
            },
            "quiz": {
                "passingScore": 80,
                "questions": [
                    {
                        "id": 1,
                        "question": "What is a 'process' in an operating system?",
                        "options": ["A file stored on the hard drive", "An instance of a computer program that is being executed", "A hardware component on the motherboard", "A user account"],
                        "correct": 1,
                        "explanation": "A process is the active, running instance of a program, to which the OS has allocated resources like memory and CPU time."
                    },
                    {
                        "id": 2,
                        "question": "Which command in Linux provides a real-time, interactive view of running processes, similar to the Windows Task Manager?",
                        "options": ["ps", "kill", "top", "ls"],
                        "correct": 2,
                        "explanation": "`top` (and its enhanced version `htop`) provides a continuously updated display of system processes and resource usage."
                    },
                    {
                        "id": 3,
                        "question": "You have an unresponsive application on Linux with PID 3456. You have tried `kill 3456` but it didn't work. What is the next, more forceful command you should use?",
                        "options": ["kill -15 3456", "kill -9 3456", "kill --force 3456", "stop 3456"],
                        "correct": 1,
                        "explanation": "`kill -9` sends the SIGKILL signal, which is a non-catchable signal that tells the kernel to immediately terminate the process. It's a last resort as it doesn't allow the program to clean up after itself."
                    },
                    {
                        "id": 4,
                        "question": "Which PowerShell command is used to list all the running processes on a Windows machine?",
                        "options": ["List-Process", "Show-Process", "Get-Process", "ps"],
                        "correct": 2,
                        "explanation": "`Get-Process` is the standard PowerShell cmdlet for retrieving a list of active processes. `ps` is often an alias for it."
                    }
                ]
            }
        },
        {
            "id": "lesson-10",
            "title": "Package Management",
            "duration": "90 min",
            "objectives": [
                "Understand the role of a package manager in software installation and maintenance.",
                "Learn to use Debian/Ubuntu's `apt` package manager.",
                "Learn to use Red Hat/CentOS's `yum`/`dnf` package managers.",
                "Explore `Chocolatey` as a package manager for Windows."
            ],
            "content": {
                "overview": "Installing software by downloading it from a website and clicking 'next' is common on desktops, but on servers, a more robust and automated method is needed. Package managers are tools that automate the process of installing, updating, configuring, and removing software packages. This lesson covers the dominant package management systems in the Linux world and an increasingly popular equivalent for Windows.",
                "sections": [
                    {
                        "title": "What is a Package Manager?",
                        "content": "<p>A package manager is a system that handles the entire lifecycle of software on an OS. It works with <strong>packages</strong>, which are archives containing the program's files, and metadata about the software, such as its name, version, and most importantly, its <strong>dependencies</strong>.</p><h3>Key Functions:</h3><ul><li><strong>Dependency Resolution:</strong> This is the most critical feature. If you want to install Program A, and it requires Library B to function, the package manager will automatically download and install both.</li><li><strong>Central Repositories:</strong> Package managers download software from trusted, central online sources called repositories. This ensures software is authentic and has been tested for the OS.</li><li><strong>Easy Updates:</strong> A single command can update all the software on your entire system.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1587620962725-abab7fe55159?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Linux: `apt` vs. `dnf`/`yum`",
                        "content": "<h3>`apt` (Debian, Ubuntu, and derivatives):</h3><p>The Advanced Package Tool (apt) is the command-line tool used on Debian-based systems. It is known for its powerful dependency resolver.</p><ul><li><code>apt update</code>: Refreshes the local list of available packages from the repositories.</li><li><code>apt upgrade</code>: Upgrades all installed packages to their latest versions.</li><li><code>apt install &lt;package_name&gt;</code>: Installs a new package.</li><li><code>apt remove &lt;package_name&gt;</code>: Uninstalls a package.</li></ul><h3>`dnf` and `yum` (Red Hat, CentOS, Fedora):</h3><p><code>yum</code> (Yellowdog Updater, Modified) was the long-standing package manager for the Red Hat family. In recent versions, it has been replaced by its successor, <strong>`dnf`</strong> (Dandified YUM), which offers better performance and a more robust dependency resolver. The commands are largely identical.</p><ul><li><code>dnf check-update</code>: Checks for available updates.</li><li><code>dnf upgrade</code>: Upgrades all installed packages.</li><li><code>dnf install &lt;package_name&gt;</code>: Installs a new package.</li><li><code>dnf remove &lt;package_name&gt;</code>: Uninstalls a package.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1629654297299-c8506221ca97?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Windows: Chocolatey and Winget",
                        "content": "<p>Traditionally, Windows has lacked a built-in, command-line package manager. This has changed recently, but the most established third-party tool is <strong>Chocolatey</strong>.</p><h3>Chocolatey:</h3><p>Chocolatey brings the convenience of a Linux package manager to Windows. It is built on top of PowerShell and allows you to install thousands of common Windows applications and tools from the command line.</p><ul><li><code>choco install &lt;package_name&gt;</code>: Installs a package.</li><li><code>choco upgrade &lt;package_name&gt;</code>: Upgrades a package.</li><li><code>choco uninstall &lt;package_name&gt;</code>: Uninstalls a package.</li></ul><h3>Winget:</h3><p>Microsoft has now developed its own official, built-in package manager called the <strong>Windows Package Manager</strong>, which is executed with the `winget` command. It is becoming the new standard for command-line software management on Windows.</p>",
                        "image": "https://images.unsplash.com/photo-1618423377884-a81a2b72c312?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "`apt` Examples (Ubuntu/Debian)",
                        "language": "bash",
                        "code": "# First, always update your package list\nsudo apt update\n\n# Install the nginx web server\nsudo apt install nginx\n\n# Search for a package\napt search mysql-client\n\n# Remove nginx\nsudo apt remove nginx"
                    },
                    {
                        "title": "`dnf` Examples (Fedora/RHEL/CentOS)",
                        "language": "bash",
                        "code": "# Update all packages\nsudo dnf upgrade\n\n# Install the Apache web server (httpd)\nsudo dnf install httpd\n\n# Search for a package\ndnf search mariadb\n\n# Remove httpd\nsudo dnf remove httpd"
                    },
                    {
                        "title": "`Chocolatey` Examples (Windows)",
                        "language": "powershell",
                        "code": "# Search for a package\nchoco search 7zip\n\n# Install 7zip. The -y flag confirms any prompts.\nchoco install 7zip -y\n\n# Upgrade all packages managed by Chocolatey\nchoco upgrade all -y\n\n# Uninstall 7zip\nchoco uninstall 7zip"
                    }
                ]
            },
            "quiz": {
                "passingScore": 80,
                "questions": [
                    {
                        "id": 1,
                        "question": "What is the most critical function of a package manager?",
                        "options": ["Compressing software to save space", "Automatically resolving and installing dependencies", "Scanning software for viruses", "Scheduling software to run at specific times"],
                        "correct": 1,
                        "explanation": "Dependency resolution is the key feature that makes package managers so powerful. It saves administrators from the nightmare of manually finding and installing all the libraries a program needs to run."
                    },
                    {
                        "id": 2,
                        "question": "On an Ubuntu server, which command is used to install the Apache web server?",
                        "options": ["sudo yum install apache2", "sudo dnf install apache2", "sudo apt install apache2", "sudo choco install apache2"],
                        "correct": 2,
                        "explanation": "`apt` is the package manager for Debian-based systems like Ubuntu. The package name for Apache on these systems is `apache2`."
                    },
                    {
                        "id": 3,
                        "question": "You are on a CentOS server. You need to install a program. Which command are you most likely to use?",
                        "options": ["dnf install <package>", "apt install <package>", "pkg install <package>", "setup <package>"],
                        "correct": 0,
                        "explanation": "`dnf` (or `yum` on older systems) is the package manager for the Red Hat family of Linux distributions, which includes CentOS, Fedora, and RHEL."
                    },
                    {
                        "id": 4,
                        "question": "What is the purpose of the `apt update` command?",
                        "options": ["It upgrades all installed packages", "It updates the operating system kernel", "It downloads the latest list of available packages from the repositories", "It installs all available security updates"],
                        "correct": 2,
                        "explanation": "`apt update` does not install or upgrade any software. It only refreshes the local cache of package metadata, which is a necessary first step before an upgrade."
                    }
                ]
            }
        },
        {
            "id": "lesson-11",
            "title": "Networking Configuration",
            "duration": "90 min",
            "objectives": [
                "Understand basic networking concepts (IP, Subnet, Gateway, DNS).",
                "View the network configuration in Windows and Linux.",
                "Configure a static IP address in both operating systems.",
                "Use basic tools like `ping` and `ip route` to test connectivity."
            ],
            "content": {
                "overview": "Correct network configuration is essential for a server to communicate. While DHCP is convenient, servers almost always require a static IP address that does not change. This lesson covers how to view your current network settings and how to manually configure a static IP, gateway, and DNS server in both Windows Server and Linux.",
                "sections": [
                    {
                        "title": "Core Networking Parameters",
                        "content": "<p>To configure a device on a network, you need four key pieces of information:</p><ul><li><strong>IP Address:</strong> The unique logical address for your device on the network.</li><li><strong>Subnet Mask:</strong> Defines the size of the local network and separates the network portion of the IP from the host portion.</li><li><strong>Default Gateway:</strong> The IP address of the router on your local network that provides a path to external networks (like the internet).</li><li><strong>DNS Server:</strong> The IP address of a server that resolves domain names (like `google.com`) into IP addresses.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1487058792275-0ad4aaf24ca7?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Networking in Windows",
                        "content": "<h3>Viewing Configuration:</h3><p>The easiest way to view network settings is with `ipconfig /all` in Command Prompt or PowerShell. The GUI method is through the 'Network & Sharing Center' or the modern 'Settings' app.</p><h3>Static Configuration:</h3><p>Static IPs are typically set through the GUI by going to the properties of a network adapter, selecting 'Internet Protocol Version 4 (TCP/IPv4)', and manually entering the IP, subnet, gateway, and DNS information. PowerShell also provides cmdlets like `New-NetIPAddress` for scripting this.</p>",
                        "image": "https://images.unsplash.com/photo-1618423377884-a81a2b72c312?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Networking in Linux",
                        "content": "<h3>Viewing Configuration:</h3><p>The modern command to view network settings is `ip addr` (to see IPs) and `ip route` (to see the default gateway). The older `ifconfig` command is still found on some systems.</p><h3>Static Configuration (Netplan):</h3><p>Modern Ubuntu systems use a utility called <strong>Netplan</strong> to configure networking. It uses simple, declarative YAML files located in `/etc/netplan/`. After editing the YAML file, you run `sudo netplan apply` to make the changes active.</p><h3>Static Configuration (ifupdown):</h3><p>Older Debian/Ubuntu systems used the `/etc/network/interfaces` file. Red Hat systems use scripts in `/etc/sysconfig/network-scripts/`. It's important to know which configuration method your distribution uses.</p>",
                        "image": "https://images.unsplash.com/photo-1629654297299-c8506221ca97?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Viewing Network Config (Windows)",
                        "language": "powershell",
                        "code": "# Show full IP configuration for all network adapters\nipconfig /all"
                    },
                    {
                        "title": "Viewing Network Config (Linux)",
                        "language": "bash",
                        "code": "# Show IP addresses and interfaces\nip addr\n\n# Show the routing table (including default gateway)\nip route"
                    },
                    {
                        "title": "Static IP Configuration with Netplan (Ubuntu)",
                        "language": "yaml",
                        "code": "# Edit a file like /etc/netplan/01-netcfg.yaml\n# NOTE: YAML is very sensitive to indentation! Use spaces, not tabs.\n\nnetwork:\n  version: 2\n  renderer: networkd\n  ethernets:\n    eth0:\n      dhcp4: no\n      addresses:\n        - 192.168.1.100/24\n      routes:\n        - to: default\n          via: 192.168.1.1\n      nameservers:\n        addresses: [8.8.8.8, 1.1.1.1]\n\n# After saving, run: sudo netplan apply"
                    }
                ]
            },
            "quiz": {
                "passingScore": 80,
                "questions": [
                    {
                        "id": 1,
                        "question": "What is the function of the Default Gateway?",
                        "options": ["It assigns an IP address to your computer", "It resolves hostnames to IP addresses", "It is the router that provides a path to other networks", "It is the unique address of your computer"],
                        "correct": 2,
                        "explanation": "The default gateway is the IP address of the local router that a host sends packets to when the destination is not on the same local network."
                    },
                    {
                        "id": 2,
                        "question": "Which command is used to view the IP address configuration on a Windows system?",
                        "options": ["ifconfig", "ip addr", "ipconfig", "netstat"],
                        "correct": 2,
                        "explanation": "`ipconfig` is the standard command-line tool on Windows for displaying TCP/IP network configuration."
                    },
                    {
                        "id": 3,
                        "question": "On a modern Ubuntu server, what utility is used to configure network interfaces using YAML files?",
                        "options": ["ifupdown", "NetworkManager", "systemd-networkd", "Netplan"],
                        "correct": 3,
                        "explanation": "Netplan is a declarative network configuration tool that generates backend configurations for either NetworkManager or systemd-networkd, simplifying network setup on modern Ubuntu systems."
                    },
                    {
                        "id": 4,
                        "question": "Why is it important for a server to have a static IP address?",
                        "options": ["It makes the server run faster", "It provides a stable, predictable address for clients and other servers to connect to", "Static IPs are more secure than dynamic ones", "It is required for installing software"],
                        "correct": 1,
                        "explanation": "If a server's IP address changed every time it rebooted (as with DHCP), clients wouldn't be able to find it reliably. A static IP ensures the address is permanent."
                    }
                ]
            }
        },
        {
            "id": "lesson-12",
            "title": "Remote Administration",
            "duration": "90 min",
            "objectives": [
                "Understand the importance of remote administration.",
                "Learn to connect to a Windows Server using Remote Desktop Protocol (RDP).",
                "Learn to connect to a Linux server using Secure Shell (SSH).",
                "Explore PowerShell Remoting as a powerful tool for managing Windows servers at scale."
            ],
            "content": {
                "overview": "Servers are almost always 'headless' (no monitor or keyboard attached) and stored in a secure data center. Therefore, all administration must be done remotely over the network. This lesson covers the standard remote access protocols for both Windows and Linux, enabling you to manage your servers from anywhere.",
                "sections": [
                    {
                        "title": "RDP (Remote Desktop Protocol)",
                        "content": "<p>RDP is Microsoft's proprietary protocol for providing a full graphical user interface connection to a remote Windows machine. When you connect via RDP, you see the remote server's desktop and can interact with it with your mouse and keyboard as if you were sitting in front of it.</p><h3>Key Features:</h3><ul><li><strong>Full GUI access.</strong></li><li>Transmits keyboard and mouse input, and receives screen updates.</li><li>Can redirect local resources like printers and drives.</li><li>Uses TCP port <strong>3389</strong>.</li><li>The connection is encrypted.</li></ul><p>RDP is the standard way to manage Windows Servers that have a Desktop Experience installed.</p>",
                        "image": "https://images.unsplash.com/photo-1618423377884-a81a2b72c312?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "SSH (Secure Shell)",
                        "content": "<p>SSH is the standard protocol for secure command-line access to Linux and other UNIX-like systems. It provides an encrypted channel for a remote terminal session.</p><h3>Key Features:</h3><ul><li><strong>Secure CLI access.</strong></li><li>All traffic, including authentication, is strongly encrypted.</li><li>Supports secure file transfer (SFTP) and port forwarding (tunneling).</li><li>Uses TCP port <strong>22</strong>.</li><li>Relies on key-based authentication for the highest level of security.</li></ul><p>SSH is the essential tool for every Linux administrator.</p>",
                        "image": "https://images.unsplash.com/photo-1515879218367-8466d910aaa4?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "PowerShell Remoting",
                        "content": "<p>While RDP is great for managing a single server, it doesn't scale well for automation. <strong>PowerShell Remoting</strong> allows you to run PowerShell commands and scripts on remote Windows machines. It is built on the Web Services for Management (WinRM) protocol.</p><h3>Key Features:</h3><ul><li>Execute commands on one or many machines at once.</li><li>Returns structured PowerShell objects, not just raw text, which makes scripting powerful.</li><li>Secure and encrypted.</li><li>The primary tool for automating and scaling Windows administration.</li></ul><p>You can enter an interactive session (similar to SSH) or run a single command on a remote machine.</p>",
                        "image": "https://images.unsplash.com/photo-1555949963-aa79dcee981c?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Connecting with SSH (Linux/macOS/Windows)",
                        "language": "bash",
                        "code": "# Connect to a Linux server with username 'admin'\nssh admin@192.168.1.100"
                    },
                    {
                        "title": "Connecting with RDP (Windows)",
                        "language": "text",
                        "code": "1. Open the 'Remote Desktop Connection' application (mstsc.exe).\n2. Enter the IP address or hostname of the Windows Server.\n3. Click 'Connect' and enter your credentials when prompted."
                    },
                    {
                        "title": "Using PowerShell Remoting (Windows)",
                        "language": "powershell",
                        "code": "# Enable PowerShell Remoting on the server (run once on the server)\nEnable-PSRemoting -Force\n\n# --- From the client machine ---\n\n# Enter an interactive session on a remote server\nEnter-PSSession -ComputerName 192.168.1.200 -Credential (Get-Credential)\n\n# Run a single command on the remote server\nInvoke-Command -ComputerName 192.168.1.200 -ScriptBlock { Get-Service } -Credential (Get-Credential)"
                    }
                ]
            },
            "quiz": {
                "passingScore": 80,
                "questions": [
                    {
                        "id": 1,
                        "question": "Which protocol provides secure, encrypted command-line access to a Linux server?",
                        "options": ["Telnet", "RDP", "SSH", "HTTP"],
                        "correct": 2,
                        "explanation": "SSH (Secure Shell) is the industry standard for secure remote CLI administration."
                    },
                    {
                        "id": 2,
                        "question": "What is the default TCP port for Remote Desktop Protocol (RDP)?",
                        "options": ["22", "80", "443", "3389"],
                        "correct": 3,
                        "explanation": "RDP listens on TCP port 3389 by default."
                    },
                    {
                        "id": 3,
                        "question": "You need to automate a task that involves running the same command on 50 Windows servers. Which technology is best suited for this?",
                        "options": ["Opening 50 separate RDP sessions", "PowerShell Remoting", "SSH", "Telnet"],
                        "correct": 1,
                        "explanation": "PowerShell Remoting is designed specifically for this kind of scalable, automated management of Windows systems."
                    },
                    {
                        "id": 4,
                        "question": "What is the primary advantage of using SSH keys over passwords for authentication?",
                        "options": ["Keys are easier to remember", "They are much more secure and resistant to brute-force attacks", "Keys can be shared between users", "Passwords are not supported on Linux"],
                        "correct": 1,
                        "explanation": "A cryptographic key pair is significantly more secure than a password, protecting the server from automated password guessing (brute-force) attacks."
                    }
                ]
            }
        },
        {
            "id": "lesson-13",
            "title": "Scheduled Tasks / Cron",
            "duration": "75 min",
            "objectives": [
                "Understand the importance of task automation.",
                "Learn to schedule tasks in Windows using the Task Scheduler GUI.",
                "Learn to schedule jobs in Linux using the `cron` system.",
                "Write a simple cron job to automate a backup script."
            ],
            "content": {
                "overview": "Many administrative tasks, like running backups, generating reports, or cleaning up temporary files, need to be performed on a regular schedule. Both Windows and Linux have powerful built-in schedulers to automate these jobs so they can run without manual intervention. This lesson covers the Windows Task Scheduler and the Linux cron system.",
                "sections": [
                    {
                        "title": "Windows Task Scheduler",
                        "content": "<p>The Task Scheduler (`taskschd.msc`) is a flexible GUI tool in Windows that allows you to run scripts, programs, or other actions on a schedule. It is very powerful and offers a wide range of options.</p><h3>Key Components of a Task:</h3><ul><li><strong>Triggers:</strong> Defines *when* the task runs. This can be a specific time (e.g., daily at 2 AM), on a system event (e.g., at startup), or when a specific event is logged in the Event Viewer.</li><li><strong>Actions:</strong> Defines *what* the task does. The most common action is 'Start a program', where you specify a script or executable to run.</li><li><strong>Conditions:</strong> Defines specific conditions that must be met for the task to run (e.g., 'only run if the computer is on AC power').</li><li><strong>Settings:</strong> Defines additional behaviors, like what to do if the task fails or how long it's allowed to run.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1558522195-e12713519528?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Linux `cron` System",
                        "content": "<p>The `cron` system is the standard task scheduler in the Linux world. It is driven by a daemon called `crond` that runs in the background. Each user can have their own list of scheduled jobs, which is stored in a file called a <strong>crontab</strong> (cron table).</p><h3>Crontab Syntax:</h3><p>Each line in a crontab file represents a single job and has a very specific format with five time fields followed by the command to execute.</p><pre><code># ┌───────────── minute (0 - 59)\n# │ ┌───────────── hour (0 - 23)\n# │ │ ┌───────────── day of month (1 - 31)\n# │ │ │ ┌───────────── month (1 - 12)\n# │ │ │ │ ┌───────────── day of week (0 - 6) (Sunday to Saturday)\n# │ │ │ │ │\n# * * * * *  /path/to/command</code></pre><p>An asterisk (<code>*</code>) means 'every'. For example, an asterisk in the hour field means 'every hour'.</p>",
                        "image": "https://images.unsplash.com/photo-1507925921958-8a62f3d1a50d?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Managing Cron Jobs",
                        "content": "<p>User-specific cron jobs are managed with the `crontab` command.</p><ul><li><code>crontab -e</code>: Edits your personal crontab file in the default text editor.</li><li><code>crontab -l</code>: Lists your current scheduled jobs.</li><li><code>crontab -r</code>: Removes your entire crontab (use with care).</li></ul><p>System-wide jobs, which are not tied to a specific user, are often placed as scripts in directories like `/etc/cron.daily`, `/etc/cron.hourly`, etc. The system will automatically run any scripts in these folders at the specified interval.</p>",
                        "image": "https://images.unsplash.com/photo-1515879218367-8466d910aaa4?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Creating a Scheduled Task with PowerShell",
                        "language": "powershell",
                        "code": "# Define the action (what to run)\n$action = New-ScheduledTaskAction -Execute 'C:\\Scripts\\Backup.ps1'\n\n# Define the trigger (when to run it - e.g., daily at 3 AM)\n$trigger = New-ScheduledTaskTrigger -Daily -At 3am\n\n# Register the new scheduled task\nRegister-ScheduledTask -Action $action -Trigger $trigger -TaskName \"DailyBackup\""
                    },
                    {
                        "title": "Example Cron Jobs (Linux)",
                        "language": "bash",
                        "code": "# Use `crontab -e` to open the editor, then add lines like these:\n\n# Run a backup script every day at 1:30 AM\n30 1 * * * /home/user/scripts/backup.sh\n\n# Check for updates every Sunday at 4:00 AM\n0 4 * * 0 /usr/bin/apt update\n\n# Run a monitoring script every 10 minutes\n*/10 * * * * /home/user/scripts/monitor.sh > /dev/null 2>&1"
                    }
                ]
            },
            "quiz": {
                "passingScore": 80,
                "questions": [
                    {
                        "id": 1,
                        "question": "In Linux, which command is used to edit the current user's scheduled jobs?",
                        "options": ["cron -e", "crontab -l", "crontab -e", "schedule -e"],
                        "correct": 2,
                        "explanation": "`crontab -e` opens the user's personal cron table in a text editor, allowing them to add, modify, or remove scheduled jobs."
                    },
                    {
                        "id": 2,
                        "question": "What does the cron entry `0 2 * * * /usr/bin/script.sh` mean?",
                        "options": ["Run the script every 2 minutes", "Run the script at 2:00 AM every day", "Run the script every 2 hours", "Run the script on the 2nd day of every month"],
                        "correct": 1,
                        "explanation": "The format is Min, Hour, DayOfMonth, Month, DayOfWeek. `0 2 * * *` translates to the 0th minute of the 2nd hour, every day, every month, every day of the week."
                    },
                    {
                        "id": 3,
                        "question": "In the Windows Task Scheduler, what is a 'Trigger'?",
                        "options": ["The action the task performs, like running a script", "A condition, like whether the PC is on AC power", "The security context the task runs under", "The event or schedule that causes the task to run"],
                        "correct": 3,
                        "explanation": "A trigger is the 'when' part of a scheduled task. It defines the schedule or event that initiates the task's action."
                    },
                    {
                        "id": 4,
                        "question": "What does the asterisk (`*`) signify in a cron job entry?",
                        "options": ["It means the field is disabled", "It means 'every' possible value for that field", "It means the command should be run as root", "It is a comment character"],
                        "correct": 1,
                        "explanation": "The asterisk is a wildcard that matches all possible values for a time field. For example, `*` in the hour field means 'every hour'."
                    }
                ]
            }
        },
        {
            "id": "lesson-14",
            "title": "Disk Management",
            "duration": "90 min",
            "objectives": [
                "Understand disk partitioning and volumes.",
                "Learn the concepts of RAID (Redundant Array of Independent Disks), focusing on RAID 0, 1, and 5.",
                "Explore the flexibility of the Logical Volume Manager (LVM) in Linux.",
                "Practice creating a software RAID array in Linux."
            ],
            "content": {
                "overview": "Managing storage is a core task for a system administrator. This goes beyond simply formatting a drive. This lesson introduces advanced storage concepts like RAID, which provides performance and redundancy by combining multiple physical disks, and LVM, a powerful Linux feature that allows for flexible and dynamic management of disk space.",
                "sections": [
                    {
                        "title": "RAID (Redundant Array of Independent Disks)",
                        "content": "<p>RAID is a technology that combines multiple physical disk drives into a single logical unit for the purposes of data redundancy, performance improvement, or both.</p><h3>Common RAID Levels:</h3><ul><li><strong>RAID 0 (Striping):</strong> Data is split and written across two or more disks simultaneously. This provides a significant performance boost but has <strong>no redundancy</strong>. If one disk fails, all data is lost.</li><li><strong>RAID 1 (Mirroring):</strong> Data is written identically to two disks. This provides excellent redundancy (if one disk fails, the other keeps working), but you only get the storage capacity of one disk. Write performance is slightly reduced.</li><li><strong>RAID 5 (Striping with Parity):</strong> Data is striped across three or more disks, but it also writes 'parity' information. This parity data can be used to reconstruct the data from a single failed disk. It offers a good balance of performance, redundancy, and capacity. It can tolerate the failure of one disk.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1580833246815-c172a15c26e2?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Hardware vs. Software RAID",
                        "content": "<h3>Hardware RAID:</h3><p>Managed by a dedicated RAID controller card installed in the server. The OS sees the RAID array as a single disk. This offers the best performance and often has features like a battery backup for its cache, but it is expensive.</p><h3>Software RAID:</h3><p>Managed by the operating system itself. It is cheaper and more flexible but uses some of the system's CPU resources to manage the array. Both Windows (via Storage Spaces) and Linux (via `mdadm`) have robust software RAID capabilities that are perfectly suitable for many workloads.</p>",
                        "image": "https://images.unsplash.com/photo-1518770660439-4636190af475?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "LVM (Logical Volume Manager) in Linux",
                        "content": "<p>LVM is a powerful storage management layer in Linux that provides more flexibility than traditional partitioning. It allows you to manage disk space in a dynamic way.</p><h3>LVM Architecture:</h3><ol><li><strong>Physical Volumes (PVs):</strong> You initialize physical disks or partitions as PVs.</li><li><strong>Volume Groups (VGs):</strong> You add one or more PVs into a single pool of storage called a VG.</li><li><strong>Logical Volumes (LVs):</strong> You carve out Logical Volumes from the VG. These LVs are what you format with a file system (e.g., ext4) and mount.</li></ol><div class=\"info-box tip\"><div class=\"info-box-header\"><i class=\"fas fa-lightbulb\"></i><strong>The Power of LVM</strong></div><p>The key benefit is flexibility. You can easily extend a logical volume by adding another physical disk to the volume group and resizing, all while the system is running. You can also create thin-provisioned volumes and snapshots.</p></div>",
                        "image": "https://images.unsplash.com/photo-1593349319931-06c15c89a940?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Creating a RAID 1 Array with `mdadm` (Linux)",
                        "language": "bash",
                        "code": "# (Assumes you have two unpartitioned disks, /dev/sdb and /dev/sdc)\n\n# 1. Install mdadm\nsudo apt install mdadm\n\n# 2. Create the RAID 1 array named /dev/md0\nsudo mdadm --create --verbose /dev/md0 --level=1 --raid-devices=2 /dev/sdb /dev/sdc\n\n# 3. Format the new RAID device\nsudo mkfs.ext4 /dev/md0\n\n# 4. Mount and use it\nsudo mkdir /mnt/raid1\nsudo mount /dev/md0 /mnt/raid1\n\n# 5. Check the status of the array\ncat /proc/mdstat"
                    },
                    {
                        "title": "Basic LVM Commands (Linux)",
                        "language": "bash",
                        "code": "# Initialize two disks as Physical Volumes\nsudo pvcreate /dev/sdd /dev/sde\n\n# Create a Volume Group named 'datavg' from the two PVs\nsudo vgcreate datavg /dev/sdd /dev/sde\n\n# Create a 10GB Logical Volume named 'worklv' from the VG\nsudo lvcreate -L 10G -n worklv datavg\n\n# Format and mount the new LV\nsudo mkfs.ext4 /dev/datavg/worklv\nsudo mount /dev/datavg/worklv /mnt/work"
                    }
                ]
            },
            "quiz": {
                "passingScore": 80,
                "questions": [
                    {
                        "id": 1,
                        "question": "Which RAID level provides no redundancy and stripes data across disks for performance?",
                        "options": ["RAID 1", "RAID 0", "RAID 5", "RAID 10"],
                        "correct": 1,
                        "explanation": "RAID 0 (Striping) is purely for performance. The failure of any single disk in a RAID 0 array results in the loss of all data."
                    },
                    {
                        "id": 2,
                        "question": "You have two 1 TB disks and you want to configure them to be a fault-tolerant mirror. Which RAID level should you use and what will the total capacity be?",
                        "options": ["RAID 0, 2 TB", "RAID 5, 1.5 TB", "RAID 1, 1 TB", "RAID 1, 2 TB"],
                        "correct": 2,
                        "explanation": "RAID 1 (Mirroring) writes the same data to both disks. This provides redundancy, but the total usable capacity is equal to the size of a single disk."
                    },
                    {
                        "id": 3,
                        "question": "What is the primary advantage of using LVM in Linux?",
                        "options": ["It increases the physical speed of the hard drives", "It automatically encrypts all data", "It provides flexibility to easily resize volumes and manage disk space from a storage pool", "It is the only way to format a disk"],
                        "correct": 2,
                        "explanation": "LVM abstracts the physical disks into a flexible pool of storage, making administrative tasks like extending a filesystem much easier than with static partitions."
                    },
                    {
                        "id": 4,
                        "question": "What is the minimum number of disks required for a RAID 5 array?",
                        "options": ["1", "2", "3", "4"],
                        "correct": 2,
                        "explanation": "RAID 5 requires at least three disks to function, as it stripes data across N-1 disks and writes parity information to the remaining disk."
                    }
                ]
            }
        },
        {
            "id": "lesson-15",
            "title": "Backup & Restore",
            "duration": "75 min",
            "objectives": [
                "Understand the importance of a backup strategy.",
                "Learn to use the `tar` command for archiving files in Linux.",
                "Explore the power of `rsync` for efficient, incremental backups.",
                "Get an overview of the Windows Server Backup feature."
            ],
            "content": {
                "overview": "Data is the most valuable asset on any server. A robust backup and restore plan is not optional; it is a critical responsibility of any system administrator. This lesson introduces fundamental backup concepts and covers essential command-line tools in Linux (`tar` and `rsync`) and the built-in backup utility in Windows Server.",
                "sections": [
                    {
                        "title": "Backup Strategy: The 3-2-1 Rule",
                        "content": "<p>A common best practice for backups is the 3-2-1 rule:</p><ul><li>Have at least <strong>3</strong> total copies of your data.</li><li>Store the copies on <strong>2</strong> different types of media (e.g., internal disk and a network share).</li><li>Keep <strong>1</strong> copy off-site.</li></ul><p>This strategy protects against a wide range of failures, from a single disk crash to a fire or disaster at your primary location.</p>",
                        "image": "https://images.unsplash.com/photo-1593349319931-06c15c89a940?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Archiving with `tar` (Linux)",
                        "content": "<p>The `tar` (tape archive) command is a classic Unix utility used to combine multiple files into a single archive file. It is often used with a compression utility like `gzip` or `bzip2` to reduce the size.</p><h3>Common `tar` Operations:</h3><ul><li><code>c</code>: Create an archive.</li><li><code>x</code>: Extract an archive.</li><li><code>v</code>: Verbose - show the files being processed.</li><li><code>f</code>: Specifies the archive filename.</li><li><code>z</code>: Filter the archive through `gzip` (creates a `.tar.gz` file).</li><li><code>j</code>: Filter the archive through `bzip2` (creates a `.tar.bz2` file).</li></ul><p>For example, `tar -cvzf backup.tar.gz /home/user/data` would create a compressed archive of the data directory.</p>",
                        "image": "https://images.unsplash.com/photo-1515879218367-8466d910aaa4?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Incremental Backups with `rsync` (Linux)",
                        "content": "<p>Making a full backup every time can be slow and consume a lot of space. `rsync` is an extremely powerful and efficient tool for synchronizing files and directories between two locations (either on the same machine or to a remote server over SSH).</p><p>Its key feature is its 'delta-transfer' algorithm. On subsequent runs, `rsync` will only copy the parts of files that have actually changed. This makes it incredibly fast for daily, incremental backups.</p>",
                        "image": "https://images.unsplash.com/photo-1587397845756-230954736914?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Windows Server Backup",
                        "content": "<p>Windows Server includes a built-in feature called Windows Server Backup. It needs to be installed as a feature from the Server Manager.</p><h3>Key Features:</h3><ul><li><strong>GUI Wizard:</strong> Provides a simple graphical interface to configure scheduled backups or run a one-time backup.</li><li><strong>Backup Types:</strong> Can perform a full server backup, or you can select specific volumes, files, or the system state.</li><li><strong>Destinations:</strong> Can back up to a local drive, a dedicated hard disk, or a remote network share.</li><li><strong>VSS Integration:</strong> Uses the Volume Shadow Copy Service (VSS) to back up open and locked files, which is critical for backing up a live server.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1618423377884-a81a2b72c312?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "`tar` Examples",
                        "language": "bash",
                        "code": "# Create a gzipped archive of the /etc directory\nsudo tar -cvzf etc-backup.tar.gz /etc\n\n# Extract the archive into the current directory\ntar -xvzf etc-backup.tar.gz"
                    },
                    {
                        "title": "`rsync` Examples",
                        "language": "bash",
                        "code": "# Sync a local folder to a backup drive\n# -a: archive mode (preserves permissions, ownership, etc.)\n# -v: verbose\n# --delete: deletes files in the destination if they are removed from the source\nrsync -av --delete /home/user/documents /mnt/backup/documents\n\n# Sync a local folder to a remote server over SSH\nrsync -avz -e ssh /home/user/documents user@remoteserver:/backups/documents"
                    }
                ]
            },
            "quiz": {
                "passingScore": 80,
                "questions": [
                    {
                        "id": 1,
                        "question": "What is the 3-2-1 backup rule?",
                        "options": ["3 backups per day, 2 per week, 1 per month", "3 users, 2 groups, 1 administrator", "3 total copies, on 2 different media, with 1 copy off-site", "3 full backups, 2 incremental, 1 differential"],
                        "correct": 2,
                        "explanation": "The 3-2-1 rule is a widely recognized best practice for ensuring your data is safe from a wide variety of failure scenarios."
                    },
                    {
                        "id": 2,
                        "question": "Which Linux command is used to create an archive by combining multiple files into one?",
                        "options": ["gzip", "rsync", "tar", "dd"],
                        "correct": 2,
                        "explanation": "`tar` is the standard utility for creating archives. It is often combined with a compression tool like `gzip` (using the `z` flag)."
                    },
                    {
                        "id": 3,
                        "question": "What is the primary advantage of using `rsync` for regular backups?",
                        "options": ["It encrypts the backup file", "It is very easy for beginners to use", "It only transfers the parts of files that have changed, making it very fast and efficient", "It can only be used to back up to tape drives"],
                        "correct": 2,
                        "explanation": "`rsync`'s delta-transfer algorithm is its key feature, minimizing the amount of data that needs to be copied after the initial full backup, which saves time and bandwidth."
                    },
                    {
                        "id": 4,
                        "question": "What is VSS (Volume Shadow Copy Service) in Windows?",
                        "options": ["A tool for managing disk partitions", "A service that allows backups of files that are currently open and in use", "A way to encrypt backup files", "A hardware card for accelerating backups"],
                        "correct": 1,
                        "explanation": "VSS is a critical Windows technology that creates a temporary, read-only 'snapshot' of a volume, allowing backup programs to copy a consistent version of files even if they are locked by other applications."
                    }
                ]
            }
        },
        {
            "id": "lesson-16",
            "title": "Security Policies",
            "duration": "75 min",
            "objectives": [
                "Understand the importance of security policies for hardening systems.",
                "Learn about password policies and account lockout settings.",
                "Explore the User Account Control (UAC) feature in Windows.",
                "Understand how to enforce policies centrally using Group Policy (GPO)."
            ],
            "content": {
                "overview": "A default OS installation is not secure. Hardening a system involves implementing security policies to reduce its vulnerability to attack. This lesson covers some of the most fundamental security settings, including enforcing strong passwords and controlling user privileges, and shows how these can be managed centrally in a Windows domain.",
                "sections": [
                    {
                        "title": "Password and Account Lockout Policies",
                        "content": "<p>One of the simplest yet most effective security controls is a strong password policy. This is a set of rules designed to enhance password security and prevent brute-force attacks.</p><h3>Common Password Policy Settings:</h3><ul><li><strong>Minimum Password Length:</strong> The minimum number of characters required.</li><li><strong>Complexity Requirements:</strong> Requires use of different character classes (uppercase, lowercase, numbers, symbols).</li><li><strong>Password History:</strong> Remembers a number of previous passwords to prevent reuse.</li><li><strong>Maximum Password Age:</strong> Forces users to change their password after a certain period.</li></ul><h3>Account Lockout Policy:</h3><p>This policy helps to thwart brute-force attacks by locking a user account after a specified number of failed login attempts for a set duration.</p>",
                        "image": "https://images.unsplash.com/photo-1526374965328-5f61d4dc18c5?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Enforcing Policies with GPO (Windows)",
                        "content": "<p>In a Windows Active Directory environment, all of these settings are configured centrally using <strong>Group Policy Objects (GPO)</strong>. An administrator can create a GPO with specific password and lockout policies and link it to an Organizational Unit (OU) containing user or computer accounts.</p><p>When the computers in that OU refresh their policy, the settings are automatically applied and enforced. This ensures that all computers and users in the domain adhere to the same security baseline without needing to configure each one manually.</p>",
                        "image": "https://images.unsplash.com/photo-1544198365-f5d60b6d8190?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "User Account Control (UAC) in Windows",
                        "content": "<p>UAC is a security feature designed to prevent unauthorized changes to the operating system. Even when you are logged in as an administrator, applications run with standard user privileges by default. When an action requires administrative privileges (like installing software or changing a system setting), UAC presents a prompt asking for confirmation.</p><p>This helps prevent malware from silently gaining administrative rights and making malicious changes to the system. It forces the user (or the malware) to explicitly request and be granted elevated privileges.</p>",
                        "image": "https://images.unsplash.com/photo-1618423377884-a81a2b72c312?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Security Policies in Linux",
                        "content": "<p>In Linux, security policies are often managed by editing configuration files. For example, password policies can be configured using Pluggable Authentication Modules (PAM) by editing files in `/etc/pam.d/`. For example, the `pam_pwquality` module can be used to enforce password complexity.</p><p>The concept of least privilege is enforced through the `sudo` system, which is configured in the `/etc/sudoers` file. This allows administrators to grant specific users the ability to run only the specific commands they need, rather than giving them full root access.</p>",
                        "image": "https://images.unsplash.com/photo-1629654297299-c8506221ca97?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Viewing Local Security Policy (Windows)",
                        "language": "text",
                        "code": "You can view the local password and lockout policies on a standalone Windows machine by running `secpol.msc`."
                    },
                    {
                        "title": "Configuring Password Quality (Linux)",
                        "language": "bash",
                        "code": "# On many systems, you can edit the /etc/security/pwquality.conf file\n# to set password complexity rules.\n\n# Example settings in pwquality.conf:\n# minlen = 12\n# dcredit = -1  (at least one digit)\n# ucredit = -1  (at least one uppercase)\n# lcredit = -1  (at least one lowercase)"
                    }
                ]
            },
            "quiz": {
                "passingScore": 80,
                "questions": [
                    {
                        "id": 1,
                        "question": "What is the purpose of an Account Lockout Policy?",
                        "options": ["To force users to change their passwords regularly", "To prevent brute-force password guessing attacks", "To ensure users choose complex passwords", "To automatically log users out after a period of inactivity"],
                        "correct": 1,
                        "explanation": "By locking an account after a few failed login attempts, the policy makes it computationally infeasible for an attacker to guess a password through automated trial and error."
                    },
                    {
                        "id": 2,
                        "question": "In a large Windows domain, what is the standard tool for centrally configuring and enforcing security settings like password policies?",
                        "options": ["The Registry Editor", "User Account Control (UAC)", "Group Policy Objects (GPOs)", "The `net user` command"],
                        "correct": 2,
                        "explanation": "Group Policy is the core technology in Active Directory for deploying and enforcing security and configuration settings across an entire network of computers and users."
                    },
                    {
                        "id": 3,
                        "question": "What does User Account Control (UAC) in Windows help prevent?",
                        "options": ["Users from choosing simple passwords", "Remote login attacks", "Unauthorized applications from making administrative changes without the user's consent", "Users from accessing the internet"],
                        "correct": 2,
                        "explanation": "UAC enforces a principle of least privilege. Even for an admin, processes run as a standard user until elevation is explicitly approved via a UAC prompt, which helps to block silent malware installations."
                    },
                    {
                        "id": 4,
                        "question": "In Linux, which file is used to configure which users or groups are allowed to use the `sudo` command?",
                        "options": ["/etc/passwd", "/etc/pam.d/common-password", "/etc/sudoers", "/etc/group"],
                        "correct": 2,
                        "explanation": "The `/etc/sudoers` file contains the rules that define who can run what commands with elevated privileges. It should always be edited with the `visudo` command to prevent syntax errors."
                    }
                ]
            }
        },
        {
            "id": "lesson-17",
            "title": "Logging & Monitoring",
            "duration": "90 min",
            "objectives": [
                "Understand the importance of system logging for troubleshooting and security auditing.",
                "Learn to use the Event Viewer in Windows to analyze logs.",
                "Learn to query the systemd journal in Linux with `journalctl`.",
                "Explore the traditional syslog system and the `/var/log` directory in Linux."
            ],
            "content": {
                "overview": "When something goes wrong, the first place an administrator looks is the logs. System logs are chronological records of events that occur within an operating system or software. This lesson covers the primary logging systems in Windows and Linux, teaching you how to find, read, and filter these critical sources of information.",
                "sections": [
                    {
                        "title": "Windows Event Viewer",
                        "content": "<p>The Event Viewer (`eventvwr.msc`) is the central tool for viewing logs in Windows. It displays events from various sources in a structured format.</p><h3>Key Log Channels:</h3><ul><li><strong>Application Log:</strong> Contains events logged by applications or programs.</li><li><strong>Security Log:</strong> Records security-related events, such as valid and invalid logon attempts, and access to resources. Auditing must be enabled to populate this log.</li><li><strong>System Log:</strong> Contains events logged by Windows system components, such as driver failures or services starting and stopping.</li><li><strong>Setup Log:</strong> Contains events related to application setup.</li></ul><p>Each event has a level (e.g., Information, Warning, Error, Critical) and a unique Event ID, which can be looked up to get more information about the problem.</p>",
                        "image": "https://images.unsplash.com/photo-1526374965328-5f61d4dc18c5?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Linux: `journalctl` and the Systemd Journal",
                        "content": "<p>Modern Linux distributions that use `systemd` have a centralized and structured logging system called the Journal. The `journalctl` command is the powerful tool used to query it.</p><h3>Key `journalctl` Features:</h3><ul><li><strong>Centralized:</strong> It captures syslog messages, kernel messages, and output from services all in one place.</li><li><strong>Structured:</strong> Logs are stored with rich metadata, allowing for powerful filtering.</li><li><strong>Filtering:</strong> You can filter logs by time, service unit, priority, PID, and more.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1526628953301-3e589a6a8b74?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Linux: `syslog` and `/var/log`",
                        "content": "<p>Before `systemd`, the standard for logging was the `syslog` protocol. A daemon (like `rsyslog` or `syslog-ng`) would listen for log messages from different parts of the system and write them to plain text files in the `/var/log` directory.</p><p>This method is still widely used, and the journal often forwards its messages to `rsyslog` for compatibility. Knowing how to read these text-based logs is a crucial skill.</p><h3>Common Log Files in `/var/log`:</h3><ul><li><code>/var/log/syslog` or `/var/log/messages`: General system messages.</li><li><code>/var/log/auth.log` or `/var/log/secure`: Authentication and security-related logs (logins, sudo).</li><li><code>/var/log/dmesg`: Kernel ring buffer messages.</li><li><code>/var/log/apache2/access.log`: Web server access logs.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1504639725590-771ab665e141?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Querying Logs with PowerShell (Windows)",
                        "language": "powershell",
                        "code": "# Get the 10 most recent entries from the System log\nGet-EventLog -LogName System -Newest 10\n\n# Get all Error events from the Application log\nGet-EventLog -LogName Application -EntryType Error\n\n# A more modern cmdlet for structured logs\n# Get failed login events (Event ID 4625) from the Security log\nGet-WinEvent -FilterHashtable @{LogName='Security'; Id=4625}"
                    },
                    {
                        "title": "Querying Logs with `journalctl` (Linux)",
                        "language": "bash",
                        "code": "# Show logs for the SSH service from today\nsudo journalctl -u sshd --since today\n\n# Follow all new log messages in real-time\nsudo journalctl -f\n\n# Show only messages with a priority of 'error' or higher from the current boot\nsudo journalctl -b -p err"
                    },
                    {
                        "title": "Analyzing Text Logs with `grep` (Linux)",
                        "language": "bash",
                        "code": "# Search the authentication log for all failed password attempts for the user 'john'\nsudo grep 'Failed password for john' /var/log/auth.log\n\n# Watch the system log in real-time for any lines containing the word 'error'\nsudo tail -f /var/log/syslog | grep -i 'error'"
                    }
                ]
            },
            "quiz": {
                "passingScore": 80,
                "questions": [
                    {
                        "id": 1,
                        "question": "In Windows, which log would you check to find information about failed user logon attempts?",
                        "options": ["Application Log", "System Log", "Setup Log", "Security Log"],
                        "correct": 3,
                        "explanation": "The Security Log is specifically for recording security-related events like authentication, provided that the appropriate auditing policies are enabled."
                    },
                    {
                        "id": 2,
                        "question": "On a modern Ubuntu server, what is the primary command-line tool for querying the systemd journal?",
                        "options": ["logread", "dmesg", "journalctl", "cat /var/log/messages"],
                        "correct": 2,
                        "explanation": "`journalctl` is the powerful, dedicated tool for querying the structured logs collected by the systemd journal."
                    },
                    {
                        "id": 3,
                        "question": "Which Linux directory is the traditional location for storing plain-text log files?",
                        "options": ["/etc/logs", "/tmp/log", "/var/log", "/home/logs"],
                        "correct": 2,
                        "explanation": "The `/var/log` directory is the standard location for variable data like system logs from various applications and services."
                    },
                    {
                        "id": 4,
                        "question": "What does the command `journalctl -f` do?",
                        "options": ["It formats the journal for printing", "It finds a specific log entry", "It follows the journal, displaying new log messages in real-time", "It filters the journal by date"],
                        "correct": 2,
                        "explanation": "The `-f` or `--follow` flag provides a live view of log entries as they are being written, which is extremely useful for real-time troubleshooting."
                    }
                ]
            }
        },
        {
            "id": "lesson-18",
            "title": "Patch Management",
            "duration": "75 min",
            "objectives": [
                "Understand the critical importance of patch management for security.",
                "Learn to update a Linux system using `apt` or `dnf`.",
                "Get an overview of Windows Server Update Services (WSUS) for centralized patching.",
                "Understand the difference between security updates, feature updates, and hotfixes."
            ],
            "content": {
                "overview": "No software is perfect. Vulnerabilities are discovered in operating systems and applications all the time. Patch management is the process of distributing and applying updates to software. It is one of the most critical and recurring tasks for a system administrator to protect systems from known security exploits.",
                "sections": [
                    {
                        "title": "The Importance of Patching",
                        "content": "<p>Applying security patches is a race against attackers. Once a vulnerability is publicly disclosed, attackers immediately begin to scan the internet for unpatched systems to exploit. Failing to apply security updates in a timely manner is one of the leading causes of security breaches.</p><h3>Types of Updates:</h3><ul><li><strong>Security Patch/Update:</strong> Fixes a specific security vulnerability. These are the highest priority.</li><li><strong>Hotfix:</strong> A patch for a specific bug or issue, often not security-related.</li><li><strong>Service Pack/Cumulative Update:</strong> A large collection of patches, hotfixes, and sometimes new features, bundled together.</li><li><strong>Feature Update:</strong> Adds new functionality to the software.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1563206767-5b18f218e8de?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Patching Linux",
                        "content": "<p>Patch management in Linux is typically handled by the same package manager used for software installation. The process is simple and powerful.</p><h3>The Workflow:</h3><ol><li><strong>Update Package Lists:</strong> First, you refresh the local cache of available packages from the repositories. This ensures you are seeing the latest available versions. (e.g., <code>sudo apt update</code>)</li><li><strong>Apply Upgrades:</strong> Second, you apply the actual upgrades. The package manager will compare the versions of all installed packages against the new list and upgrade them. (e.g., <code>sudo apt upgrade</code>)</li></ol><p>This single command can patch the OS kernel, system libraries, and all applications installed from the official repositories, all at once. This process can be easily automated with a cron job.</p>",
                        "image": "https://images.unsplash.com/photo-1629654297299-c8506221ca97?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Patching Windows and WSUS",
                        "content": "<p>On a standalone Windows server, updates can be managed through the 'Windows Update' settings panel. However, in an enterprise environment, this is managed centrally by <strong>Windows Server Update Services (WSUS)</strong>.</p><h3>WSUS Workflow:</h3><ol><li>A central WSUS server is set up on the network. It downloads all updates from Microsoft.</li><li>Administrators can review and approve updates within the WSUS console. They can organize computers into groups (e.g., 'Test Servers', 'Production Servers').</li><li>Client computers are configured via Group Policy to get their updates from the internal WSUS server instead of the public internet.</li><li>Administrators can then deploy approved updates to specific groups, monitor compliance, and generate reports.</li></ol><p>This gives administrators control over which updates are deployed and when, allowing for testing before a full rollout.</p>",
                        "image": "https://images.unsplash.com/photo-1618423377884-a81a2b72c312?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Updating an Ubuntu/Debian System",
                        "language": "bash",
                        "code": "# 1. Refresh the package index\nsudo apt update\n\n# 2. Upgrade all installed packages\nsudo apt upgrade -y"
                    },
                    {
                        "title": "Updating a RHEL/CentOS/Fedora System",
                        "language": "bash",
                        "code": "# 1. Check for available updates (optional)\nsudo dnf check-update\n\n# 2. Upgrade all installed packages\nsudo dnf upgrade -y"
                    },
                    {
                        "title": "Updating with PowerShell (Windows)",
                        "language": "powershell",
                        "code": "# This requires the PSWindowsUpdate module to be installed first\n# Install-Module -Name PSWindowsUpdate -Force\n\n# Check for, download, and install all available updates, and reboot if required\nInstall-WindowsUpdate -AcceptAll -AutoReboot"
                    }
                ]
            },
            "quiz": {
                "passingScore": 80,
                "questions": [
                    {
                        "id": 1,
                        "question": "Why is timely patch management considered a critical security task?",
                        "options": ["It improves system performance", "It frees up disk space", "It protects systems against known vulnerabilities that attackers actively exploit", "It is required to receive technical support"],
                        "correct": 2,
                        "explanation": "Patch management is a race. Once a vulnerability is known, unpatched systems become easy targets. Applying security patches closes these known security holes."
                    },
                    {
                        "id": 2,
                        "question": "What is the role of Windows Server Update Services (WSUS)?",
                        "options": ["It is a third-party antivirus program", "It is a command-line tool for installing software on a single server", "It allows administrators to centrally manage, approve, and deploy Microsoft updates to computers in a network", "It is a tool for rolling back failed updates"],
                        "correct": 2,
                        "explanation": "WSUS provides centralized control over the Windows Update process, which is essential for managing updates in a corporate environment."
                    },
                    {
                        "id": 3,
                        "question": "What is the correct two-step command sequence to fully update an Ubuntu server?",
                        "options": ["apt upgrade, then apt update", "apt update, then apt upgrade", "apt patch", "apt refresh"],
                        "correct": 1,
                        "explanation": "You must first run `apt update` to refresh the package lists from the repositories. Then, `apt upgrade` uses that refreshed list to download and install the actual package updates."
                    },
                    {
                        "id": 4,
                        "question": "A large bundle of previously released patches and updates is often called a:",
                        "options": ["Hotfix", "Kernel", "Driver", "Service Pack or Cumulative Update"],
                        "correct": 3,
                        "explanation": "A service pack or cumulative update rolls up many individual patches into a single, large package for easier deployment."
                    }
                ]
            }
        },
        {
            "id": "lesson-19",
            "title": "Virtualization & Containers",
            "duration": "90 min",
            "objectives": [
                "Understand the difference between traditional virtualization and containerization.",
                "Learn the role of a hypervisor in virtualization.",
                "Explore Microsoft's Hyper-V virtualization platform.",
                "Grasp the basic concepts of Docker containers."
            ],
            "content": {
                "overview": "Virtualization revolutionized IT by allowing multiple operating systems to run on a single physical server. Containers are the next step in this evolution, providing an even more lightweight and efficient way to package and deploy applications. This lesson compares these two powerful technologies and introduces the leading platforms for each: Hyper-V and Docker.",
                "sections": [
                    {
                        "title": "Virtualization and Hypervisors",
                        "content": "<p><strong>Virtualization</strong> uses software called a <strong>hypervisor</strong> to create and run virtual machines (VMs). The hypervisor abstracts the physical hardware (CPU, RAM, disk) and presents a virtual version of that hardware to each VM.</p><p>Each VM is a complete, self-contained operating system. It has its own kernel, libraries, and applications, and is fully isolated from the host OS and other VMs. This is a powerful way to run different operating systems (like a Linux VM on a Windows host) or to isolate applications from each other.</p><h3>Hyper-V:</h3><p>Hyper-V is Microsoft's native hypervisor, built into Windows Server and professional editions of desktop Windows. It is a Type 1 (bare-metal) hypervisor, meaning it runs directly on the hardware for maximum performance.</p>",
                        "image": "https://images.unsplash.com/photo-1518709268805-4e9042af2176?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Containers and Docker",
                        "content": "<p><strong>Containerization</strong> is a more lightweight form of virtualization that operates at the OS level. Instead of virtualizing the hardware, containers virtualize the operating system.</p><p>All containers on a host share the same host OS kernel. A container is simply an isolated user-space process. It packages an application along with all of its dependencies (libraries, configuration files) into a single, runnable unit.</p><h3>Docker:</h3><p>Docker is the leading platform for building, shipping, and running containers. It has become the de facto standard for modern application deployment.</p>",
                        "image": "https://images.unsplash.com/photo-1617258693771-08f27399a133?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "VMs vs. Containers: The Key Difference",
                        "content": "<div class=\"info-box note\"><div class=\"info-box-header\"><i class=\"fas fa-info-circle\"></i><strong>Analogy</strong></div><p>Think of VMs as separate houses, each with its own foundation, plumbing, and utilities. Containers are like apartments in a single large building; they share the building's core infrastructure (the kernel) but are otherwise isolated units.</p></div><h3>Virtual Machines:</h3><ul><li><strong>Heavyweight:</strong> Each VM includes a full copy of an OS (can be gigabytes in size).</li><li><strong>Slow to start:</strong> Booting a VM is like booting a real computer.</li><li><strong>Full Isolation:</strong> A crash in one VM will not affect another. Excellent for running different operating systems.</li></ul><h3>Containers:</h3><ul><li><strong>Lightweight:</strong> A container image is typically megabytes in size.</li><li><strong>Fast to start:</strong> Starts in seconds, as there is no OS to boot.</li><li><strong>Process-level Isolation:</strong> Shares the host kernel. More efficient, but less isolated than a VM. Ideal for packaging and deploying microservices.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1573495627361-d9b87960b12d?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [
                    {
                        "title": "Creating a VM with PowerShell (Hyper-V)",
                        "language": "powershell",
                        "code": "# Create a new virtual machine\nNew-VM -Name \"UbuntuVM\" -MemoryStartupBytes 2GB -Generation 2\n\n# Add a virtual hard disk\nAdd-VMHardDiskDrive -VMName \"UbuntuVM\" -Path \"C:\\VMs\\Ubuntu.vhdx\"\n\n# Start the VM\nStart-VM -Name \"UbuntuVM\""
                    },
                    {
                        "title": "Running a Docker Container (Linux/Windows)",
                        "language": "bash",
                        "code": "# Pull the official Nginx web server image from Docker Hub\ndocker pull nginx\n\n# Run a new container from the image\n# -d: run in detached (background) mode\n# -p 8080:80: map port 8080 on the host to port 80 in the container\n# --name my-web-server: give the container a name\ndocker run -d -p 8080:80 --name my-web-server nginx\n\n# List running containers\ndocker ps\n\n# Stop the container\ndocker stop my-web-server"
                    }
                ]
            },
            "quiz": {
                "passingScore": 80,
                "questions": [
                    {
                        "id": 1,
                        "question": "What is the name of the software that creates and manages virtual machines?",
                        "options": ["A container", "An operating system", "A hypervisor", "A kernel"],
                        "correct": 2,
                        "explanation": "A hypervisor (like Hyper-V, VMware ESXi, or KVM) is the software layer that abstracts the physical hardware and allows multiple guest operating systems to run on it."
                    },
                    {
                        "id": 2,
                        "question": "What is the key difference between a virtual machine and a container?",
                        "options": ["VMs are faster than containers", "Containers run on the host OS kernel, while VMs have their own separate kernel", "VMs can't run Linux", "Containers are much larger than VMs"],
                        "correct": 1,
                        "explanation": "This is the fundamental distinction. Containers share the host kernel, making them lightweight. VMs virtualize the hardware, requiring a full guest OS for each one, making them heavyweight."
                    },
                    {
                        "id": 3,
                        "question": "Which of the following is an advantage of containers over VMs?",
                        "options": ["Better hardware-level isolation", "They can run a completely different operating system (e.g., Windows on a Linux host)", "Faster startup times and lower resource usage", "They are more secure"],
                        "correct": 2,
                        "explanation": "Because containers don't need to boot an entire operating system, they can be started and stopped in seconds and have a much smaller memory and disk footprint."
                    },
                    {
                        "id": 4,
                        "question": "What is the most popular and widely used containerization platform?",
                        "options": ["Hyper-V", "VirtualBox", "Docker", "LXC"],
                        "correct": 2,
                        "explanation": "Docker has become the industry standard for creating, managing, and deploying application containers."
                    }
                ]
            }
        },
        {
            "id": "lesson-20",
            "title": "Troubleshooting & Recovery",
            "duration": "120 min",
            "objectives": [
                "Develop a logical troubleshooting methodology.",
                "Learn to use Windows Recovery Environment (WinRE).",
                "Learn to boot into Linux rescue/emergency mode.",
                "Practice a common recovery scenario: resetting a lost root/admin password."
            ],
            "content": {
                "overview": "Even in well-managed systems, things go wrong. A bad update, a misconfiguration, or a forgotten password can render a system unbootable. This final capstone lesson covers the tools and techniques for recovering a system from a critical failure. We'll explore the built-in recovery environments of both Windows and Linux and walk through the practical skill of password recovery.",
                "sections": [
                    {
                        "title": "The Troubleshooting Mindset",
                        "content": "<p>Effective troubleshooting is a systematic process, not random guessing. A good methodology is:</p><ol><li><strong>Gather Information:</strong> What are the symptoms? When did it start? What changed recently? Check the logs!</li><li><strong>Formulate a Hypothesis:</strong> Based on the information, make an educated guess about the cause.</li><li><strong>Test the Hypothesis:</strong> Make one change at a time and test if it resolves the issue. If not, undo the change.</li><li><strong>Escalate if Necessary:</strong> If you're stuck, know when to ask for help or consult documentation.</li><li><strong>Document the Solution:</strong> Once solved, document the problem and the solution to help yourself and others in the future.</li></ol>",
                        "image": "https://images.unsplash.com/photo-1591799264318-7e6cb8dd785b?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Windows Recovery Environment (WinRE)",
                        "content": "<p>WinRE is a recovery environment that can repair common causes of unbootable operating systems. It is usually launched automatically after a few failed boot attempts, or it can be accessed by booting from Windows installation media.</p><h3>Key Tools in WinRE:</h3><ul><li><strong>System Restore:</strong> Reverts system files, drivers, and registry settings to a previous point in time.</li><li><strong>Startup Repair:</strong> Automatically diagnoses and fixes many common boot problems.</li><li><strong>Command Prompt:</strong> Provides command-line access to the file system and tools like `bootrec` to repair the MBR or BCD.</li><li><strong>Uninstall Updates:</strong> Allows you to remove a recent quality or feature update that may be causing the problem.</li></ul>",
                        "image": "https://images.unsplash.com/photo-1618423377884-a81a2b72c312?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Linux Rescue and Emergency Mode",
                        "content": "<p>Linux provides powerful recovery modes for system repair.</p><h3>Rescue Mode:</h3><p>Boots a minimal environment, mounts your root filesystem under `/mnt/sysimage`, and provides a command-line shell. This is useful for repairing file system corruption, reinstalling the bootloader, or editing configuration files on a system that won't boot properly.</p><h3>Emergency Mode:</h3><p>A more minimal mode than rescue. It provides a root shell but does not mount the root filesystem automatically. It is used for severe problems where even mounting the filesystem is failing.</p><p>You can access these modes by editing the boot entry in GRUB and adding `systemd.unit=rescue.target` or `systemd.unit=emergency.target` to the kernel line.</p>",
                        "image": "https://images.unsplash.com/photo-1629654297299-c8506221ca97?w=800&h=400&fit=crop"
                    },
                    {
                        "title": "Lab: Root Password Recovery (Linux)",
                        "content": "<p>A common troubleshooting task is resetting a lost root password. This is done by interrupting the boot process to gain access to a root shell.</p><ol><li>Reboot the Linux VM and press `e` at the GRUB menu to edit the boot entry.</li><li>Find the line that starts with `linux` or `linuxefi`.</li><li>Go to the end of that line and add `init=/bin/bash`.</li><li>Press `Ctrl+X` or `F10` to boot.</li><li>The system will boot directly to a root shell with the filesystem mounted as read-only.</li><li>Remount the root filesystem as read-write: `mount -o remount,rw /`</li><li>Change the root password: `passwd`</li><li>Reboot the system: `exec /sbin/init` or force a reboot.</li></ol>",
                        "image": "https://images.unsplash.com/photo-1515879218367-8466d910aaa4?w=800&h=400&fit=crop"
                    }
                ],
                "codeExamples": [],
                },
                "quiz": {
                    "passingScore": 80,
                    "questions": [
                        {
                            "id": 1,
                            "question": "What is the first step in a logical troubleshooting methodology?",
                            "options": ["Make a change to the system", "Reboot the server", "Gather information and observe the symptoms", "Ask for help"],
                            "correct": 2,
                            "explanation": "Before you can solve a problem, you must first understand it. Gathering information from logs, users, and system behavior is always the crucial first step."
                        },
                        {
                            "id": 2,
                            "question": "Which Windows environment is used to repair common causes of an unbootable OS?",
                            "options": ["PowerShell ISE", "Server Manager", "Windows Recovery Environment (WinRE)", "Hyper-V"],
                            "correct": 2,
                            "explanation": "WinRE is the dedicated recovery platform that includes tools like Startup Repair and System Restore to fix non-booting systems."
                        },
                        {
                            "id": 3,
                            "question": "In Linux, if you need to repair a system where the root filesystem can still be mounted, which mode is most appropriate?",
                            "options": ["Emergency Mode", "Rescue Mode", "Safe Mode", "User Mode"],
                            "correct": 1,
                            "explanation": "Rescue Mode is designed for this scenario. It mounts the existing system filesystem and provides a shell, allowing you to work on the damaged system."
                        },
                        {
                            "id": 4,
                            "question": "What is the key step to gaining access to a Linux system to reset a lost root password?",
                            "options": ["Booting from a live CD", "Editing the GRUB bootloader entry to change the init process", "Using the `sudo` command", "Deleting the `/etc/shadow` file"],
                            "correct": 1,
                            "explanation": "By interrupting the GRUB bootloader, you can alter the kernel boot parameters to launch a root shell (`/bin/bash`) instead of the normal init system, giving you immediate administrative access."
                    }
                ]
            }
        }
    ]
};
// =====================================================
// GLOBAL VARIABLES
// =====================================================
let currentUser = null;
let currentLessonIndex = 0;
let courseProgress = {};
let userStats = {};
let quizState = {
    currentQuestion: 0,
    answers: [],
    score: 0,
    isComplete: false
};

// Enhanced session tracking
let courseSession = {
    startTime: null,
    totalStudyTime: 0,
    lessonsStarted: 0,
    lessonsCompleted: 0,
    pageLoadTime: new Date(),
    interactionCount: 0,
    lastActivityTime: new Date()
};

// Music Player Variables
let audioPlayer = new Audio();

// Achievement notification system
let notificationQueue = [];
let isShowingNotification = false;

// =====================================================
// INITIALIZATION
// =====================================================
document.addEventListener('DOMContentLoaded', async () => {
    try {
        showLoadingScreen();
        await checkAuth();
        
        if (currentUser) {
            // Initialize session tracking
            startCourseSession();
            
            // Load course data and progress
            await loadCourseData();
            await loadUserProfile();
            await loadProgress();
            
            // Initialize UI
            initializeEventListeners();
            renderSidebar();
            loadLesson(currentLessonIndex);
            
            // Initialize additional features
            initMusicPlayer();
            addMusicIndicator();
            initializeActivityTracking();
            
            hideLoadingScreen();
        } else {
            openAuthModal();
        }
    } catch (error) {
        console.error('Error initializing course:', error);
        hideLoadingScreen();
        showToast('Failed to initialize course system', 'error');
    }
});

// =====================================================
// AUTHENTICATION SYSTEM
// =====================================================
async function checkAuth() {
    try {
        const { data: { session }, error } = await supabase.auth.getSession();
        
        if (error) {
            console.error('Auth error:', error);
            currentUser = null;
            openAuthModal();
            return;
        }

        if (!session) {
            currentUser = null;
            openAuthModal();
            return;
        }

        currentUser = session.user;
        updateUIWithUser();
    } catch (error) {
        console.error('Error checking auth:', error);
        currentUser = null;
        openAuthModal();
    }
}

function updateUIWithUser() {
    if (!currentUser) return;
    
    const name = currentUser.user_metadata?.full_name || currentUser.email.split('@')[0];
    const userElements = document.querySelectorAll('[data-user-name]');
    userElements.forEach(el => el.textContent = name);
}

// =====================================================
// USER PROFILE & STATS MANAGEMENT
// =====================================================
async function loadUserProfile() {
  try {
    // 🔍 Step 1: Try to fetch existing profile
    const { data: profile, error } = await supabase
      .from('profiles')
      .select('*')
      .eq('id', currentUser.id)
      .single();

    if (error && error.code !== 'PGRST116') {
      throw error;
    }

    if (!profile) {
      // 🆕 Step 2: Create new profile if missing
      await createUserProfile();
    } else {
      // ✅ Step 3: Use existing profile
      userStats = profile;
      await updateLastActivity();
    }

  } catch (error) {
    console.error('❌ Error loading user profile:', error);
    showToast('Failed to load user profile', 'error');
  }
}
async function createUserProfile() {
    try {
        const newProfile = {
            id: currentUser.id,
            full_name: currentUser.user_metadata?.full_name || '',
            email: currentUser.email,
            level: 'Script Kiddie',
            total_points: 0,
            completed_courses: 0,
            current_streak: 0,
            total_certificates: 0,
            total_achievements: 0,
            sections_visited: 0,
            bonus_points: 0,
            in_progress_courses: 0,
            settings_changed: 0,
            midnight_sessions: 0,
            early_sessions: 0,
            weekend_sessions: 0,
            last_activity: new Date().toISOString(),
            created_at: new Date().toISOString()
        };

        const { error } = await supabase
            .from('profiles')
            .insert([newProfile]);

        if (!error) {
            userStats = newProfile;
            // Award first login achievement
            setTimeout(() => checkAndUnlockAchievement('first_login'), 1000);
        }
    } catch (error) {
        console.error('Error creating user profile:', error);
    }
}

async function updateLastActivity() {
    try {
        const now = new Date();
        
        // Update activity tracking
        courseSession.lastActivityTime = now;
        
        // Update database
        await supabase
            .from('profiles')
            .update({ 
                last_activity: now.toISOString()
            })
            .eq('id', currentUser.id);

        // Check time-based achievements
        await checkTimeBasedAchievements(now);
        
    } catch (error) {
        console.error('Error updating last activity:', error);
    }
}

// =====================================================
// COURSE SESSION MANAGEMENT
// =====================================================
function startCourseSession() {
    courseSession.startTime = new Date();
    courseSession.pageLoadTime = new Date();
    
    logUserActivity('course_session_start', {
        course_id: COURSE_DATA.id,
        course_title: COURSE_DATA.title,
        user_agent: navigator.userAgent,
        screen_resolution: `${screen.width}x${screen.height}`
    });
    
    // Check daily streak
    checkDailyStreak();
}

function initializeActivityTracking() {
    // Track page focus/blur for accurate study time
    document.addEventListener('visibilitychange', handleVisibilityChange);
    
    // Track user interactions
    ['click', 'keydown', 'scroll', 'mousemove'].forEach(event => {
        document.addEventListener(event, trackUserInteraction, { passive: true });
    });
    
    // Periodic activity updates
    setInterval(updateStudyTime, 60000); // Every minute
    
    // Save session data before page unload
    window.addEventListener('beforeunload', saveSessionData);
}

function handleVisibilityChange() {
    if (document.hidden) {
        courseSession.lastActivityTime = new Date();
    } else {
        // Page became visible again - update activity
        updateLastActivity();
    }
}

function trackUserInteraction() {
    courseSession.interactionCount++;
    courseSession.lastActivityTime = new Date();
    
    // Throttle activity updates
    if (courseSession.interactionCount % 50 === 0) {
        updateLastActivity();
    }
}

function updateStudyTime() {
    if (!courseSession.startTime || document.hidden) return;
    
    const now = new Date();
    const sessionDuration = now - courseSession.startTime;
    courseSession.totalStudyTime = Math.floor(sessionDuration / 1000 / 60); // in minutes
    
    // Update progress with study time
    saveProgress();
}

function saveSessionData() {
    if (!currentUser || !courseSession.startTime) return;
    
    const sessionData = {
        user_id: currentUser.id,
        course_id: COURSE_DATA.id,
        session_duration: courseSession.totalStudyTime,
        lessons_viewed: courseSession.lessonsStarted,
        lessons_completed: courseSession.lessonsCompleted,
        interactions: courseSession.interactionCount,
        session_date: courseSession.startTime.toISOString().split('T')[0]
    };
    
    // Store in localStorage as backup
    localStorage.setItem('course_session_backup', JSON.stringify(sessionData));
    
    // Try to save to database
    logUserActivity('course_session_end', sessionData);
}

// =====================================================
// COURSE DATA & PROGRESS MANAGEMENT
// =====================================================
async function loadCourseData() {
    try {
        // Update course info in UI
        document.getElementById('courseTitle').textContent = COURSE_DATA.title;
        document.getElementById('totalLessons').textContent = COURSE_DATA.lessons.length;
        
        // Log course access
        logUserActivity('course_access', {
            course_id: COURSE_DATA.id,
            course_title: COURSE_DATA.title
        });
        
    } catch (error) {
        console.error('Error loading course data:', error);
    }
}

async function loadProgress() {
    try {
        // Get existing progress from database
        const { data, error } = await supabase
            .from('course_progress')
            .select('*')
            .eq('user_id', currentUser.id)
            .eq('course_id', COURSE_DATA.id)
            .single();

        if (error && error.code !== 'PGRST116') {
            throw error;
        }

        if (data) {
            courseProgress = JSON.parse(data.lesson_progress || '{}');
            currentLessonIndex = data.current_lesson || 0;
            
            // Update session tracking
            courseSession.lessonsStarted = Object.keys(courseProgress).length;
            courseSession.lessonsCompleted = Object.values(courseProgress).filter(p => p.completed).length;
        } else {
            // Initialize new progress
            courseProgress = {};
            currentLessonIndex = 0;
            await saveProgress();
            
            // Award first course start achievement
            await checkAndUnlockAchievement('first_course_start');
        }

        updateProgressDisplay();
        
    } catch (error) {
        console.error('Error loading progress:', error);
        showToast('Failed to load progress', 'error');
    }
}

async function saveProgress() {
    try {
        if (!currentUser) return;

        const now = new Date();
        const progressData = {
            user_id: currentUser.id,
            course_id: COURSE_DATA.id,
            course_title: COURSE_DATA.title,
            current_lesson: currentLessonIndex,
            lesson_progress: JSON.stringify(courseProgress),
            progress: calculateOverallProgress(),
            lessons_completed: getCompletedLessonsCount(),
            lessons_started: Object.keys(courseProgress).length,
            study_time_minutes: courseSession.totalStudyTime,
            last_accessed: now.toISOString(),
            updated_at: now.toISOString()
        };

        // Upsert progress
        const { error } = await supabase
            .from('course_progress')
            .upsert([progressData]);

        if (error) throw error;

        // Update user stats
        await updateUserStats();
        
        updateProgressDisplay();

    } catch (error) {
        console.error('Error saving progress:', error);
        showToast('Failed to save progress', 'error');
    }
}

async function updateUserStats() {
    try {
        // Get all course progress for this user
        const { data: allProgress, error } = await supabase
            .from('course_progress')
            .select('progress, course_id, study_time_minutes')
            .eq('user_id', currentUser.id);

        if (error) throw error;

        // Calculate stats
        const completedCourses = allProgress?.filter(p => p.progress >= 100).length || 0;
        const inProgressCourses = allProgress?.filter(p => p.progress > 0 && p.progress < 100).length || 0;
        const totalStudyTime = allProgress?.reduce((sum, p) => sum + (p.study_time_minutes || 0), 0) || 0;

        // Calculate points (500 per completed course + achievement points)
        const coursePoints = completedCourses * 500;
        const bonusPoints = userStats.bonus_points || 0;
        const totalPoints = coursePoints + bonusPoints;

        // Update profile
        const updateData = {
            completed_courses: completedCourses,
            in_progress_courses: inProgressCourses,
            total_points: totalPoints,
            total_study_time: totalStudyTime,
            last_activity: new Date().toISOString()
        };

        const { error: updateError } = await supabase
            .from('profiles')
            .update(updateData)
            .eq('id', currentUser.id);

        if (updateError) throw updateError;

        // Update local stats
        Object.assign(userStats, updateData);

    } catch (error) {
        console.error('Error updating user stats:', error);
    }
}

function calculateOverallProgress() {
    const completedLessons = getCompletedLessonsCount();
    return Math.round((completedLessons / COURSE_DATA.lessons.length) * 100);
}

function getCompletedLessonsCount() {
    return Object.values(courseProgress).filter(lesson => lesson.completed).length;
}

function updateProgressDisplay() {
    const completedCount = getCompletedLessonsCount();
    const progressPercent = calculateOverallProgress();
    
    // Update UI elements
    const elements = {
        'completedLessons': completedCount,
        'courseProgressPercent': `${progressPercent}%`
    };
    
    Object.entries(elements).forEach(([id, value]) => {
        const element = document.getElementById(id);
        if (element) element.textContent = value;
    });
    
    // Update progress bar
    const progressBar = document.getElementById('courseProgressFill');
    if (progressBar) progressBar.style.width = `${progressPercent}%`;
}

// =====================================================
// LESSON MANAGEMENT
// =====================================================
function loadLesson(index) {
    if (index < 0 || index >= COURSE_DATA.lessons.length) return;

    const lesson = COURSE_DATA.lessons[index];
    currentLessonIndex = index;

    // Mark lesson as started and track activity
    if (!courseProgress[lesson.id]) {
        courseProgress[lesson.id] = { 
            started: true, 
            completed: false,
            startedAt: new Date().toISOString(),
            timeSpent: 0
        };
        
        courseSession.lessonsStarted++;
        saveProgress();
        
        // Log lesson start
        logUserActivity('lesson_start', {
            lesson_id: lesson.id,
            lesson_title: lesson.title,
            lesson_index: index
        });
    }

    // Update lesson start time for time tracking
    courseProgress[lesson.id].currentSessionStart = new Date();

    // Update sidebar and navigation
    renderSidebar();
    updateNavigationButtons();

    // Update header info
    updateLessonHeader(lesson, index);

    // Render lesson content
    renderLessonContent(lesson);

    // Smooth scroll and animations
    window.scrollTo({ top: 0, behavior: 'smooth' });
    document.getElementById('contentBody').scrollTop = 0;

    const contentBody = document.getElementById('contentBody');
    contentBody.classList.add('fade-in');
    setTimeout(() => contentBody.classList.remove('fade-in'), 500);
    
    // Check lesson-based achievements
    checkLessonAchievements(index + 1);
}

function updateLessonHeader(lesson, index) {
    const elements = {
        'currentLessonNumber': index + 1,
        'currentLessonTitle': lesson.title,
        'navInfo': `Lesson ${index + 1} of ${COURSE_DATA.lessons.length}`
    };
    
    Object.entries(elements).forEach(([id, value]) => {
        const element = document.getElementById(id);
        if (element) element.textContent = value;
    });
}

function renderSidebar() {
    const lessonNav = document.getElementById('lessonNav');
    if (!lessonNav) return;
    
    lessonNav.innerHTML = '';

    COURSE_DATA.lessons.forEach((lesson, index) => {
        const lessonItem = document.createElement('div');
        lessonItem.className = 'lesson-item';
        
        // Determine lesson status
        const lessonProgress = courseProgress[lesson.id];
        const isCompleted = lessonProgress?.completed || false;
        const isInProgress = lessonProgress?.started || false;
        const isLocked = !isCompleted && !canAccessLesson(index);
        const isActive = index === currentLessonIndex;

        // Apply status classes
        if (isCompleted) lessonItem.classList.add('completed');
        if (isLocked) lessonItem.classList.add('locked');
        if (isActive) lessonItem.classList.add('active');

        // Determine status display
        let statusClass = 'not-started';
        let statusIcon = index + 1;
        
        if (isCompleted) {
            statusClass = 'completed';
            statusIcon = '✓';
        } else if (isInProgress) {
            statusClass = 'in-progress';
            statusIcon = '◐';
        }

        // Create lesson item HTML
        lessonItem.innerHTML = `
            <div class="lesson-status ${statusClass}">${statusIcon}</div>
            <div class="lesson-info">
                <div class="lesson-title">${lesson.title}</div>
                <div class="lesson-meta">
                    ${isCompleted ? 'Completed' : 
                      isInProgress ? 'In Progress' : 
                      isLocked ? 'Locked' : 'Not Started'}
                </div>
            </div>
            <div class="lesson-duration">${lesson.duration}</div>
        `;

        // Add click handler if not locked
        if (!isLocked) {
            lessonItem.addEventListener('click', () => {
                if (index !== currentLessonIndex) {
                    // Track lesson time before switching
                    trackLessonTime();
                    
                    currentLessonIndex = index;
                    loadLesson(index);
                    closeSidebar();
                }
            });
        }

        lessonNav.appendChild(lessonItem);
    });
}

function canAccessLesson(index) {
    if (index === 0) return true; // First lesson always accessible
    
    // Can access if previous lesson is completed
    const previousLessonId = COURSE_DATA.lessons[index - 1].id;
    return courseProgress[previousLessonId]?.completed || false;
}

function trackLessonTime() {
    const currentLesson = COURSE_DATA.lessons[currentLessonIndex];
    const lessonProgress = courseProgress[currentLesson.id];
    
    if (lessonProgress?.currentSessionStart) {
        const sessionTime = Math.floor((new Date() - new Date(lessonProgress.currentSessionStart)) / 1000 / 60);
        lessonProgress.timeSpent = (lessonProgress.timeSpent || 0) + sessionTime;
        delete lessonProgress.currentSessionStart;
    }
}

// =====================================================
// LESSON CONTENT RENDERING
// =====================================================
function renderLessonContent(lesson) {
    const contentContainer = document.getElementById('lessonContent');
    if (!contentContainer) return;
    
    let contentHTML = `
        <div class="content-section">
            <h2>Learning Objectives</h2>
            <ul>
                ${lesson.objectives.map(obj => `<li>${obj}</li>`).join('')}
            </ul>
        </div>
        
        <div class="content-section">
            <h2>Overview</h2>
            <p>${lesson.content.overview}</p>
        </div>
    `;

    // Render content sections
    lesson.content.sections.forEach(section => {
        contentHTML += `
            <div class="content-section">
                <h2>${section.title}</h2>
                ${section.content}
                ${section.image ? `<img src="${section.image}" alt="${section.title}" class="content-image" loading="lazy">` : ''}
            </div>
        `;
    });

    // Render code examples
    if (lesson.content.codeExamples && lesson.content.codeExamples.length > 0) {
        contentHTML += `<div class="content-section"><h2>Code Examples</h2></div>`;
        
        lesson.content.codeExamples.forEach((example, index) => {
            const codeId = `code-${lesson.id}-${index}`;
            contentHTML += `
                <div class="code-section">
                    <div class="code-header">
                        <span class="code-title">${example.title}</span>
                        <button class="copy-btn" onclick="copyCode('${codeId}')">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                    <pre class="code-block"><code id="${codeId}" class="language-${example.language}">${escapeHtml(example.code)}</code></pre>
                </div>
            `;
        });
    }

    // Render quiz
    contentHTML += renderQuiz(lesson.quiz);

    contentContainer.innerHTML = contentHTML;

    // Highlight code syntax if Prism is available
    setTimeout(() => {
        if (window.Prism) {
            Prism.highlightAll();
        }
    }, 100);
}

// =====================================================
// QUIZ SYSTEM
// =====================================================
function renderQuiz(quiz) {
    const currentLessonProgress = courseProgress[COURSE_DATA.lessons[currentLessonIndex].id];
    const isCompleted = currentLessonProgress?.completed || false;
    
    let quizHTML = `
        <div class="quiz-section" id="quizSection">
            <div class="quiz-header">
                <h2 class="quiz-title">
                    <i class="fas fa-clipboard-check"></i>
                    Knowledge Check
                </h2>
                <p class="quiz-info">
                    Complete this quiz with ${quiz.passingScore}% or higher to unlock the next lesson.
                </p>
            </div>
    `;

    if (isCompleted) {
        const savedScore = currentLessonProgress.quizScore || 0;
        quizHTML += `
            <div class="quiz-results show">
                <div class="quiz-score pass">${savedScore}%</div>
                <div class="quiz-message">
                    <strong>Lesson Completed!</strong><br>
                    You've successfully passed this lesson's quiz.
                </div>
            </div>
        `;
    } else {
        // Render quiz questions
        quiz.questions.forEach((question, qIndex) => {
            quizHTML += `
                <div class="quiz-question ${qIndex === 0 ? 'active' : ''}" data-question="${qIndex}">
                    <div class="question-header">
                        <span class="question-number">Question ${qIndex + 1}</span>
                        <span class="question-progress">${qIndex + 1}/${quiz.questions.length}</span>
                    </div>
                    <div class="question-text">${question.question}</div>
                    <div class="question-options">
                        ${question.options.map((option, oIndex) => `
                            <div class="option" data-option="${oIndex}" onclick="selectOption(${qIndex}, ${oIndex})">
                                <span class="option-letter">${String.fromCharCode(65 + oIndex)}</span>
                                <span class="option-text">${option}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        });

        quizHTML += `
            <div class="quiz-controls">
                <button class="btn btn-secondary" id="prevQuestionBtn" onclick="previousQuestion()" disabled>
                    <i class="fas fa-chevron-left"></i>
                    Previous
                </button>
                <div>
                    <button class="btn btn-secondary" id="nextQuestionBtn" onclick="nextQuestion()" disabled>
                        Next
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <button class="btn btn-primary" id="submitQuizBtn" onclick="submitQuiz()" style="display: none;">
                        <i class="fas fa-check"></i>
                        Submit Quiz
                    </button>
                </div>
            </div>

            <div class="quiz-results" id="quizResults">
                <div class="quiz-score" id="quizScore">0%</div>
                <div class="quiz-message" id="quizMessage"></div>
                <div class="quiz-actions">
                    <button class="btn btn-primary" id="continueBtn" onclick="completeLesson()" style="display: none;">
                        <i class="fas fa-arrow-right"></i>
                        Continue to Next Lesson
                    </button>
                    <button class="btn btn-secondary" onclick="retakeQuiz()">
                        <i class="fas fa-redo"></i>
                        Retake Quiz
                    </button>
                </div>
            </div>
        `;
    }

    quizHTML += '</div>';
    return quizHTML;
}

// Quiz interaction functions
function selectOption(questionIndex, optionIndex) {
    // Clear previous selections
    document.querySelectorAll(`[data-question="${questionIndex}"] .option`).forEach(opt => {
        opt.classList.remove('selected');
    });

    // Select current option
    const selectedOption = document.querySelector(`[data-question="${questionIndex}"] [data-option="${optionIndex}"]`);
    selectedOption.classList.add('selected');

    // Store answer
    quizState.answers[questionIndex] = optionIndex;

    // Update navigation
    const isLastQuestion = questionIndex === COURSE_DATA.lessons[currentLessonIndex].quiz.questions.length - 1;
    if (isLastQuestion) {
        document.getElementById('submitQuizBtn').style.display = 'inline-flex';
        document.getElementById('nextQuestionBtn').style.display = 'none';
    } else {
        document.getElementById('nextQuestionBtn').disabled = false;
    }
}

function nextQuestion() {
    const currentQuestionEl = document.querySelector('.quiz-question.active');
    const nextQuestionEl = currentQuestionEl.nextElementSibling;
    
    if (nextQuestionEl && nextQuestionEl.classList.contains('quiz-question')) {
        currentQuestionEl.classList.remove('active');
        nextQuestionEl.classList.add('active');
        quizState.currentQuestion++;
        updateQuizNavigation();
    }
}

function previousQuestion() {
    const currentQuestionEl = document.querySelector('.quiz-question.active');
    const prevQuestionEl = currentQuestionEl.previousElementSibling;
    
    if (prevQuestionEl && prevQuestionEl.classList.contains('quiz-question')) {
        currentQuestionEl.classList.remove('active');
        prevQuestionEl.classList.add('active');
        quizState.currentQuestion--;
        updateQuizNavigation();
    }
}

function updateQuizNavigation() {
    const totalQuestions = COURSE_DATA.lessons[currentLessonIndex].quiz.questions.length;
    const prevBtn = document.getElementById('prevQuestionBtn');
    const nextBtn = document.getElementById('nextQuestionBtn');
    const submitBtn = document.getElementById('submitQuizBtn');

    prevBtn.disabled = quizState.currentQuestion === 0;
    
    const hasAnswer = quizState.answers[quizState.currentQuestion] !== undefined;
    const isLastQuestion = quizState.currentQuestion === totalQuestions - 1;
    
    if (isLastQuestion) {
        nextBtn.style.display = 'none';
        submitBtn.style.display = hasAnswer ? 'inline-flex' : 'none';
    } else {
        nextBtn.style.display = 'inline-flex';
        nextBtn.disabled = !hasAnswer;
        submitBtn.style.display = 'none';
    }
}

async function submitQuiz() {
    const lesson = COURSE_DATA.lessons[currentLessonIndex];
    const quiz = lesson.quiz;
    let correctAnswers = 0;

    // Hide questions and controls
    document.querySelectorAll('.quiz-question').forEach(q => q.style.display = 'none');
    document.querySelector('.quiz-controls').style.display = 'none';

    // Calculate score and highlight answers
    quiz.questions.forEach((question, index) => {
        const userAnswer = quizState.answers[index];
        const correctAnswer = question.correct;
        const isCorrect = userAnswer === correctAnswer;
        
        if (isCorrect) correctAnswers++;

        // Highlight answers
        const questionEl = document.querySelector(`[data-question="${index}"]`);
        const options = questionEl.querySelectorAll('.option');
        
        options[correctAnswer].classList.add('correct');
        if (userAnswer !== correctAnswer && userAnswer !== undefined) {
            options[userAnswer].classList.add('incorrect');
        }
    });

    const score = Math.round((correctAnswers / quiz.questions.length) * 100);
    const passed = score >= quiz.passingScore;

    // Update quiz results UI
    const quizScore = document.getElementById('quizScore');
    const quizMessage = document.getElementById('quizMessage');
    const quizActions = document.querySelector('.quiz-actions');

    quizScore.textContent = `${score}%`;
    quizScore.className = `quiz-score ${passed ? 'pass' : 'fail'}`;

    if (passed) {
        quizMessage.innerHTML = `
            <strong>Congratulations!</strong><br>
            You passed with ${score}%. You can now proceed to the next lesson.
        `;
        
        quizActions.innerHTML = `
            <button class="btn btn-primary" onclick="completeLesson()">
                <i class="fas fa-arrow-right"></i>
                Continue to Next Lesson
            </button>
        `;
        
        // Mark lesson as completed
        await markLessonComplete(score);
        
    } else {
        quizMessage.innerHTML = `
            <strong>Not quite there yet.</strong><br>
            You scored ${score}%. You need ${quiz.passingScore}% to pass. Review the material and try again.
        `;
        
        quizActions.innerHTML = `
            <button class="btn btn-secondary" onclick="retakeQuiz()">
                <i class="fas fa-redo"></i>
                Retake Quiz
            </button>
        `;
    }

    document.getElementById('quizResults').classList.add('show');
    
    // Log quiz completion
    logUserActivity('quiz_completed', {
        lesson_id: lesson.id,
        lesson_title: lesson.title,
        score: score,
        passed: passed,
        attempts: (courseProgress[lesson.id]?.quizAttempts || 0) + 1
    });

    // Scroll to results
    document.getElementById('quizResults').scrollIntoView({ behavior: 'smooth' });
}

function retakeQuiz() {
    // Reset quiz state
    quizState = {
        currentQuestion: 0,
        answers: [],
        score: 0,
        isComplete: false
    };

    // Track quiz retry
    const lessonId = COURSE_DATA.lessons[currentLessonIndex].id;
    if (!courseProgress[lessonId]) courseProgress[lessonId] = {};
    courseProgress[lessonId].quizAttempts = (courseProgress[lessonId].quizAttempts || 0) + 1;

    // Reload lesson content
    loadLesson(currentLessonIndex);
    
    // Scroll to quiz
    setTimeout(() => {
        document.getElementById('quizSection').scrollIntoView({ behavior: 'smooth' });
    }, 500);
}

async function markLessonComplete(score) {
    const lesson = COURSE_DATA.lessons[currentLessonIndex];
    const lessonId = lesson.id;
    
    // Track lesson completion time
    trackLessonTime();
    
    // Update lesson progress
    courseProgress[lessonId] = {
        ...courseProgress[lessonId],
        completed: true,
        quizScore: score,
        completedAt: new Date().toISOString(),
        finalScore: score
    };

    // Update session tracking
    courseSession.lessonsCompleted++;

    // Save progress to database
    await saveProgress();
    
    // Update UI
    renderSidebar();
    updateNavigationButtons();

    // Check various achievements
    await checkLessonCompletionAchievements();
    await checkPerfectScoreAchievements(score);
    await checkStudyTimeAchievements();
    
    // Log lesson completion
    logUserActivity('lesson_completed', {
        lesson_id: lessonId,
        lesson_title: lesson.title,
        final_score: score,
        time_spent: courseProgress[lessonId].timeSpent || 0,
        lesson_number: currentLessonIndex + 1
    });
    
    showToast('Lesson completed successfully!', 'success');
}

async function completeLesson() {
    if (currentLessonIndex < COURSE_DATA.lessons.length - 1) {
        // Move to next lesson
        currentLessonIndex++;
        loadLesson(currentLessonIndex);
        
    } else {
        // Course completion
        await completeCourse();
    }
}

async function completeCourse() {
    try {
        const completionTime = courseSession.totalStudyTime;
        
        // Update course progress to 100% completed
        await supabase
            .from('course_progress')
            .update({
                progress: 100,
                completed_at: new Date().toISOString(),
                completion_time_minutes: completionTime
            })
            .eq('user_id', currentUser.id)
            .eq('course_id', COURSE_DATA.id);

        // Award course completion achievements
        await checkAndUnlockAchievement('course_completion_1');
        await checkSpeedCompletionAchievements(completionTime);
        await checkCourseStreakAchievements();
        
        // Update user stats
        await updateUserStats();
        
        // Show completion message
        showToast('Congratulations! Course completed successfully!', 'certificate');
        
        // Log course completion
        logUserActivity('course_completed', {
            course_id: COURSE_DATA.id,
            course_title: COURSE_DATA.title,
            completion_time_minutes: completionTime,
            total_lessons: COURSE_DATA.lessons.length,
            average_quiz_score: calculateAverageQuizScore()
        });
        
        // Redirect to dashboard after delay
        setTimeout(() => {
            window.location.href = '/dashboard.html';
        }, 3000);
        
    } catch (error) {
        console.error('Error completing course:', error);
        showToast('Error marking course as complete', 'error');
    }
}

// =====================================================
// ACHIEVEMENT INTEGRATION SYSTEM
// =====================================================
async function checkAndUnlockAchievement(achievementId, skipNotification = false) {
    try {
        // Prevent duplicate checks
        const cacheKey = `achievement_${achievementId}_${currentUser.id}`;
        if (sessionStorage.getItem(cacheKey)) return false;

        // Check if already unlocked
        const { data: existing, error } = await supabase
            .from('user_achievements')
            .select('id')
            .eq('user_id', currentUser.id)
            .eq('achievement_id', achievementId)
            .single();

        if (existing) {
            sessionStorage.setItem(cacheKey, 'true');
            return false;
        }

        // Award achievement
        const achievementData = {
            user_id: currentUser.id,
            achievement_id: achievementId,
            unlocked_at: new Date().toISOString(),
            points_awarded: getAchievementPoints(achievementId),
            context: 'course_system'
        };

        const { data, error: insertError } = await supabase
            .from('user_achievements')
            .insert([achievementData])
            .select()
            .single();

        if (insertError) {
            if (insertError.code === '23505') return false; // Already exists
            throw insertError;
        }

        // Update user points
       await supabase.rpc('increment_user_stats', {
  user_id_param: currentUser.id,
  points_to_add: achievementData.points_awarded,
  achievements_to_add: 1
});

        // Cache and queue notification
        sessionStorage.setItem(cacheKey, 'true');
        
        if (!skipNotification) {
            queueAchievementNotification({
                id: achievementId,
                name: getAchievementName(achievementId),
                description: getAchievementDescription(achievementId),
                points: achievementData.points_awarded,
                rarity: getAchievementRarity(achievementId),
                icon: getAchievementIcon(achievementId)
            });
        }

        return true;

    } catch (error) {
        console.error('Error unlocking achievement:', error);
        return false;
    }
}

// Helper functions for achievement data (replace with your actual achievement definitions)
function getAchievementPoints(id) {
    const pointsMap = {
        'first_course_start': 75,
        'first_lesson': 100,
        'course_completion_1': 500,
        'perfect_score': 250,
        'speed_demon': 750,
        'marathon_learner': 500,
        'night_owl': 200,
        'early_bird': 200,
        'weekend_warrior': 150,
        // Add more as needed
    };
    return pointsMap[id] || 100;
}

function getAchievementName(id) {
    const nameMap = {
        'first_course_start': 'Learning Initiated',
        'first_lesson': 'First Steps',
        'course_completion_1': 'Course Conqueror',
        'perfect_score': 'Perfectionist',
        'speed_demon': 'Speed Demon',
        // Add more as needed
    };
    return nameMap[id] || 'Achievement Unlocked';
}

function getAchievementDescription(id) {
    const descMap = {
        'first_course_start': 'Start your first cybersecurity course',
        'first_lesson': 'Complete your first lesson',
        'course_completion_1': 'Complete your first course',
        'perfect_score': 'Score 100% on any quiz',
        'speed_demon': 'Complete a course in under 2 hours',
        // Add more as needed
    };
    return descMap[id] || 'Achievement description';
}

function getAchievementRarity(id) {
    const rarityMap = {
        'first_course_start': 'common',
        'first_lesson': 'bronze',
        'course_completion_1': 'silver',
        'perfect_score': 'gold',
        'speed_demon': 'legendary',
        // Add more as needed
    };
    return rarityMap[id] || 'common';
}

function getAchievementIcon(id) {
    const iconMap = {
        'first_course_start': 'fas fa-play',
        'first_lesson': 'fas fa-baby',
        'course_completion_1': 'fas fa-trophy',
        'perfect_score': 'fas fa-star',
        'speed_demon': 'fas fa-rocket',
        // Add more as needed
    };
    return iconMap[id] || 'fas fa-award';
}

async function checkLessonAchievements(lessonNumber) {
    if (lessonNumber === 1) {
        await checkAndUnlockAchievement('first_lesson');
    }
    
    // Check if user has completed multiple lessons in one day
    const today = new Date().toISOString().split('T')[0];
    const todayCompletions = Object.values(courseProgress).filter(p => 
        p.completed && p.completedAt?.startsWith(today)
    ).length;
    
    if (todayCompletions >= 3) {
        await checkAndUnlockAchievement('lesson_marathon');
    }
}

async function checkLessonCompletionAchievements() {
    const completedCount = getCompletedLessonsCount();
    
    // Lesson-based achievements
    const lessonMilestones = [1, 5, 10, 25, 50, 100];
    for (const milestone of lessonMilestones) {
        if (completedCount >= milestone) {
            await checkAndUnlockAchievement(`lessons_${milestone}`);
        }
    }
    
    // Course completion achievements
    if (completedCount === COURSE_DATA.lessons.length) {
        await checkAndUnlockAchievement('course_completion_1');
        
        // Check for additional course completion achievements
        const { data: allCourses } = await supabase
            .from('course_progress')
            .select('course_id')
            .eq('user_id', currentUser.id)
            .eq('progress', 100);
        
        const totalCompleted = allCourses?.length || 0;
        
        const courseMilestones = [1, 5, 10, 25];
        for (const milestone of courseMilestones) {
            if (totalCompleted >= milestone) {
                await checkAndUnlockAchievement(`course_completion_${milestone}`);
            }
        }
    }
}

async function checkPerfectScoreAchievements(score) {
    if (score === 100) {
        await checkAndUnlockAchievement('perfect_score');
        
        // Check for consecutive perfect scores
        const recentScores = Object.values(courseProgress)
            .filter(p => p.completed && p.quizScore)
            .slice(-5) // Last 5 completed
            .map(p => p.quizScore);
        
        if (recentScores.length >= 3 && recentScores.every(s => s === 100)) {
            await checkAndUnlockAchievement('perfectionist_streak');
        }
    }
}

async function checkSpeedCompletionAchievements(completionTime) {
    // Speed demon: Complete course in under 2 hours (120 minutes)
    if (completionTime <= 120) {
        await checkAndUnlockAchievement('speed_demon');
    }
    
    // Quick learner: Complete course in under 4 hours (240 minutes)
    if (completionTime <= 240) {
        await checkAndUnlockAchievement('quick_learner');
    }
}

async function checkStudyTimeAchievements() {
    const totalTime = courseSession.totalStudyTime;
    
    // Marathon learner: Study for 8+ hours in a course session
    if (totalTime >= 480) { // 8 hours
        await checkAndUnlockAchievement('marathon_learner');
    }
    
    // Dedicated learner: Study for 4+ hours
    if (totalTime >= 240) { // 4 hours
        await checkAndUnlockAchievement('dedicated_learner');
    }
}

async function checkCourseStreakAchievements() {
    try {
        // Check for consecutive course completions
        const { data: recentCourses, error } = await supabase
            .from('course_progress')
            .select('completed_at, course_id')
            .eq('user_id', currentUser.id)
            .eq('progress', 100)
            .order('completed_at', { ascending: false })
            .limit(10);

        if (error || !recentCourses) return;

        // Check for courses completed on consecutive days
        let consecutiveDays = 1;
        for (let i = 1; i < recentCourses.length; i++) {
            const prevDate = new Date(recentCourses[i-1].completed_at).toDateString();
            const currentDate = new Date(recentCourses[i].completed_at).toDateString();
            const dayDiff = Math.abs(new Date(prevDate) - new Date(currentDate)) / (1000 * 60 * 60 * 24);
            
            if (dayDiff <= 1) {
                consecutiveDays++;
            } else {
                break;
            }
        }

        if (consecutiveDays >= 3) {
            await checkAndUnlockAchievement('learning_streak');
        }

    } catch (error) {
        console.error('Error checking course streak achievements:', error);
    }
}

// =====================================================
// TIME-BASED ACHIEVEMENTS
// =====================================================
async function checkTimeBasedAchievements(timestamp) {
    const hour = timestamp.getHours();
    const dayOfWeek = timestamp.getDay();

    // Night owl (after midnight, before 6 AM)
    if (hour >= 0 && hour < 6) {
        await incrementTimeBasedCounter('midnight_sessions', 'night_owl');
    }

    // Early bird (4 AM to 6 AM)
    if (hour >= 4 && hour < 6) {
        await incrementTimeBasedCounter('early_sessions', 'early_bird');
    }

    // Weekend warrior (Saturday = 6, Sunday = 0)
    if (dayOfWeek === 0 || dayOfWeek === 6) {
        await incrementTimeBasedCounter('weekend_sessions', 'weekend_warrior');
    }
}

async function incrementTimeBasedCounter(counterType, achievementId) {
    try {
        const dateStr = new Date().toISOString().split('T')[0];
        const cacheKey = `${counterType}_${currentUser.id}_${dateStr}`;

        // Prevent multiple increments per day
        if (sessionStorage.getItem(cacheKey)) return;

        // Update counter
     await supabase.rpc('increment_profile_counter', {
  user_id_param: currentUser.id,
  counter_field: counterType,
  increment_value: 1
});

        // Cache to prevent double counting
        sessionStorage.setItem(cacheKey, 'true');

        // Check related achievement
        if (achievementId) {
            await checkAndUnlockAchievement(achievementId, true);
        }

    } catch (error) {
        console.error(`Error incrementing ${counterType}:`, error);
    }
}

async function checkDailyStreak() {
    try {
        const { data: profile, error } = await supabase
            .from('profiles')
            .select('last_activity, current_streak, last_streak_date')
            .eq('id', currentUser.id)
            .single();

        if (error) throw error;

        const now = new Date();
        const today = now.toDateString();
        const lastActivity = profile.last_activity ? new Date(profile.last_activity) : null;
        const lastStreakDate = profile.last_streak_date ? new Date(profile.last_streak_date).toDateString() : null;

        let newStreak = profile.current_streak || 0;
        let shouldUpdateStreak = false;

        if (!lastActivity) {
            // First time user
            newStreak = 1;
            shouldUpdateStreak = true;
        } else {
            const daysSinceLastActivity = Math.floor((now - lastActivity) / (1000 * 60 * 60 * 24));
            
            if (lastStreakDate === today) {
                // Already counted today's streak
                return newStreak;
            } else if (daysSinceLastActivity === 1 || (daysSinceLastActivity === 0 && lastStreakDate !== today)) {
                // Consecutive day or same day but not counted yet
                newStreak += 1;
                shouldUpdateStreak = true;
            } else if (daysSinceLastActivity > 1) {
                // Streak broken
                newStreak = 1;
                shouldUpdateStreak = true;
            }
        }

        if (shouldUpdateStreak) {
            await supabase
                .from('profiles')
                .update({
                    current_streak: newStreak,
                    last_activity: now.toISOString(),
                    last_streak_date: now.toISOString()
                })
                .eq('id', currentUser.id);

            userStats.current_streak = newStreak;
            
            showToast(`Daily streak: ${newStreak} days!`, 'success');
            await checkStreakAchievements(newStreak);
        }

        return newStreak;
        
    } catch (error) {
        console.error('Error checking daily streak:', error);
        return 0;
    }
}

async function checkStreakAchievements(currentStreak) {
    const streakMilestones = [3, 7, 14, 30, 100, 365];
    
    for (const milestone of streakMilestones) {
        if (currentStreak >= milestone) {
            await checkAndUnlockAchievement(`streak_${milestone}`);
        }
    }
}

// =====================================================
// USER ACTIVITY LOGGING
// =====================================================
async function logUserActivity(activityType, metadata = {}) {
    try {
        const now = new Date();
        
        const activityData = {
            user_id: currentUser.id,
            activity_type: activityType,
            timestamp: now.toISOString(),
            course_id: COURSE_DATA.id,
            lesson_index: currentLessonIndex,
            session_duration: courseSession.totalStudyTime,
            metadata: JSON.stringify(metadata),
            created_at: now.toISOString()
        };

        // Try to log to activities table
        const { error } = await supabase
            .from('user_activities')
            .insert([activityData]);

        if (error && error.code !== '42P01') {
            console.warn('Activity logging failed:', error.message);
        }

        // Always update last activity in profile
        await supabase
            .from('profiles')
            .update({ last_activity: now.toISOString() })
            .eq('id', currentUser.id);

    } catch (error) {
        console.error('Error logging user activity:', error);
    }
}

// =====================================================
// NAVIGATION SYSTEM
// =====================================================
function updateNavigationButtons() {
    const prevBtn = document.getElementById('prevLessonBtn');
    const nextBtn = document.getElementById('nextLessonBtn');
    
    if (!prevBtn || !nextBtn) return;

    // Previous button
    prevBtn.disabled = currentLessonIndex === 0;
    
    // Next button logic
    const isLastLesson = currentLessonIndex === COURSE_DATA.lessons.length - 1;
    const canGoNext = currentLessonIndex < COURSE_DATA.lessons.length - 1 && 
                     canAccessLesson(currentLessonIndex + 1);
    
    if (isLastLesson) {
        const isCurrentCompleted = courseProgress[COURSE_DATA.lessons[currentLessonIndex].id]?.completed;
        nextBtn.disabled = !isCurrentCompleted;
        nextBtn.innerHTML = '<i class="fas fa-trophy"></i> Complete Course';
    } else {
        nextBtn.disabled = !canGoNext;
        nextBtn.innerHTML = 'Next <i class="fas fa-chevron-right"></i>';
    }
}

// Navigation button event handlers
function goToPreviousLesson() {
    if (currentLessonIndex > 0) {
        trackLessonTime(); // Track time spent on current lesson
        currentLessonIndex--;
        loadLesson(currentLessonIndex);
    }
}

function goToNextLesson() {
    if (currentLessonIndex < COURSE_DATA.lessons.length - 1) {
        const canGoNext = canAccessLesson(currentLessonIndex + 1);
        if (canGoNext) {
            trackLessonTime();
            currentLessonIndex++;
            loadLesson(currentLessonIndex);
        } else {
            showToast('Complete the current lesson quiz to proceed', 'warning');
        }
    } else {
        // Complete course
        completeCourse();
    }
}

// =====================================================
// SIDEBAR FUNCTIONS
// =====================================================
function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebarOverlay');
    
    if (sidebar) sidebar.classList.toggle('open');
    if (overlay) overlay.classList.toggle('active');
}

function closeSidebar() {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebarOverlay');
    
    if (sidebar) sidebar.classList.remove('open');
    if (overlay) overlay.classList.remove('active');
}

// =====================================================
// ACHIEVEMENT NOTIFICATION SYSTEM
// =====================================================
function queueAchievementNotification(achievement) {
    notificationQueue.push(achievement);
    processNotificationQueue();
}

function processNotificationQueue() {
    if (isShowingNotification || notificationQueue.length === 0) return;

    isShowingNotification = true;
    const achievement = notificationQueue.shift();
    showAchievementNotification(achievement);

    const duration = achievement.rarity === 'mythic' ? 8000 :
                     achievement.rarity === 'legendary' ? 7000 : 6000;

    setTimeout(() => {
        isShowingNotification = false;
        processNotificationQueue();
    }, duration + 500);
}

function showAchievementNotification(achievement) {
    const notification = document.getElementById('achievementNotification');
    if (!notification) return;

    const icon = document.getElementById('notificationIcon');
    const title = document.getElementById('notificationTitle');
    const description = document.getElementById('notificationDescription');
    const points = document.getElementById('notificationPoints');

    if (icon) {
        icon.innerHTML = `<i class="${achievement.icon}"></i>`;
        icon.className = `notification-icon ${achievement.rarity}`;
    }
    if (title) title.textContent = achievement.name;
    if (description) description.textContent = achievement.description;
    if (points) points.textContent = `+${achievement.points} Points`;

    notification.className = `achievement-notification ${achievement.rarity}`;
    notification.classList.add('show');

    const duration = achievement.rarity === 'mythic' ? 8000 :
                     achievement.rarity === 'legendary' ? 7000 : 6000;

    setTimeout(() => {
        notification.classList.remove('show');
    }, duration);
}

// =====================================================
// UTILITY FUNCTIONS
// =====================================================
function calculateAverageQuizScore() {
    const scores = Object.values(courseProgress)
        .filter(p => p.completed && p.quizScore)
        .map(p => p.quizScore);
    
    if (scores.length === 0) return 0;
    return Math.round(scores.reduce((sum, score) => sum + score, 0) / scores.length);
}

async function resetProgress() {
    if (!confirm('Are you sure you want to reset your progress? This action cannot be undone.')) {
        return;
    }

    try {
        // Track lesson time before reset
        trackLessonTime();
        
        // Reset local state
        courseProgress = {};
        currentLessonIndex = 0;
        courseSession = {
            startTime: new Date(),
            totalStudyTime: 0,
            lessonsStarted: 0,
            lessonsCompleted: 0,
            pageLoadTime: new Date(),
            interactionCount: 0,
            lastActivityTime: new Date()
        };
        
        // Delete from database
        await supabase
            .from('course_progress')
            .delete()
            .eq('user_id', currentUser.id)
            .eq('course_id', COURSE_DATA.id);

        // Log reset activity
        logUserActivity('progress_reset', {
            course_id: COURSE_DATA.id,
            reset_reason: 'manual'
        });

        // Reinitialize
        await saveProgress();
        renderSidebar();
        loadLesson(0);
        
        showToast('Progress reset successfully', 'success');
        
    } catch (error) {
        console.error('Error resetting progress:', error);
        showToast('Failed to reset progress', 'error');
    }
}

function copyCode(codeId) {
    const codeElement = document.getElementById(codeId);
    if (!codeElement) return;
    
    const text = codeElement.textContent;
    
    navigator.clipboard.writeText(text).then(() => {
        showToast('Code copied to clipboard!', 'success');
        
        // Track code copy for achievements
        logUserActivity('code_copied', {
            code_section: codeId,
            lesson_id: COURSE_DATA.lessons[currentLessonIndex].id
        });
        
    }).catch(err => {
        console.error('Failed to copy code:', err);
        showToast('Failed to copy code', 'error');
        
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.select();
        try {
            document.execCommand('copy');
            showToast('Code copied to clipboard!', 'success');
        } catch (fallbackError) {
            showToast('Copy failed - please select and copy manually', 'error');
        }
        document.body.removeChild(textArea);
    });
}

function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

// =====================================================
// UI FEEDBACK SYSTEMS
// =====================================================
function showToast(message, type = 'success') {
    const toast = document.getElementById('toast');
    const messageEl = document.getElementById('toastMessage');
    
    if (!toast || !messageEl) {
        console.log(`Toast: ${message} (${type})`);
        return;
    }
    
    messageEl.textContent = message;
    toast.className = `toast ${type} show`;

    setTimeout(() => {
        toast.classList.remove('show');
    }, 4000);
}

function showLoadingScreen() {
    const loadingScreen = document.getElementById('loadingScreen');
    if (loadingScreen) loadingScreen.classList.remove('hidden');
}

function hideLoadingScreen() {
    const loadingScreen = document.getElementById('loadingScreen');
    if (loadingScreen) {
        setTimeout(() => {
            loadingScreen.classList.add('hidden');
        }, 1000);
    }
}

// =====================================================
// MUSIC PLAYER INTEGRATION
// =====================================================
function initMusicPlayer() {
    const btnText = document.getElementById('music-button-text');
    const icon = document.getElementById('music-icon');
    const dropdown = document.getElementById('music-dropdown-content');
    
    if (!btnText || !icon || !dropdown) return;
    
    function setUI(state) {
        btnText.textContent = state === "Playing" ? "PAUSE MUSIC" : "STUDY MUSIC";
        icon.className = state === "Playing" ? "fa-solid fa-circle-pause" : "fa-solid fa-music";
    }

    // Load saved music state
    const savedSrc = localStorage.getItem("cybersec_music_src");
    const savedTime = parseFloat(localStorage.getItem("cybersec_music_time") || 0);
    
    if (savedSrc) {
        audioPlayer.src = savedSrc;
        audioPlayer.currentTime = savedTime;
        audioPlayer.play()
            .then(() => setUI("Playing"))
            .catch(() => setUI("Stopped"));
    }

    // Music button click handler
    document.getElementById('music-dropdown').querySelector('button').addEventListener('click', (e) => {
        e.stopPropagation();
        dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
        
        if (audioPlayer.src && !audioPlayer.paused) {
            audioPlayer.pause();
            setUI("Stopped");
        } else if (audioPlayer.src) {
            audioPlayer.play().then(() => setUI("Playing"));
        }
    });

    // Music selection handlers
    dropdown.querySelectorAll("a[data-src]").forEach((link) => {
        link.addEventListener("click", (e) => {
            e.preventDefault();
            audioPlayer.src = link.dataset.src;
            audioPlayer.play().then(() => setUI("Playing"));
            localStorage.setItem("cybersec_music_src", link.dataset.src);
            dropdown.style.display = "none";
        });
    });

    // Stop music handler
    const stopLink = document.getElementById("stop-music-link");
    if (stopLink) {
        stopLink.addEventListener("click", (e) => {
            e.preventDefault();
            audioPlayer.pause();
            audioPlayer.currentTime = 0;
            audioPlayer.removeAttribute("src");
            setUI("Stopped");
            localStorage.removeItem("cybersec_music_src");
            localStorage.removeItem("cybersec_music_time");
            dropdown.style.display = "none";
        });
    }

    // Save music state before page unload
    window.addEventListener("beforeunload", () => {
        if (!audioPlayer.paused && audioPlayer.src) {
            localStorage.setItem("cybersec_music_src", audioPlayer.src);
            localStorage.setItem(
                "cybersec_music_time",
                audioPlayer.currentTime
            );
        }
    });

    // Close dropdown when clicking outside
    window.addEventListener("click", (e) => {
        if (!e.target.closest("#music-dropdown")) {
            dropdown.style.display = "none";
        }
    });
}

// Show initial music indicator
function addMusicIndicator() {
    const musicBtn = document.querySelector("#music-dropdown");
    if (musicBtn) {
        const indicator = document.createElement("div");
        indicator.className = "music-indicator";
        indicator.innerHTML = `<i class="fa-solid fa-music"></i> Try Study Music!`;

        musicBtn.style.position = "relative";
        musicBtn.appendChild(indicator);

        setTimeout(() => indicator.remove(), 3000);
    }
}

// Initialize Event Listeners
function initializeEventListeners() {
    // Navigation buttons
    document.getElementById('prevLessonBtn')?.addEventListener('click', goToPreviousLesson);
    document.getElementById('nextLessonBtn')?.addEventListener('click', goToNextLesson);

    // Reset progress button
    document.getElementById('resetProgressBtn')?.addEventListener('click', resetProgress);

    // Mobile menu toggle
    document.getElementById('menuToggle')?.addEventListener('click', toggleSidebar);
    document.getElementById('sidebarOverlay')?.addEventListener('click', closeSidebar);

    // Keyboard shortcuts
    document.addEventListener('keydown', handleKeyboardShortcuts);

    // Window resize handler
    window.addEventListener('resize', handleWindowResize);

    // Content interaction tracking
    document.getElementById('contentBody')?.addEventListener('scroll', debounce(() => {
        trackUserInteraction();
    }, 1000));
}

// Keyboard Shortcuts
function handleKeyboardShortcuts(e) {
    if (document.querySelector('.quiz-question.active')) return;

    if (e.key === 'ArrowLeft' && e.ctrlKey) {
        e.preventDefault();
        goToPreviousLesson();
    } else if (e.key === 'ArrowRight' && e.ctrlKey) {
        e.preventDefault();
        goToNextLesson();
    }
}

// Window Resize Handler
function handleWindowResize() {
    if (window.innerWidth > 768) {
        closeSidebar();
    }
}

// Debounce Helper
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// Initialize responsive behavior
if (window.innerWidth <= 768) {
    document.getElementById('menuToggle').style.display = 'inline-flex';
}

// Auto-save progress periodically
setInterval(async () => {
    if (currentUser && Object.keys(courseProgress).length > 0) {
        await saveProgress();
    }
}, 60000); // Save every minute

// System initialization logging
console.log('CyberSec Academy Course System Initialized');
console.log('Current Course:', COURSE_DATA.title);
console.log('Total Lessons:', COURSE_DATA.lessons.length);

// Google OAuth Integration
const googleBtn = document.querySelector(".btn-google");
if (googleBtn) {
    googleBtn.addEventListener("click", async () => {
        const { data, error } = await supabase.auth.signInWithOAuth({
            provider: "google",
            options: {
                redirectTo: window.location.origin + "/courses/windows-linux-administration.html",
            },
        });

        if (error) {
            console.error("Google login error:", error.message);
            showToast("Google login failed: " + error.message, "error");
        }
    });
}

// Check for existing session
supabase.auth.getSession().then(({ data }) => {
    if (data.session) {
        console.log("User already logged in:", data.session.user);
        currentUser = data.session.user;
        startCourseSession();
    }
});


// Add missing auth modal functions
function openAuthModal() {
    const modal = document.getElementById('authModal');
    if (modal) {
        modal.style.display = 'flex';
    }
}

function closeAuthModal() {
    const modal = document.getElementById('authModal');
    if (modal) {
        modal.style.display = 'none';
    }
}

// Add auth tab switching functionality
document.getElementById('tabSignIn')?.addEventListener('click', () => {
    document.getElementById('tabSignIn').classList.add('active');
    document.getElementById('tabSignUp').classList.remove('active');
    document.getElementById('signInForm').style.display = 'block';
    document.getElementById('signUpForm').style.display = 'none';
});

document.getElementById('tabSignUp')?.addEventListener('click', () => {
    document.getElementById('tabSignUp').classList.add('active');
    document.getElementById('tabSignIn').classList.remove('active');
    document.getElementById('signUpForm').style.display = 'block';
    document.getElementById('signInForm').style.display = 'none';
});

document.getElementById('closeAuthModal')?.addEventListener('click', closeAuthModal);

// Improved error handling for auth session
supabase.auth.onAuthStateChange((event, session) => {
    if (event === 'SIGNED_IN') {
        currentUser = session.user;
        closeAuthModal();
        startCourseSession();
    } else if (event === 'SIGNED_OUT') {
        currentUser = null;
        openAuthModal();
    }
});

// Add form submission handlers
document.getElementById('emailSignInForm')?.addEventListener('submit', async (e) => {
    e.preventDefault();
    const email = document.getElementById('signInEmail').value;
    const password = document.getElementById('signInPassword').value;
    
    try {
        const { data, error } = await supabase.auth.signInWithPassword({
            email,
            password
        });
        
        if (error) throw error;
        
        closeAuthModal();
    } catch (error) {
        showToast(error.message, 'error');
    }
});

document.getElementById('emailSignUpForm')?.addEventListener('submit', async (e) => {
    e.preventDefault();
    const email = document.getElementById('signUpEmail').value;
    const password = document.getElementById('signUpPassword').value;
    const name = document.getElementById('signUpName').value;
    
    try {
        const { data, error } = await supabase.auth.signUp({
            email,
            password,
            options: {
                data: {
                    full_name: name
                }
            }
        });
        
        if (error) throw error;
        
        showToast('Account created successfully! Please check your email.', 'success');
    } catch (error) {
        showToast(error.message, 'error');
    }
});
    </script>
</body>

</html>
